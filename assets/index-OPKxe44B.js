var MO=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var c6=MO((b6,Pc)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var Vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var g0={exports:{}},bd={},p0={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ka=Symbol.for("react.element"),IO=Symbol.for("react.portal"),HO=Symbol.for("react.fragment"),PO=Symbol.for("react.strict_mode"),AO=Symbol.for("react.profiler"),NO=Symbol.for("react.provider"),DO=Symbol.for("react.context"),kO=Symbol.for("react.forward_ref"),LO=Symbol.for("react.suspense"),FO=Symbol.for("react.memo"),$O=Symbol.for("react.lazy"),Iv=Symbol.iterator;function VO(t){return t===null||typeof t!="object"?null:(t=Iv&&t[Iv]||t["@@iterator"],typeof t=="function"?t:null)}var w0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v0=Object.assign,y0={};function Js(t,e,r){this.props=t,this.context=e,this.refs=y0,this.updater=r||w0}Js.prototype.isReactComponent={};Js.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Js.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function C0(){}C0.prototype=Js.prototype;function qg(t,e,r){this.props=t,this.context=e,this.refs=y0,this.updater=r||w0}var Zg=qg.prototype=new C0;Zg.constructor=qg;v0(Zg,Js.prototype);Zg.isPureReactComponent=!0;var Hv=Array.isArray,S0=Object.prototype.hasOwnProperty,Jg={current:null},R0={key:!0,ref:!0,__self:!0,__source:!0};function E0(t,e,r){var n,i={},o=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)S0.call(e,n)&&!R0.hasOwnProperty(n)&&(i[n]=e[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:ka,type:t,key:o,ref:s,props:i,_owner:Jg.current}}function WO(t,e){return{$$typeof:ka,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ep(t){return typeof t=="object"&&t!==null&&t.$$typeof===ka}function BO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Pv=/\/+/g;function _h(t,e){return typeof t=="object"&&t!==null&&t.key!=null?BO(""+t.key):e.toString(36)}function lc(t,e,r,n,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case ka:case IO:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+_h(s,0):n,Hv(i)?(r="",t!=null&&(r=t.replace(Pv,"$&/")+"/"),lc(i,e,r,"",function(u){return u})):i!=null&&(ep(i)&&(i=WO(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Pv,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",Hv(t))for(var l=0;l<t.length;l++){o=t[l];var a=n+_h(o,l);s+=lc(o,e,r,a,i)}else if(a=VO(t),typeof a=="function")for(t=a.call(t),l=0;!(o=t.next()).done;)o=o.value,a=n+_h(o,l++),s+=lc(o,e,r,a,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function iu(t,e,r){if(t==null)return t;var n=[],i=0;return lc(t,n,"","",function(o){return e.call(r,o,i++)}),n}function zO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var or={current:null},ac={transition:null},jO={ReactCurrentDispatcher:or,ReactCurrentBatchConfig:ac,ReactCurrentOwner:Jg};function b0(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:iu,forEach:function(t,e,r){iu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return iu(t,function(){e++}),e},toArray:function(t){return iu(t,function(e){return e})||[]},only:function(t){if(!ep(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};_e.Component=Js;_e.Fragment=HO;_e.Profiler=AO;_e.PureComponent=qg;_e.StrictMode=PO;_e.Suspense=LO;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jO;_e.act=b0;_e.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=v0({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Jg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)S0.call(e,a)&&!R0.hasOwnProperty(a)&&(n[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)n.children=r;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:ka,type:t.type,key:i,ref:o,props:n,_owner:s}};_e.createContext=function(t){return t={$$typeof:DO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:NO,_context:t},t.Consumer=t};_e.createElement=E0;_e.createFactory=function(t){var e=E0.bind(null,t);return e.type=t,e};_e.createRef=function(){return{current:null}};_e.forwardRef=function(t){return{$$typeof:kO,render:t}};_e.isValidElement=ep;_e.lazy=function(t){return{$$typeof:$O,_payload:{_status:-1,_result:t},_init:zO}};_e.memo=function(t,e){return{$$typeof:FO,type:t,compare:e===void 0?null:e}};_e.startTransition=function(t){var e=ac.transition;ac.transition={};try{t()}finally{ac.transition=e}};_e.unstable_act=b0;_e.useCallback=function(t,e){return or.current.useCallback(t,e)};_e.useContext=function(t){return or.current.useContext(t)};_e.useDebugValue=function(){};_e.useDeferredValue=function(t){return or.current.useDeferredValue(t)};_e.useEffect=function(t,e){return or.current.useEffect(t,e)};_e.useId=function(){return or.current.useId()};_e.useImperativeHandle=function(t,e,r){return or.current.useImperativeHandle(t,e,r)};_e.useInsertionEffect=function(t,e){return or.current.useInsertionEffect(t,e)};_e.useLayoutEffect=function(t,e){return or.current.useLayoutEffect(t,e)};_e.useMemo=function(t,e){return or.current.useMemo(t,e)};_e.useReducer=function(t,e,r){return or.current.useReducer(t,e,r)};_e.useRef=function(t){return or.current.useRef(t)};_e.useState=function(t){return or.current.useState(t)};_e.useSyncExternalStore=function(t,e,r){return or.current.useSyncExternalStore(t,e,r)};_e.useTransition=function(){return or.current.useTransition()};_e.version="18.3.1";p0.exports=_e;var wr=p0.exports;const et=Qg(wr);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UO=wr,YO=Symbol.for("react.element"),GO=Symbol.for("react.fragment"),KO=Object.prototype.hasOwnProperty,XO=UO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QO={key:!0,ref:!0,__self:!0,__source:!0};function T0(t,e,r){var n,i={},o=null,s=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)KO.call(e,n)&&!QO.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:YO,type:t,key:o,ref:s,props:i,_owner:XO.current}}bd.Fragment=GO;bd.jsx=T0;bd.jsxs=T0;g0.exports=bd;var De=g0.exports,mm={},_0={exports:{}},kr={},O0={exports:{}},x0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,A){var J=N.length;N.push(A);e:for(;0<J;){var c=J-1>>>1,h=N[c];if(0<i(h,A))N[c]=A,N[J]=h,J=c;else break e}}function r(N){return N.length===0?null:N[0]}function n(N){if(N.length===0)return null;var A=N[0],J=N.pop();if(J!==A){N[0]=J;e:for(var c=0,h=N.length,g=h>>>1;c<g;){var _=2*(c+1)-1,R=N[_],O=_+1,I=N[O];if(0>i(R,J))O<h&&0>i(I,R)?(N[c]=I,N[O]=J,c=O):(N[c]=R,N[_]=J,c=_);else if(O<h&&0>i(I,J))N[c]=I,N[O]=J,c=O;else break e}}return A}function i(N,A){var J=N.sortIndex-A.sortIndex;return J!==0?J:N.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var a=[],u=[],d=1,f=null,m=3,p=!1,C=!1,S=!1,H=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(N){for(var A=r(u);A!==null;){if(A.callback===null)n(u);else if(A.startTime<=N)n(u),A.sortIndex=A.expirationTime,e(a,A);else break;A=r(u)}}function x(N){if(S=!1,E(N),!C)if(r(a)!==null)C=!0,se($);else{var A=r(u);A!==null&&G(x,A.startTime-N)}}function $(N,A){C=!1,S&&(S=!1,w(y),y=-1),p=!0;var J=m;try{for(E(A),f=r(a);f!==null&&(!(f.expirationTime>A)||N&&!U());){var c=f.callback;if(typeof c=="function"){f.callback=null,m=f.priorityLevel;var h=c(f.expirationTime<=A);A=t.unstable_now(),typeof h=="function"?f.callback=h:f===r(a)&&n(a),E(A)}else n(a);f=r(a)}if(f!==null)var g=!0;else{var _=r(u);_!==null&&G(x,_.startTime-A),g=!1}return g}finally{f=null,m=J,p=!1}}var k=!1,P=null,y=-1,b=5,M=-1;function U(){return!(t.unstable_now()-M<b)}function Y(){if(P!==null){var N=t.unstable_now();M=N;var A=!0;try{A=P(!0,N)}finally{A?B():(k=!1,P=null)}}else k=!1}var B;if(typeof v=="function")B=function(){v(Y)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,me=Q.port2;Q.port1.onmessage=Y,B=function(){me.postMessage(null)}}else B=function(){H(Y,0)};function se(N){P=N,k||(k=!0,B())}function G(N,A){y=H(function(){N(t.unstable_now())},A)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){C||p||(C=!0,se($))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(a)},t.unstable_next=function(N){switch(m){case 1:case 2:case 3:var A=3;break;default:A=m}var J=m;m=A;try{return N()}finally{m=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,A){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var J=m;m=N;try{return A()}finally{m=J}},t.unstable_scheduleCallback=function(N,A,J){var c=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?c+J:c):J=c,N){case 1:var h=-1;break;case 2:h=250;break;case 5:h=1073741823;break;case 4:h=1e4;break;default:h=5e3}return h=J+h,N={id:d++,callback:A,priorityLevel:N,startTime:J,expirationTime:h,sortIndex:-1},J>c?(N.sortIndex=J,e(u,N),r(a)===null&&N===r(u)&&(S?(w(y),y=-1):S=!0,G(x,J-c))):(N.sortIndex=h,e(a,N),C||p||(C=!0,se($))),N},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(N){var A=m;return function(){var J=m;m=A;try{return N.apply(this,arguments)}finally{m=J}}}})(x0);O0.exports=x0;var qO=O0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZO=wr,Nr=qO;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M0=new Set,aa={};function Bo(t,e){Fs(t,e),Fs(t+"Capture",e)}function Fs(t,e){for(aa[t]=e,t=0;t<e.length;t++)M0.add(e[t])}var gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gm=Object.prototype.hasOwnProperty,JO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Av={},Nv={};function ex(t){return gm.call(Nv,t)?!0:gm.call(Av,t)?!1:JO.test(t)?Nv[t]=!0:(Av[t]=!0,!1)}function tx(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function rx(t,e,r,n){if(e===null||typeof e>"u"||tx(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sr(t,e,r,n,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ft[t]=new sr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ft[e]=new sr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ft[t]=new sr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ft[t]=new sr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ft[t]=new sr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ft[t]=new sr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ft[t]=new sr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ft[t]=new sr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ft[t]=new sr(t,5,!1,t.toLowerCase(),null,!1,!1)});var tp=/[\-:]([a-z])/g;function rp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(tp,rp);Ft[e]=new sr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(tp,rp);Ft[e]=new sr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(tp,rp);Ft[e]=new sr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ft[t]=new sr(t,1,!1,t.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ft[t]=new sr(t,1,!1,t.toLowerCase(),null,!0,!0)});function np(t,e,r,n){var i=Ft.hasOwnProperty(e)?Ft[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(rx(e,r,i,n)&&(r=null),n||i===null?ex(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Ci=ZO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ou=Symbol.for("react.element"),hs=Symbol.for("react.portal"),fs=Symbol.for("react.fragment"),ip=Symbol.for("react.strict_mode"),pm=Symbol.for("react.profiler"),I0=Symbol.for("react.provider"),H0=Symbol.for("react.context"),op=Symbol.for("react.forward_ref"),wm=Symbol.for("react.suspense"),vm=Symbol.for("react.suspense_list"),sp=Symbol.for("react.memo"),Ii=Symbol.for("react.lazy"),P0=Symbol.for("react.offscreen"),Dv=Symbol.iterator;function ul(t){return t===null||typeof t!="object"?null:(t=Dv&&t[Dv]||t["@@iterator"],typeof t=="function"?t:null)}var lt=Object.assign,Oh;function Wl(t){if(Oh===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Oh=e&&e[1]||""}return`
`+Oh+t}var xh=!1;function Mh(t,e){if(!t||xh)return"";xh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=n.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var a=`
`+i[s].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=s&&0<=l);break}}}finally{xh=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Wl(t):""}function nx(t){switch(t.tag){case 5:return Wl(t.type);case 16:return Wl("Lazy");case 13:return Wl("Suspense");case 19:return Wl("SuspenseList");case 0:case 2:case 15:return t=Mh(t.type,!1),t;case 11:return t=Mh(t.type.render,!1),t;case 1:return t=Mh(t.type,!0),t;default:return""}}function ym(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case fs:return"Fragment";case hs:return"Portal";case pm:return"Profiler";case ip:return"StrictMode";case wm:return"Suspense";case vm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case H0:return(t.displayName||"Context")+".Consumer";case I0:return(t._context.displayName||"Context")+".Provider";case op:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case sp:return e=t.displayName||null,e!==null?e:ym(t.type)||"Memo";case Ii:e=t._payload,t=t._init;try{return ym(t(e))}catch{}}return null}function ix(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ym(e);case 8:return e===ip?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ji(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function A0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ox(t){var e=A0(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function su(t){t._valueTracker||(t._valueTracker=ox(t))}function N0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=A0(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ac(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Cm(t,e){var r=e.checked;return lt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function kv(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ji(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function D0(t,e){e=e.checked,e!=null&&np(t,"checked",e,!1)}function Sm(t,e){D0(t,e);var r=Ji(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rm(t,e.type,r):e.hasOwnProperty("defaultValue")&&Rm(t,e.type,Ji(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Lv(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Rm(t,e,r){(e!=="number"||Ac(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Bl=Array.isArray;function Ms(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ji(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Em(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return lt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Fv(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(z(92));if(Bl(r)){if(1<r.length)throw Error(z(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ji(r)}}function k0(t,e){var r=Ji(e.value),n=Ji(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function $v(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function L0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?L0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var lu,F0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(lu=lu||document.createElement("div"),lu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ua(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sx=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(t){sx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gl[e]=Gl[t]})});function $0(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Gl.hasOwnProperty(t)&&Gl[t]?(""+e).trim():e+"px"}function V0(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=$0(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var lx=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tm(t,e){if(e){if(lx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function _m(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Om=null;function lp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var xm=null,Is=null,Hs=null;function Vv(t){if(t=$a(t)){if(typeof xm!="function")throw Error(z(280));var e=t.stateNode;e&&(e=Md(e),xm(t.stateNode,t.type,e))}}function W0(t){Is?Hs?Hs.push(t):Hs=[t]:Is=t}function B0(){if(Is){var t=Is,e=Hs;if(Hs=Is=null,Vv(t),e)for(t=0;t<e.length;t++)Vv(e[t])}}function z0(t,e){return t(e)}function j0(){}var Ih=!1;function U0(t,e,r){if(Ih)return t(e,r);Ih=!0;try{return z0(t,e,r)}finally{Ih=!1,(Is!==null||Hs!==null)&&(j0(),B0())}}function ca(t,e){var r=t.stateNode;if(r===null)return null;var n=Md(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(z(231,e,typeof r));return r}var Mm=!1;if(gi)try{var cl={};Object.defineProperty(cl,"passive",{get:function(){Mm=!0}}),window.addEventListener("test",cl,cl),window.removeEventListener("test",cl,cl)}catch{Mm=!1}function ax(t,e,r,n,i,o,s,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var Kl=!1,Nc=null,Dc=!1,Im=null,ux={onError:function(t){Kl=!0,Nc=t}};function cx(t,e,r,n,i,o,s,l,a){Kl=!1,Nc=null,ax.apply(ux,arguments)}function dx(t,e,r,n,i,o,s,l,a){if(cx.apply(this,arguments),Kl){if(Kl){var u=Nc;Kl=!1,Nc=null}else throw Error(z(198));Dc||(Dc=!0,Im=u)}}function zo(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Y0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Wv(t){if(zo(t)!==t)throw Error(z(188))}function hx(t){var e=t.alternate;if(!e){if(e=zo(t),e===null)throw Error(z(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return Wv(i),t;if(o===n)return Wv(i),e;o=o.sibling}throw Error(z(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,l=i.child;l;){if(l===r){s=!0,r=i,n=o;break}if(l===n){s=!0,n=i,r=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===r){s=!0,r=o,n=i;break}if(l===n){s=!0,n=o,r=i;break}l=l.sibling}if(!s)throw Error(z(189))}}if(r.alternate!==n)throw Error(z(190))}if(r.tag!==3)throw Error(z(188));return r.stateNode.current===r?t:e}function G0(t){return t=hx(t),t!==null?K0(t):null}function K0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=K0(t);if(e!==null)return e;t=t.sibling}return null}var X0=Nr.unstable_scheduleCallback,Bv=Nr.unstable_cancelCallback,fx=Nr.unstable_shouldYield,mx=Nr.unstable_requestPaint,ft=Nr.unstable_now,gx=Nr.unstable_getCurrentPriorityLevel,ap=Nr.unstable_ImmediatePriority,Q0=Nr.unstable_UserBlockingPriority,kc=Nr.unstable_NormalPriority,px=Nr.unstable_LowPriority,q0=Nr.unstable_IdlePriority,Td=null,Vn=null;function wx(t){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(Td,t,void 0,(t.current.flags&128)===128)}catch{}}var Rn=Math.clz32?Math.clz32:Cx,vx=Math.log,yx=Math.LN2;function Cx(t){return t>>>=0,t===0?32:31-(vx(t)/yx|0)|0}var au=64,uu=4194304;function zl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Lc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,o=t.pingedLanes,s=r&268435455;if(s!==0){var l=s&~i;l!==0?n=zl(l):(o&=s,o!==0&&(n=zl(o)))}else s=r&~i,s!==0?n=zl(s):o!==0&&(n=zl(o));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Rn(e),i=1<<r,n|=t[r],e&=~i;return n}function Sx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rx(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Rn(o),l=1<<s,a=i[s];a===-1?(!(l&r)||l&n)&&(i[s]=Sx(l,e)):a<=e&&(t.expiredLanes|=l),o&=~l}}function Hm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Z0(){var t=au;return au<<=1,!(au&4194240)&&(au=64),t}function Hh(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function La(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rn(e),t[e]=r}function Ex(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Rn(r),o=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~o}}function up(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Rn(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var ke=0;function J0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var eR,cp,tR,rR,nR,Pm=!1,cu=[],Bi=null,zi=null,ji=null,da=new Map,ha=new Map,Ni=[],bx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zv(t,e){switch(t){case"focusin":case"focusout":Bi=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":ji=null;break;case"pointerover":case"pointerout":da.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ha.delete(e.pointerId)}}function dl(t,e,r,n,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},e!==null&&(e=$a(e),e!==null&&cp(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Tx(t,e,r,n,i){switch(e){case"focusin":return Bi=dl(Bi,t,e,r,n,i),!0;case"dragenter":return zi=dl(zi,t,e,r,n,i),!0;case"mouseover":return ji=dl(ji,t,e,r,n,i),!0;case"pointerover":var o=i.pointerId;return da.set(o,dl(da.get(o)||null,t,e,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,ha.set(o,dl(ha.get(o)||null,t,e,r,n,i)),!0}return!1}function iR(t){var e=To(t.target);if(e!==null){var r=zo(e);if(r!==null){if(e=r.tag,e===13){if(e=Y0(r),e!==null){t.blockedOn=e,nR(t.priority,function(){tR(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function uc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Am(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Om=n,r.target.dispatchEvent(n),Om=null}else return e=$a(r),e!==null&&cp(e),t.blockedOn=r,!1;e.shift()}return!0}function jv(t,e,r){uc(t)&&r.delete(e)}function _x(){Pm=!1,Bi!==null&&uc(Bi)&&(Bi=null),zi!==null&&uc(zi)&&(zi=null),ji!==null&&uc(ji)&&(ji=null),da.forEach(jv),ha.forEach(jv)}function hl(t,e){t.blockedOn===e&&(t.blockedOn=null,Pm||(Pm=!0,Nr.unstable_scheduleCallback(Nr.unstable_NormalPriority,_x)))}function fa(t){function e(i){return hl(i,t)}if(0<cu.length){hl(cu[0],t);for(var r=1;r<cu.length;r++){var n=cu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Bi!==null&&hl(Bi,t),zi!==null&&hl(zi,t),ji!==null&&hl(ji,t),da.forEach(e),ha.forEach(e),r=0;r<Ni.length;r++)n=Ni[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ni.length&&(r=Ni[0],r.blockedOn===null);)iR(r),r.blockedOn===null&&Ni.shift()}var Ps=Ci.ReactCurrentBatchConfig,Fc=!0;function Ox(t,e,r,n){var i=ke,o=Ps.transition;Ps.transition=null;try{ke=1,dp(t,e,r,n)}finally{ke=i,Ps.transition=o}}function xx(t,e,r,n){var i=ke,o=Ps.transition;Ps.transition=null;try{ke=4,dp(t,e,r,n)}finally{ke=i,Ps.transition=o}}function dp(t,e,r,n){if(Fc){var i=Am(t,e,r,n);if(i===null)Wh(t,e,n,$c,r),zv(t,n);else if(Tx(i,t,e,r,n))n.stopPropagation();else if(zv(t,n),e&4&&-1<bx.indexOf(t)){for(;i!==null;){var o=$a(i);if(o!==null&&eR(o),o=Am(t,e,r,n),o===null&&Wh(t,e,n,$c,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else Wh(t,e,n,null,r)}}var $c=null;function Am(t,e,r,n){if($c=null,t=lp(n),t=To(t),t!==null)if(e=zo(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Y0(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $c=t,null}function oR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gx()){case ap:return 1;case Q0:return 4;case kc:case px:return 16;case q0:return 536870912;default:return 16}default:return 16}}var Li=null,hp=null,cc=null;function sR(){if(cc)return cc;var t,e=hp,r=e.length,n,i="value"in Li?Li.value:Li.textContent,o=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[o-n];n++);return cc=i.slice(t,1<n?1-n:void 0)}function dc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function du(){return!0}function Uv(){return!1}function Lr(t){function e(r,n,i,o,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?du:Uv,this.isPropagationStopped=Uv,this}return lt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=du)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=du)},persist:function(){},isPersistent:du}),e}var el={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fp=Lr(el),Fa=lt({},el,{view:0,detail:0}),Mx=Lr(Fa),Ph,Ah,fl,_d=lt({},Fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fl&&(fl&&t.type==="mousemove"?(Ph=t.screenX-fl.screenX,Ah=t.screenY-fl.screenY):Ah=Ph=0,fl=t),Ph)},movementY:function(t){return"movementY"in t?t.movementY:Ah}}),Yv=Lr(_d),Ix=lt({},_d,{dataTransfer:0}),Hx=Lr(Ix),Px=lt({},Fa,{relatedTarget:0}),Nh=Lr(Px),Ax=lt({},el,{animationName:0,elapsedTime:0,pseudoElement:0}),Nx=Lr(Ax),Dx=lt({},el,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kx=Lr(Dx),Lx=lt({},el,{data:0}),Gv=Lr(Lx),Fx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$x={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Vx[t])?!!e[t]:!1}function mp(){return Wx}var Bx=lt({},Fa,{key:function(t){if(t.key){var e=Fx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=dc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$x[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mp,charCode:function(t){return t.type==="keypress"?dc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?dc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),zx=Lr(Bx),jx=lt({},_d,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kv=Lr(jx),Ux=lt({},Fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mp}),Yx=Lr(Ux),Gx=lt({},el,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kx=Lr(Gx),Xx=lt({},_d,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Qx=Lr(Xx),qx=[9,13,27,32],gp=gi&&"CompositionEvent"in window,Xl=null;gi&&"documentMode"in document&&(Xl=document.documentMode);var Zx=gi&&"TextEvent"in window&&!Xl,lR=gi&&(!gp||Xl&&8<Xl&&11>=Xl),Xv=" ",Qv=!1;function aR(t,e){switch(t){case"keyup":return qx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ms=!1;function Jx(t,e){switch(t){case"compositionend":return uR(e);case"keypress":return e.which!==32?null:(Qv=!0,Xv);case"textInput":return t=e.data,t===Xv&&Qv?null:t;default:return null}}function eM(t,e){if(ms)return t==="compositionend"||!gp&&aR(t,e)?(t=sR(),cc=hp=Li=null,ms=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lR&&e.locale!=="ko"?null:e.data;default:return null}}var tM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!tM[t.type]:e==="textarea"}function cR(t,e,r,n){W0(n),e=Vc(e,"onChange"),0<e.length&&(r=new fp("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ql=null,ma=null;function rM(t){SR(t,0)}function Od(t){var e=ws(t);if(N0(e))return t}function nM(t,e){if(t==="change")return e}var dR=!1;if(gi){var Dh;if(gi){var kh="oninput"in document;if(!kh){var Zv=document.createElement("div");Zv.setAttribute("oninput","return;"),kh=typeof Zv.oninput=="function"}Dh=kh}else Dh=!1;dR=Dh&&(!document.documentMode||9<document.documentMode)}function Jv(){Ql&&(Ql.detachEvent("onpropertychange",hR),ma=Ql=null)}function hR(t){if(t.propertyName==="value"&&Od(ma)){var e=[];cR(e,ma,t,lp(t)),U0(rM,e)}}function iM(t,e,r){t==="focusin"?(Jv(),Ql=e,ma=r,Ql.attachEvent("onpropertychange",hR)):t==="focusout"&&Jv()}function oM(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Od(ma)}function sM(t,e){if(t==="click")return Od(e)}function lM(t,e){if(t==="input"||t==="change")return Od(e)}function aM(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bn=typeof Object.is=="function"?Object.is:aM;function ga(t,e){if(bn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!gm.call(e,i)||!bn(t[i],e[i]))return!1}return!0}function ey(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ty(t,e){var r=ey(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ey(r)}}function fR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?fR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function mR(){for(var t=window,e=Ac();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ac(t.document)}return e}function pp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uM(t){var e=mR(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&fR(r.ownerDocument.documentElement,r)){if(n!==null&&pp(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!t.extend&&o>n&&(i=n,n=o,o=i),i=ty(r,o);var s=ty(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cM=gi&&"documentMode"in document&&11>=document.documentMode,gs=null,Nm=null,ql=null,Dm=!1;function ry(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Dm||gs==null||gs!==Ac(n)||(n=gs,"selectionStart"in n&&pp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ql&&ga(ql,n)||(ql=n,n=Vc(Nm,"onSelect"),0<n.length&&(e=new fp("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=gs)))}function hu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ps={animationend:hu("Animation","AnimationEnd"),animationiteration:hu("Animation","AnimationIteration"),animationstart:hu("Animation","AnimationStart"),transitionend:hu("Transition","TransitionEnd")},Lh={},gR={};gi&&(gR=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function xd(t){if(Lh[t])return Lh[t];if(!ps[t])return t;var e=ps[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in gR)return Lh[t]=e[r];return t}var pR=xd("animationend"),wR=xd("animationiteration"),vR=xd("animationstart"),yR=xd("transitionend"),CR=new Map,ny="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function no(t,e){CR.set(t,e),Bo(e,[t])}for(var Fh=0;Fh<ny.length;Fh++){var $h=ny[Fh],dM=$h.toLowerCase(),hM=$h[0].toUpperCase()+$h.slice(1);no(dM,"on"+hM)}no(pR,"onAnimationEnd");no(wR,"onAnimationIteration");no(vR,"onAnimationStart");no("dblclick","onDoubleClick");no("focusin","onFocus");no("focusout","onBlur");no(yR,"onTransitionEnd");Fs("onMouseEnter",["mouseout","mouseover"]);Fs("onMouseLeave",["mouseout","mouseover"]);Fs("onPointerEnter",["pointerout","pointerover"]);Fs("onPointerLeave",["pointerout","pointerover"]);Bo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fM=new Set("cancel close invalid load scroll toggle".split(" ").concat(jl));function iy(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,dx(n,e,void 0,t),t.currentTarget=null}function SR(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var o=void 0;if(e)for(var s=n.length-1;0<=s;s--){var l=n[s],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&i.isPropagationStopped())break e;iy(i,l,u),o=a}else for(s=0;s<n.length;s++){if(l=n[s],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&i.isPropagationStopped())break e;iy(i,l,u),o=a}}}if(Dc)throw t=Im,Dc=!1,Im=null,t}function je(t,e){var r=e[Vm];r===void 0&&(r=e[Vm]=new Set);var n=t+"__bubble";r.has(n)||(RR(e,t,2,!1),r.add(n))}function Vh(t,e,r){var n=0;e&&(n|=4),RR(r,t,n,e)}var fu="_reactListening"+Math.random().toString(36).slice(2);function pa(t){if(!t[fu]){t[fu]=!0,M0.forEach(function(r){r!=="selectionchange"&&(fM.has(r)||Vh(r,!1,t),Vh(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[fu]||(e[fu]=!0,Vh("selectionchange",!1,e))}}function RR(t,e,r,n){switch(oR(e)){case 1:var i=Ox;break;case 4:i=xx;break;default:i=dp}r=i.bind(null,e,r,t),i=void 0,!Mm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Wh(t,e,r,n,i){var o=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;s=s.return}for(;l!==null;){if(s=To(l),s===null)return;if(a=s.tag,a===5||a===6){n=o=s;continue e}l=l.parentNode}}n=n.return}U0(function(){var u=o,d=lp(r),f=[];e:{var m=CR.get(t);if(m!==void 0){var p=fp,C=t;switch(t){case"keypress":if(dc(r)===0)break e;case"keydown":case"keyup":p=zx;break;case"focusin":C="focus",p=Nh;break;case"focusout":C="blur",p=Nh;break;case"beforeblur":case"afterblur":p=Nh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Yv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Hx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Yx;break;case pR:case wR:case vR:p=Nx;break;case yR:p=Kx;break;case"scroll":p=Mx;break;case"wheel":p=Qx;break;case"copy":case"cut":case"paste":p=kx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Kv}var S=(e&4)!==0,H=!S&&t==="scroll",w=S?m!==null?m+"Capture":null:m;S=[];for(var v=u,E;v!==null;){E=v;var x=E.stateNode;if(E.tag===5&&x!==null&&(E=x,w!==null&&(x=ca(v,w),x!=null&&S.push(wa(v,x,E)))),H)break;v=v.return}0<S.length&&(m=new p(m,C,null,r,d),f.push({event:m,listeners:S}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&r!==Om&&(C=r.relatedTarget||r.fromElement)&&(To(C)||C[pi]))break e;if((p||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,p?(C=r.relatedTarget||r.toElement,p=u,C=C?To(C):null,C!==null&&(H=zo(C),C!==H||C.tag!==5&&C.tag!==6)&&(C=null)):(p=null,C=u),p!==C)){if(S=Yv,x="onMouseLeave",w="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(S=Kv,x="onPointerLeave",w="onPointerEnter",v="pointer"),H=p==null?m:ws(p),E=C==null?m:ws(C),m=new S(x,v+"leave",p,r,d),m.target=H,m.relatedTarget=E,x=null,To(d)===u&&(S=new S(w,v+"enter",C,r,d),S.target=E,S.relatedTarget=H,x=S),H=x,p&&C)t:{for(S=p,w=C,v=0,E=S;E;E=Jo(E))v++;for(E=0,x=w;x;x=Jo(x))E++;for(;0<v-E;)S=Jo(S),v--;for(;0<E-v;)w=Jo(w),E--;for(;v--;){if(S===w||w!==null&&S===w.alternate)break t;S=Jo(S),w=Jo(w)}S=null}else S=null;p!==null&&oy(f,m,p,S,!1),C!==null&&H!==null&&oy(f,H,C,S,!0)}}e:{if(m=u?ws(u):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var $=nM;else if(qv(m))if(dR)$=lM;else{$=oM;var k=iM}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&($=sM);if($&&($=$(t,u))){cR(f,$,r,d);break e}k&&k(t,m,u),t==="focusout"&&(k=m._wrapperState)&&k.controlled&&m.type==="number"&&Rm(m,"number",m.value)}switch(k=u?ws(u):window,t){case"focusin":(qv(k)||k.contentEditable==="true")&&(gs=k,Nm=u,ql=null);break;case"focusout":ql=Nm=gs=null;break;case"mousedown":Dm=!0;break;case"contextmenu":case"mouseup":case"dragend":Dm=!1,ry(f,r,d);break;case"selectionchange":if(cM)break;case"keydown":case"keyup":ry(f,r,d)}var P;if(gp)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else ms?aR(t,r)&&(y="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(y="onCompositionStart");y&&(lR&&r.locale!=="ko"&&(ms||y!=="onCompositionStart"?y==="onCompositionEnd"&&ms&&(P=sR()):(Li=d,hp="value"in Li?Li.value:Li.textContent,ms=!0)),k=Vc(u,y),0<k.length&&(y=new Gv(y,t,null,r,d),f.push({event:y,listeners:k}),P?y.data=P:(P=uR(r),P!==null&&(y.data=P)))),(P=Zx?Jx(t,r):eM(t,r))&&(u=Vc(u,"onBeforeInput"),0<u.length&&(d=new Gv("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=P))}SR(f,e)})}function wa(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Vc(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=ca(t,r),o!=null&&n.unshift(wa(t,o,i)),o=ca(t,e),o!=null&&n.push(wa(t,o,i))),t=t.return}return n}function Jo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function oy(t,e,r,n,i){for(var o=e._reactName,s=[];r!==null&&r!==n;){var l=r,a=l.alternate,u=l.stateNode;if(a!==null&&a===n)break;l.tag===5&&u!==null&&(l=u,i?(a=ca(r,o),a!=null&&s.unshift(wa(r,a,l))):i||(a=ca(r,o),a!=null&&s.push(wa(r,a,l)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var mM=/\r\n?/g,gM=/\u0000|\uFFFD/g;function sy(t){return(typeof t=="string"?t:""+t).replace(mM,`
`).replace(gM,"")}function mu(t,e,r){if(e=sy(e),sy(t)!==e&&r)throw Error(z(425))}function Wc(){}var km=null,Lm=null;function Fm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $m=typeof setTimeout=="function"?setTimeout:void 0,pM=typeof clearTimeout=="function"?clearTimeout:void 0,ly=typeof Promise=="function"?Promise:void 0,wM=typeof queueMicrotask=="function"?queueMicrotask:typeof ly<"u"?function(t){return ly.resolve(null).then(t).catch(vM)}:$m;function vM(t){setTimeout(function(){throw t})}function Bh(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),fa(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);fa(e)}function Ui(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ay(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var tl=Math.random().toString(36).slice(2),Ln="__reactFiber$"+tl,va="__reactProps$"+tl,pi="__reactContainer$"+tl,Vm="__reactEvents$"+tl,yM="__reactListeners$"+tl,CM="__reactHandles$"+tl;function To(t){var e=t[Ln];if(e)return e;for(var r=t.parentNode;r;){if(e=r[pi]||r[Ln]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=ay(t);t!==null;){if(r=t[Ln])return r;t=ay(t)}return e}t=r,r=t.parentNode}return null}function $a(t){return t=t[Ln]||t[pi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ws(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function Md(t){return t[va]||null}var Wm=[],vs=-1;function io(t){return{current:t}}function Ue(t){0>vs||(t.current=Wm[vs],Wm[vs]=null,vs--)}function ze(t,e){vs++,Wm[vs]=t.current,t.current=e}var eo={},Xt=io(eo),Er=io(!1),Po=eo;function $s(t,e){var r=t.type.contextTypes;if(!r)return eo;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=e[o];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function br(t){return t=t.childContextTypes,t!=null}function Bc(){Ue(Er),Ue(Xt)}function uy(t,e,r){if(Xt.current!==eo)throw Error(z(168));ze(Xt,e),ze(Er,r)}function ER(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(z(108,ix(t)||"Unknown",i));return lt({},r,n)}function zc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||eo,Po=Xt.current,ze(Xt,t),ze(Er,Er.current),!0}function cy(t,e,r){var n=t.stateNode;if(!n)throw Error(z(169));r?(t=ER(t,e,Po),n.__reactInternalMemoizedMergedChildContext=t,Ue(Er),Ue(Xt),ze(Xt,t)):Ue(Er),ze(Er,r)}var si=null,Id=!1,zh=!1;function bR(t){si===null?si=[t]:si.push(t)}function SM(t){Id=!0,bR(t)}function oo(){if(!zh&&si!==null){zh=!0;var t=0,e=ke;try{var r=si;for(ke=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}si=null,Id=!1}catch(i){throw si!==null&&(si=si.slice(t+1)),X0(ap,oo),i}finally{ke=e,zh=!1}}return null}var ys=[],Cs=0,jc=null,Uc=0,Gr=[],Kr=0,Ao=null,ai=1,ui="";function Ro(t,e){ys[Cs++]=Uc,ys[Cs++]=jc,jc=t,Uc=e}function TR(t,e,r){Gr[Kr++]=ai,Gr[Kr++]=ui,Gr[Kr++]=Ao,Ao=t;var n=ai;t=ui;var i=32-Rn(n)-1;n&=~(1<<i),r+=1;var o=32-Rn(e)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,ai=1<<32-Rn(e)+i|r<<i|n,ui=o+t}else ai=1<<o|r<<i|n,ui=t}function wp(t){t.return!==null&&(Ro(t,1),TR(t,1,0))}function vp(t){for(;t===jc;)jc=ys[--Cs],ys[Cs]=null,Uc=ys[--Cs],ys[Cs]=null;for(;t===Ao;)Ao=Gr[--Kr],Gr[Kr]=null,ui=Gr[--Kr],Gr[Kr]=null,ai=Gr[--Kr],Gr[Kr]=null}var Pr=null,Ir=null,tt=!1,vn=null;function _R(t,e){var r=Zr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function dy(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pr=t,Ir=Ui(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pr=t,Ir=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ao!==null?{id:ai,overflow:ui}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Zr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Pr=t,Ir=null,!0):!1;default:return!1}}function Bm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zm(t){if(tt){var e=Ir;if(e){var r=e;if(!dy(t,e)){if(Bm(t))throw Error(z(418));e=Ui(r.nextSibling);var n=Pr;e&&dy(t,e)?_R(n,r):(t.flags=t.flags&-4097|2,tt=!1,Pr=t)}}else{if(Bm(t))throw Error(z(418));t.flags=t.flags&-4097|2,tt=!1,Pr=t}}}function hy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pr=t}function gu(t){if(t!==Pr)return!1;if(!tt)return hy(t),tt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Fm(t.type,t.memoizedProps)),e&&(e=Ir)){if(Bm(t))throw OR(),Error(z(418));for(;e;)_R(t,e),e=Ui(e.nextSibling)}if(hy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ir=Ui(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ir=null}}else Ir=Pr?Ui(t.stateNode.nextSibling):null;return!0}function OR(){for(var t=Ir;t;)t=Ui(t.nextSibling)}function Vs(){Ir=Pr=null,tt=!1}function yp(t){vn===null?vn=[t]:vn.push(t)}var RM=Ci.ReactCurrentBatchConfig;function ml(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(z(309));var n=r.stateNode}if(!n)throw Error(z(147,t));var i=n,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(z(284));if(!r._owner)throw Error(z(290,t))}return t}function pu(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fy(t){var e=t._init;return e(t._payload)}function xR(t){function e(w,v){if(t){var E=w.deletions;E===null?(w.deletions=[v],w.flags|=16):E.push(v)}}function r(w,v){if(!t)return null;for(;v!==null;)e(w,v),v=v.sibling;return null}function n(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function i(w,v){return w=Xi(w,v),w.index=0,w.sibling=null,w}function o(w,v,E){return w.index=E,t?(E=w.alternate,E!==null?(E=E.index,E<v?(w.flags|=2,v):E):(w.flags|=2,v)):(w.flags|=1048576,v)}function s(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,v,E,x){return v===null||v.tag!==6?(v=Qh(E,w.mode,x),v.return=w,v):(v=i(v,E),v.return=w,v)}function a(w,v,E,x){var $=E.type;return $===fs?d(w,v,E.props.children,x,E.key):v!==null&&(v.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Ii&&fy($)===v.type)?(x=i(v,E.props),x.ref=ml(w,v,E),x.return=w,x):(x=vc(E.type,E.key,E.props,null,w.mode,x),x.ref=ml(w,v,E),x.return=w,x)}function u(w,v,E,x){return v===null||v.tag!==4||v.stateNode.containerInfo!==E.containerInfo||v.stateNode.implementation!==E.implementation?(v=qh(E,w.mode,x),v.return=w,v):(v=i(v,E.children||[]),v.return=w,v)}function d(w,v,E,x,$){return v===null||v.tag!==7?(v=Io(E,w.mode,x,$),v.return=w,v):(v=i(v,E),v.return=w,v)}function f(w,v,E){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Qh(""+v,w.mode,E),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ou:return E=vc(v.type,v.key,v.props,null,w.mode,E),E.ref=ml(w,null,v),E.return=w,E;case hs:return v=qh(v,w.mode,E),v.return=w,v;case Ii:var x=v._init;return f(w,x(v._payload),E)}if(Bl(v)||ul(v))return v=Io(v,w.mode,E,null),v.return=w,v;pu(w,v)}return null}function m(w,v,E,x){var $=v!==null?v.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return $!==null?null:l(w,v,""+E,x);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ou:return E.key===$?a(w,v,E,x):null;case hs:return E.key===$?u(w,v,E,x):null;case Ii:return $=E._init,m(w,v,$(E._payload),x)}if(Bl(E)||ul(E))return $!==null?null:d(w,v,E,x,null);pu(w,E)}return null}function p(w,v,E,x,$){if(typeof x=="string"&&x!==""||typeof x=="number")return w=w.get(E)||null,l(v,w,""+x,$);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ou:return w=w.get(x.key===null?E:x.key)||null,a(v,w,x,$);case hs:return w=w.get(x.key===null?E:x.key)||null,u(v,w,x,$);case Ii:var k=x._init;return p(w,v,E,k(x._payload),$)}if(Bl(x)||ul(x))return w=w.get(E)||null,d(v,w,x,$,null);pu(v,x)}return null}function C(w,v,E,x){for(var $=null,k=null,P=v,y=v=0,b=null;P!==null&&y<E.length;y++){P.index>y?(b=P,P=null):b=P.sibling;var M=m(w,P,E[y],x);if(M===null){P===null&&(P=b);break}t&&P&&M.alternate===null&&e(w,P),v=o(M,v,y),k===null?$=M:k.sibling=M,k=M,P=b}if(y===E.length)return r(w,P),tt&&Ro(w,y),$;if(P===null){for(;y<E.length;y++)P=f(w,E[y],x),P!==null&&(v=o(P,v,y),k===null?$=P:k.sibling=P,k=P);return tt&&Ro(w,y),$}for(P=n(w,P);y<E.length;y++)b=p(P,w,y,E[y],x),b!==null&&(t&&b.alternate!==null&&P.delete(b.key===null?y:b.key),v=o(b,v,y),k===null?$=b:k.sibling=b,k=b);return t&&P.forEach(function(U){return e(w,U)}),tt&&Ro(w,y),$}function S(w,v,E,x){var $=ul(E);if(typeof $!="function")throw Error(z(150));if(E=$.call(E),E==null)throw Error(z(151));for(var k=$=null,P=v,y=v=0,b=null,M=E.next();P!==null&&!M.done;y++,M=E.next()){P.index>y?(b=P,P=null):b=P.sibling;var U=m(w,P,M.value,x);if(U===null){P===null&&(P=b);break}t&&P&&U.alternate===null&&e(w,P),v=o(U,v,y),k===null?$=U:k.sibling=U,k=U,P=b}if(M.done)return r(w,P),tt&&Ro(w,y),$;if(P===null){for(;!M.done;y++,M=E.next())M=f(w,M.value,x),M!==null&&(v=o(M,v,y),k===null?$=M:k.sibling=M,k=M);return tt&&Ro(w,y),$}for(P=n(w,P);!M.done;y++,M=E.next())M=p(P,w,y,M.value,x),M!==null&&(t&&M.alternate!==null&&P.delete(M.key===null?y:M.key),v=o(M,v,y),k===null?$=M:k.sibling=M,k=M);return t&&P.forEach(function(Y){return e(w,Y)}),tt&&Ro(w,y),$}function H(w,v,E,x){if(typeof E=="object"&&E!==null&&E.type===fs&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case ou:e:{for(var $=E.key,k=v;k!==null;){if(k.key===$){if($=E.type,$===fs){if(k.tag===7){r(w,k.sibling),v=i(k,E.props.children),v.return=w,w=v;break e}}else if(k.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Ii&&fy($)===k.type){r(w,k.sibling),v=i(k,E.props),v.ref=ml(w,k,E),v.return=w,w=v;break e}r(w,k);break}else e(w,k);k=k.sibling}E.type===fs?(v=Io(E.props.children,w.mode,x,E.key),v.return=w,w=v):(x=vc(E.type,E.key,E.props,null,w.mode,x),x.ref=ml(w,v,E),x.return=w,w=x)}return s(w);case hs:e:{for(k=E.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===E.containerInfo&&v.stateNode.implementation===E.implementation){r(w,v.sibling),v=i(v,E.children||[]),v.return=w,w=v;break e}else{r(w,v);break}else e(w,v);v=v.sibling}v=qh(E,w.mode,x),v.return=w,w=v}return s(w);case Ii:return k=E._init,H(w,v,k(E._payload),x)}if(Bl(E))return C(w,v,E,x);if(ul(E))return S(w,v,E,x);pu(w,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,v!==null&&v.tag===6?(r(w,v.sibling),v=i(v,E),v.return=w,w=v):(r(w,v),v=Qh(E,w.mode,x),v.return=w,w=v),s(w)):r(w,v)}return H}var Ws=xR(!0),MR=xR(!1),Yc=io(null),Gc=null,Ss=null,Cp=null;function Sp(){Cp=Ss=Gc=null}function Rp(t){var e=Yc.current;Ue(Yc),t._currentValue=e}function jm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function As(t,e){Gc=t,Cp=Ss=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rr=!0),t.firstContext=null)}function tn(t){var e=t._currentValue;if(Cp!==t)if(t={context:t,memoizedValue:e,next:null},Ss===null){if(Gc===null)throw Error(z(308));Ss=t,Gc.dependencies={lanes:0,firstContext:t}}else Ss=Ss.next=t;return e}var _o=null;function Ep(t){_o===null?_o=[t]:_o.push(t)}function IR(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Ep(e)):(r.next=i.next,i.next=r),e.interleaved=r,wi(t,n)}function wi(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Hi=!1;function bp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function fi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Yi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ie&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,wi(t,r)}return i=n.interleaved,i===null?(e.next=e,Ep(n)):(e.next=i.next,i.next=e),n.interleaved=e,wi(t,r)}function hc(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,up(t,r)}}function my(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=s:o=o.next=s,r=r.next}while(r!==null);o===null?i=o=e:o=o.next=e}else i=o=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Kc(t,e,r,n){var i=t.updateQueue;Hi=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,s===null?o=u:s.next=u,s=a;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==s&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=a))}if(o!==null){var f=i.baseState;s=0,d=u=a=null,l=o;do{var m=l.lane,p=l.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var C=t,S=l;switch(m=e,p=r,S.tag){case 1:if(C=S.payload,typeof C=="function"){f=C.call(p,f,m);break e}f=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=S.payload,m=typeof C=="function"?C.call(p,f,m):C,m==null)break e;f=lt({},f,m);break e;case 2:Hi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else p={eventTime:p,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,a=f):d=d.next=p,s|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(d===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Do|=s,t.lanes=s,t.memoizedState=f}}function gy(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(z(191,i));i.call(n)}}}var Va={},Wn=io(Va),ya=io(Va),Ca=io(Va);function Oo(t){if(t===Va)throw Error(z(174));return t}function Tp(t,e){switch(ze(Ca,e),ze(ya,t),ze(Wn,Va),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bm(e,t)}Ue(Wn),ze(Wn,e)}function Bs(){Ue(Wn),Ue(ya),Ue(Ca)}function PR(t){Oo(Ca.current);var e=Oo(Wn.current),r=bm(e,t.type);e!==r&&(ze(ya,t),ze(Wn,r))}function _p(t){ya.current===t&&(Ue(Wn),Ue(ya))}var it=io(0);function Xc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jh=[];function Op(){for(var t=0;t<jh.length;t++)jh[t]._workInProgressVersionPrimary=null;jh.length=0}var fc=Ci.ReactCurrentDispatcher,Uh=Ci.ReactCurrentBatchConfig,No=0,st=null,Ct=null,Mt=null,Qc=!1,Zl=!1,Sa=0,EM=0;function Bt(){throw Error(z(321))}function xp(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!bn(t[r],e[r]))return!1;return!0}function Mp(t,e,r,n,i,o){if(No=o,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fc.current=t===null||t.memoizedState===null?OM:xM,t=r(n,i),Zl){o=0;do{if(Zl=!1,Sa=0,25<=o)throw Error(z(301));o+=1,Mt=Ct=null,e.updateQueue=null,fc.current=MM,t=r(n,i)}while(Zl)}if(fc.current=qc,e=Ct!==null&&Ct.next!==null,No=0,Mt=Ct=st=null,Qc=!1,e)throw Error(z(300));return t}function Ip(){var t=Sa!==0;return Sa=0,t}function kn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?st.memoizedState=Mt=t:Mt=Mt.next=t,Mt}function rn(){if(Ct===null){var t=st.alternate;t=t!==null?t.memoizedState:null}else t=Ct.next;var e=Mt===null?st.memoizedState:Mt.next;if(e!==null)Mt=e,Ct=t;else{if(t===null)throw Error(z(310));Ct=t,t={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},Mt===null?st.memoizedState=Mt=t:Mt=Mt.next=t}return Mt}function Ra(t,e){return typeof e=="function"?e(t):e}function Yh(t){var e=rn(),r=e.queue;if(r===null)throw Error(z(311));r.lastRenderedReducer=t;var n=Ct,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var l=s=null,a=null,u=o;do{var d=u.lane;if((No&d)===d)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,s=n):a=a.next=f,st.lanes|=d,Do|=d}u=u.next}while(u!==null&&u!==o);a===null?s=n:a.next=l,bn(n,e.memoizedState)||(Rr=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=a,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do o=i.lane,st.lanes|=o,Do|=o,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Gh(t){var e=rn(),r=e.queue;if(r===null)throw Error(z(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,o=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);bn(o,e.memoizedState)||(Rr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,n]}function AR(){}function NR(t,e){var r=st,n=rn(),i=e(),o=!bn(n.memoizedState,i);if(o&&(n.memoizedState=i,Rr=!0),n=n.queue,Hp(LR.bind(null,r,n,t),[t]),n.getSnapshot!==e||o||Mt!==null&&Mt.memoizedState.tag&1){if(r.flags|=2048,Ea(9,kR.bind(null,r,n,i,e),void 0,null),Ht===null)throw Error(z(349));No&30||DR(r,e,i)}return i}function DR(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function kR(t,e,r,n){e.value=r,e.getSnapshot=n,FR(e)&&$R(t)}function LR(t,e,r){return r(function(){FR(e)&&$R(t)})}function FR(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!bn(t,r)}catch{return!0}}function $R(t){var e=wi(t,1);e!==null&&En(e,t,1,-1)}function py(t){var e=kn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:t},e.queue=t,t=t.dispatch=_M.bind(null,st,t),[e.memoizedState,t]}function Ea(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function VR(){return rn().memoizedState}function mc(t,e,r,n){var i=kn();st.flags|=t,i.memoizedState=Ea(1|e,r,void 0,n===void 0?null:n)}function Hd(t,e,r,n){var i=rn();n=n===void 0?null:n;var o=void 0;if(Ct!==null){var s=Ct.memoizedState;if(o=s.destroy,n!==null&&xp(n,s.deps)){i.memoizedState=Ea(e,r,o,n);return}}st.flags|=t,i.memoizedState=Ea(1|e,r,o,n)}function wy(t,e){return mc(8390656,8,t,e)}function Hp(t,e){return Hd(2048,8,t,e)}function WR(t,e){return Hd(4,2,t,e)}function BR(t,e){return Hd(4,4,t,e)}function zR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function jR(t,e,r){return r=r!=null?r.concat([t]):null,Hd(4,4,zR.bind(null,e,t),r)}function Pp(){}function UR(t,e){var r=rn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&xp(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function YR(t,e){var r=rn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&xp(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function GR(t,e,r){return No&21?(bn(r,e)||(r=Z0(),st.lanes|=r,Do|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rr=!0),t.memoizedState=r)}function bM(t,e){var r=ke;ke=r!==0&&4>r?r:4,t(!0);var n=Uh.transition;Uh.transition={};try{t(!1),e()}finally{ke=r,Uh.transition=n}}function KR(){return rn().memoizedState}function TM(t,e,r){var n=Ki(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},XR(t))QR(e,r);else if(r=IR(t,e,r,n),r!==null){var i=rr();En(r,t,n,i),qR(r,e,n)}}function _M(t,e,r){var n=Ki(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(XR(t))QR(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,r);if(i.hasEagerState=!0,i.eagerState=l,bn(l,s)){var a=e.interleaved;a===null?(i.next=i,Ep(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}r=IR(t,e,i,n),r!==null&&(i=rr(),En(r,t,n,i),qR(r,e,n))}}function XR(t){var e=t.alternate;return t===st||e!==null&&e===st}function QR(t,e){Zl=Qc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function qR(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,up(t,r)}}var qc={readContext:tn,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useInsertionEffect:Bt,useLayoutEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useMutableSource:Bt,useSyncExternalStore:Bt,useId:Bt,unstable_isNewReconciler:!1},OM={readContext:tn,useCallback:function(t,e){return kn().memoizedState=[t,e===void 0?null:e],t},useContext:tn,useEffect:wy,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,mc(4194308,4,zR.bind(null,e,t),r)},useLayoutEffect:function(t,e){return mc(4194308,4,t,e)},useInsertionEffect:function(t,e){return mc(4,2,t,e)},useMemo:function(t,e){var r=kn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=kn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=TM.bind(null,st,t),[n.memoizedState,t]},useRef:function(t){var e=kn();return t={current:t},e.memoizedState=t},useState:py,useDebugValue:Pp,useDeferredValue:function(t){return kn().memoizedState=t},useTransition:function(){var t=py(!1),e=t[0];return t=bM.bind(null,t[1]),kn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=st,i=kn();if(tt){if(r===void 0)throw Error(z(407));r=r()}else{if(r=e(),Ht===null)throw Error(z(349));No&30||DR(n,e,r)}i.memoizedState=r;var o={value:r,getSnapshot:e};return i.queue=o,wy(LR.bind(null,n,o,t),[t]),n.flags|=2048,Ea(9,kR.bind(null,n,o,r,e),void 0,null),r},useId:function(){var t=kn(),e=Ht.identifierPrefix;if(tt){var r=ui,n=ai;r=(n&~(1<<32-Rn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Sa++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=EM++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},xM={readContext:tn,useCallback:UR,useContext:tn,useEffect:Hp,useImperativeHandle:jR,useInsertionEffect:WR,useLayoutEffect:BR,useMemo:YR,useReducer:Yh,useRef:VR,useState:function(){return Yh(Ra)},useDebugValue:Pp,useDeferredValue:function(t){var e=rn();return GR(e,Ct.memoizedState,t)},useTransition:function(){var t=Yh(Ra)[0],e=rn().memoizedState;return[t,e]},useMutableSource:AR,useSyncExternalStore:NR,useId:KR,unstable_isNewReconciler:!1},MM={readContext:tn,useCallback:UR,useContext:tn,useEffect:Hp,useImperativeHandle:jR,useInsertionEffect:WR,useLayoutEffect:BR,useMemo:YR,useReducer:Gh,useRef:VR,useState:function(){return Gh(Ra)},useDebugValue:Pp,useDeferredValue:function(t){var e=rn();return Ct===null?e.memoizedState=t:GR(e,Ct.memoizedState,t)},useTransition:function(){var t=Gh(Ra)[0],e=rn().memoizedState;return[t,e]},useMutableSource:AR,useSyncExternalStore:NR,useId:KR,unstable_isNewReconciler:!1};function pn(t,e){if(t&&t.defaultProps){e=lt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Um(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:lt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Pd={isMounted:function(t){return(t=t._reactInternals)?zo(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=rr(),i=Ki(t),o=fi(n,i);o.payload=e,r!=null&&(o.callback=r),e=Yi(t,o,i),e!==null&&(En(e,t,i,n),hc(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=rr(),i=Ki(t),o=fi(n,i);o.tag=1,o.payload=e,r!=null&&(o.callback=r),e=Yi(t,o,i),e!==null&&(En(e,t,i,n),hc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=rr(),n=Ki(t),i=fi(r,n);i.tag=2,e!=null&&(i.callback=e),e=Yi(t,i,n),e!==null&&(En(e,t,n,r),hc(e,t,n))}};function vy(t,e,r,n,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,o,s):e.prototype&&e.prototype.isPureReactComponent?!ga(r,n)||!ga(i,o):!0}function ZR(t,e,r){var n=!1,i=eo,o=e.contextType;return typeof o=="object"&&o!==null?o=tn(o):(i=br(e)?Po:Xt.current,n=e.contextTypes,o=(n=n!=null)?$s(t,i):eo),e=new e(r,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pd,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function yy(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Pd.enqueueReplaceState(e,e.state,null)}function Ym(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},bp(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=tn(o):(o=br(e)?Po:Xt.current,i.context=$s(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Um(t,e,o,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Pd.enqueueReplaceState(i,i.state,null),Kc(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function zs(t,e){try{var r="",n=e;do r+=nx(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Kh(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Gm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var IM=typeof WeakMap=="function"?WeakMap:Map;function JR(t,e,r){r=fi(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Jc||(Jc=!0,ng=n),Gm(t,e)},r}function eE(t,e,r){r=fi(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Gm(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){Gm(t,e),typeof n!="function"&&(Gi===null?Gi=new Set([this]):Gi.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function Cy(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new IM;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=jM.bind(null,t,e,r),e.then(t,t))}function Sy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ry(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=fi(-1,1),e.tag=2,Yi(r,e,1))),r.lanes|=1),t)}var HM=Ci.ReactCurrentOwner,Rr=!1;function tr(t,e,r,n){e.child=t===null?MR(e,null,r,n):Ws(e,t.child,r,n)}function Ey(t,e,r,n,i){r=r.render;var o=e.ref;return As(e,i),n=Mp(t,e,r,n,o,i),r=Ip(),t!==null&&!Rr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,vi(t,e,i)):(tt&&r&&wp(e),e.flags|=1,tr(t,e,n,i),e.child)}function by(t,e,r,n,i){if(t===null){var o=r.type;return typeof o=="function"&&!Vp(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=o,tE(t,e,o,n,i)):(t=vc(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(r=r.compare,r=r!==null?r:ga,r(s,n)&&t.ref===e.ref)return vi(t,e,i)}return e.flags|=1,t=Xi(o,n),t.ref=e.ref,t.return=e,e.child=t}function tE(t,e,r,n,i){if(t!==null){var o=t.memoizedProps;if(ga(o,n)&&t.ref===e.ref)if(Rr=!1,e.pendingProps=n=o,(t.lanes&i)!==0)t.flags&131072&&(Rr=!0);else return e.lanes=t.lanes,vi(t,e,i)}return Km(t,e,r,n,i)}function rE(t,e,r){var n=e.pendingProps,i=n.children,o=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ze(Es,xr),xr|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ze(Es,xr),xr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,ze(Es,xr),xr|=n}else o!==null?(n=o.baseLanes|r,e.memoizedState=null):n=r,ze(Es,xr),xr|=n;return tr(t,e,i,r),e.child}function nE(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Km(t,e,r,n,i){var o=br(r)?Po:Xt.current;return o=$s(e,o),As(e,i),r=Mp(t,e,r,n,o,i),n=Ip(),t!==null&&!Rr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,vi(t,e,i)):(tt&&n&&wp(e),e.flags|=1,tr(t,e,r,i),e.child)}function Ty(t,e,r,n,i){if(br(r)){var o=!0;zc(e)}else o=!1;if(As(e,i),e.stateNode===null)gc(t,e),ZR(e,r,n),Ym(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=tn(u):(u=br(r)?Po:Xt.current,u=$s(e,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==n||a!==u)&&yy(e,s,n,u),Hi=!1;var m=e.memoizedState;s.state=m,Kc(e,n,s,i),a=e.memoizedState,l!==n||m!==a||Er.current||Hi?(typeof d=="function"&&(Um(e,r,d,n),a=e.memoizedState),(l=Hi||vy(e,r,l,n,m,a,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=a),s.props=n,s.state=a,s.context=u,n=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,HR(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:pn(e.type,l),s.props=u,f=e.pendingProps,m=s.context,a=r.contextType,typeof a=="object"&&a!==null?a=tn(a):(a=br(r)?Po:Xt.current,a=$s(e,a));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||m!==a)&&yy(e,s,n,a),Hi=!1,m=e.memoizedState,s.state=m,Kc(e,n,s,i);var C=e.memoizedState;l!==f||m!==C||Er.current||Hi?(typeof p=="function"&&(Um(e,r,p,n),C=e.memoizedState),(u=Hi||vy(e,r,u,n,m,C,a)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,C,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,C,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=C),s.props=n,s.state=C,s.context=a,n=u):(typeof s.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),n=!1)}return Xm(t,e,r,n,o,i)}function Xm(t,e,r,n,i,o){nE(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&cy(e,r,!1),vi(t,e,o);n=e.stateNode,HM.current=e;var l=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=Ws(e,t.child,null,o),e.child=Ws(e,null,l,o)):tr(t,e,l,o),e.memoizedState=n.state,i&&cy(e,r,!0),e.child}function iE(t){var e=t.stateNode;e.pendingContext?uy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&uy(t,e.context,!1),Tp(t,e.containerInfo)}function _y(t,e,r,n,i){return Vs(),yp(i),e.flags|=256,tr(t,e,r,n),e.child}var Qm={dehydrated:null,treeContext:null,retryLane:0};function qm(t){return{baseLanes:t,cachePool:null,transitions:null}}function oE(t,e,r){var n=e.pendingProps,i=it.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ze(it,i&1),t===null)return zm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,o?(n=e.mode,o=e.child,s={mode:"hidden",children:s},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Dd(s,n,0,null),t=Io(t,n,r,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=qm(r),e.memoizedState=Qm,t):Ap(e,s));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return PM(t,e,s,n,l,i,r);if(o){o=n.fallback,s=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=a,e.deletions=null):(n=Xi(i,a),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=Xi(l,o):(o=Io(o,s,r,null),o.flags|=2),o.return=e,n.return=e,n.sibling=o,e.child=n,n=o,o=e.child,s=t.child.memoizedState,s=s===null?qm(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~r,e.memoizedState=Qm,n}return o=t.child,t=o.sibling,n=Xi(o,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Ap(t,e){return e=Dd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wu(t,e,r,n){return n!==null&&yp(n),Ws(e,t.child,null,r),t=Ap(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PM(t,e,r,n,i,o,s){if(r)return e.flags&256?(e.flags&=-257,n=Kh(Error(z(422))),wu(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=n.fallback,i=e.mode,n=Dd({mode:"visible",children:n.children},i,0,null),o=Io(o,i,s,null),o.flags|=2,n.return=e,o.return=e,n.sibling=o,e.child=n,e.mode&1&&Ws(e,t.child,null,s),e.child.memoizedState=qm(s),e.memoizedState=Qm,o);if(!(e.mode&1))return wu(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,o=Error(z(419)),n=Kh(o,n,void 0),wu(t,e,s,n)}if(l=(s&t.childLanes)!==0,Rr||l){if(n=Ht,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,wi(t,i),En(n,t,i,-1))}return $p(),n=Kh(Error(z(421))),wu(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=UM.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Ir=Ui(i.nextSibling),Pr=e,tt=!0,vn=null,t!==null&&(Gr[Kr++]=ai,Gr[Kr++]=ui,Gr[Kr++]=Ao,ai=t.id,ui=t.overflow,Ao=e),e=Ap(e,n.children),e.flags|=4096,e)}function Oy(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),jm(t.return,e,r)}function Xh(t,e,r,n,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function sE(t,e,r){var n=e.pendingProps,i=n.revealOrder,o=n.tail;if(tr(t,e,n.children,r),n=it.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Oy(t,r,e);else if(t.tag===19)Oy(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ze(it,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Xc(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Xh(e,!1,i,r,o);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Xc(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Xh(e,!0,r,null,o);break;case"together":Xh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function vi(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Do|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,r=Xi(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Xi(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function AM(t,e,r){switch(e.tag){case 3:iE(e),Vs();break;case 5:PR(e);break;case 1:br(e.type)&&zc(e);break;case 4:Tp(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ze(Yc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ze(it,it.current&1),e.flags|=128,null):r&e.child.childLanes?oE(t,e,r):(ze(it,it.current&1),t=vi(t,e,r),t!==null?t.sibling:null);ze(it,it.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return sE(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ze(it,it.current),n)break;return null;case 22:case 23:return e.lanes=0,rE(t,e,r)}return vi(t,e,r)}var lE,Zm,aE,uE;lE=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Zm=function(){};aE=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Oo(Wn.current);var o=null;switch(r){case"input":i=Cm(t,i),n=Cm(t,n),o=[];break;case"select":i=lt({},i,{value:void 0}),n=lt({},n,{value:void 0}),o=[];break;case"textarea":i=Em(t,i),n=Em(t,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Wc)}Tm(r,n);var s;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(aa.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var a=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(r||(r={}),r[s]=a[s])}else r||(o||(o=[]),o.push(u,r)),r=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(aa.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&je("scroll",t),o||l===a||(o=[])):(o=o||[]).push(u,a))}r&&(o=o||[]).push("style",r);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};uE=function(t,e,r,n){r!==n&&(e.flags|=4)};function gl(t,e){if(!tt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function NM(t,e,r){var n=e.pendingProps;switch(vp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(e),null;case 1:return br(e.type)&&Bc(),zt(e),null;case 3:return n=e.stateNode,Bs(),Ue(Er),Ue(Xt),Op(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(gu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vn!==null&&(sg(vn),vn=null))),Zm(t,e),zt(e),null;case 5:_p(e);var i=Oo(Ca.current);if(r=e.type,t!==null&&e.stateNode!=null)aE(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(z(166));return zt(e),null}if(t=Oo(Wn.current),gu(e)){n=e.stateNode,r=e.type;var o=e.memoizedProps;switch(n[Ln]=e,n[va]=o,t=(e.mode&1)!==0,r){case"dialog":je("cancel",n),je("close",n);break;case"iframe":case"object":case"embed":je("load",n);break;case"video":case"audio":for(i=0;i<jl.length;i++)je(jl[i],n);break;case"source":je("error",n);break;case"img":case"image":case"link":je("error",n),je("load",n);break;case"details":je("toggle",n);break;case"input":kv(n,o),je("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},je("invalid",n);break;case"textarea":Fv(n,o),je("invalid",n)}Tm(r,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?n.textContent!==l&&(o.suppressHydrationWarning!==!0&&mu(n.textContent,l,t),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&mu(n.textContent,l,t),i=["children",""+l]):aa.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&je("scroll",n)}switch(r){case"input":su(n),Lv(n,o,!0);break;case"textarea":su(n),$v(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=Wc)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=L0(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[Ln]=e,t[va]=n,lE(t,e,!1,!1),e.stateNode=t;e:{switch(s=_m(r,n),r){case"dialog":je("cancel",t),je("close",t),i=n;break;case"iframe":case"object":case"embed":je("load",t),i=n;break;case"video":case"audio":for(i=0;i<jl.length;i++)je(jl[i],t);i=n;break;case"source":je("error",t),i=n;break;case"img":case"image":case"link":je("error",t),je("load",t),i=n;break;case"details":je("toggle",t),i=n;break;case"input":kv(t,n),i=Cm(t,n),je("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=lt({},n,{value:void 0}),je("invalid",t);break;case"textarea":Fv(t,n),i=Em(t,n),je("invalid",t);break;default:i=n}Tm(r,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?V0(t,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&F0(t,a)):o==="children"?typeof a=="string"?(r!=="textarea"||a!=="")&&ua(t,a):typeof a=="number"&&ua(t,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(aa.hasOwnProperty(o)?a!=null&&o==="onScroll"&&je("scroll",t):a!=null&&np(t,o,a,s))}switch(r){case"input":su(t),Lv(t,n,!1);break;case"textarea":su(t),$v(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ji(n.value));break;case"select":t.multiple=!!n.multiple,o=n.value,o!=null?Ms(t,!!n.multiple,o,!1):n.defaultValue!=null&&Ms(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Wc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zt(e),null;case 6:if(t&&e.stateNode!=null)uE(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(z(166));if(r=Oo(Ca.current),Oo(Wn.current),gu(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ln]=e,(o=n.nodeValue!==r)&&(t=Pr,t!==null))switch(t.tag){case 3:mu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&mu(n.nodeValue,r,(t.mode&1)!==0)}o&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ln]=e,e.stateNode=n}return zt(e),null;case 13:if(Ue(it),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(tt&&Ir!==null&&e.mode&1&&!(e.flags&128))OR(),Vs(),e.flags|=98560,o=!1;else if(o=gu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!o)throw Error(z(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(z(317));o[Ln]=e}else Vs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zt(e),o=!1}else vn!==null&&(sg(vn),vn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||it.current&1?Rt===0&&(Rt=3):$p())),e.updateQueue!==null&&(e.flags|=4),zt(e),null);case 4:return Bs(),Zm(t,e),t===null&&pa(e.stateNode.containerInfo),zt(e),null;case 10:return Rp(e.type._context),zt(e),null;case 17:return br(e.type)&&Bc(),zt(e),null;case 19:if(Ue(it),o=e.memoizedState,o===null)return zt(e),null;if(n=(e.flags&128)!==0,s=o.rendering,s===null)if(n)gl(o,!1);else{if(Rt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Xc(t),s!==null){for(e.flags|=128,gl(o,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)o=r,t=n,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ze(it,it.current&1|2),e.child}t=t.sibling}o.tail!==null&&ft()>js&&(e.flags|=128,n=!0,gl(o,!1),e.lanes=4194304)}else{if(!n)if(t=Xc(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),gl(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!tt)return zt(e),null}else 2*ft()-o.renderingStartTime>js&&r!==1073741824&&(e.flags|=128,n=!0,gl(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(r=o.last,r!==null?r.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ft(),e.sibling=null,r=it.current,ze(it,n?r&1|2:r&1),e):(zt(e),null);case 22:case 23:return Fp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?xr&1073741824&&(zt(e),e.subtreeFlags&6&&(e.flags|=8192)):zt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function DM(t,e){switch(vp(e),e.tag){case 1:return br(e.type)&&Bc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Bs(),Ue(Er),Ue(Xt),Op(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _p(e),null;case 13:if(Ue(it),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));Vs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ue(it),null;case 4:return Bs(),null;case 10:return Rp(e.type._context),null;case 22:case 23:return Fp(),null;case 24:return null;default:return null}}var vu=!1,Yt=!1,kM=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Rs(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ut(t,e,n)}else r.current=null}function Jm(t,e,r){try{r()}catch(n){ut(t,e,n)}}var xy=!1;function LM(t,e){if(km=Fc,t=mR(),pp(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var s=0,l=-1,a=-1,u=0,d=0,f=t,m=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=s+i),f!==o||n!==0&&f.nodeType!==3||(a=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)m=f,f=p;for(;;){if(f===t)break t;if(m===r&&++u===i&&(l=s),m===o&&++d===n&&(a=s),(p=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=p}r=l===-1||a===-1?null:{start:l,end:a}}else r=null}r=r||{start:0,end:0}}else r=null;for(Lm={focusedElem:t,selectionRange:r},Fc=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var S=C.memoizedProps,H=C.memoizedState,w=e.stateNode,v=w.getSnapshotBeforeUpdate(e.elementType===e.type?S:pn(e.type,S),H);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(x){ut(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return C=xy,xy=!1,C}function Jl(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Jm(e,r,o)}i=i.next}while(i!==n)}}function Ad(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function eg(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function cE(t){var e=t.alternate;e!==null&&(t.alternate=null,cE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ln],delete e[va],delete e[Vm],delete e[yM],delete e[CM])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dE(t){return t.tag===5||t.tag===3||t.tag===4}function My(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Wc));else if(n!==4&&(t=t.child,t!==null))for(tg(t,e,r),t=t.sibling;t!==null;)tg(t,e,r),t=t.sibling}function rg(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(rg(t,e,r),t=t.sibling;t!==null;)rg(t,e,r),t=t.sibling}var kt=null,wn=!1;function Ti(t,e,r){for(r=r.child;r!==null;)hE(t,e,r),r=r.sibling}function hE(t,e,r){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(Td,r)}catch{}switch(r.tag){case 5:Yt||Rs(r,e);case 6:var n=kt,i=wn;kt=null,Ti(t,e,r),kt=n,wn=i,kt!==null&&(wn?(t=kt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):kt.removeChild(r.stateNode));break;case 18:kt!==null&&(wn?(t=kt,r=r.stateNode,t.nodeType===8?Bh(t.parentNode,r):t.nodeType===1&&Bh(t,r),fa(t)):Bh(kt,r.stateNode));break;case 4:n=kt,i=wn,kt=r.stateNode.containerInfo,wn=!0,Ti(t,e,r),kt=n,wn=i;break;case 0:case 11:case 14:case 15:if(!Yt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Jm(r,e,s),i=i.next}while(i!==n)}Ti(t,e,r);break;case 1:if(!Yt&&(Rs(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ut(r,e,l)}Ti(t,e,r);break;case 21:Ti(t,e,r);break;case 22:r.mode&1?(Yt=(n=Yt)||r.memoizedState!==null,Ti(t,e,r),Yt=n):Ti(t,e,r);break;default:Ti(t,e,r)}}function Iy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new kM),e.forEach(function(n){var i=YM.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function an(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=t,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:kt=l.stateNode,wn=!1;break e;case 3:kt=l.stateNode.containerInfo,wn=!0;break e;case 4:kt=l.stateNode.containerInfo,wn=!0;break e}l=l.return}if(kt===null)throw Error(z(160));hE(o,s,i),kt=null,wn=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){ut(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)fE(e,t),e=e.sibling}function fE(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(an(e,t),xn(t),n&4){try{Jl(3,t,t.return),Ad(3,t)}catch(S){ut(t,t.return,S)}try{Jl(5,t,t.return)}catch(S){ut(t,t.return,S)}}break;case 1:an(e,t),xn(t),n&512&&r!==null&&Rs(r,r.return);break;case 5:if(an(e,t),xn(t),n&512&&r!==null&&Rs(r,r.return),t.flags&32){var i=t.stateNode;try{ua(i,"")}catch(S){ut(t,t.return,S)}}if(n&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=r!==null?r.memoizedProps:o,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&D0(i,o),_m(l,s);var u=_m(l,o);for(s=0;s<a.length;s+=2){var d=a[s],f=a[s+1];d==="style"?V0(i,f):d==="dangerouslySetInnerHTML"?F0(i,f):d==="children"?ua(i,f):np(i,d,f,u)}switch(l){case"input":Sm(i,o);break;case"textarea":k0(i,o);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Ms(i,!!o.multiple,p,!1):m!==!!o.multiple&&(o.defaultValue!=null?Ms(i,!!o.multiple,o.defaultValue,!0):Ms(i,!!o.multiple,o.multiple?[]:"",!1))}i[va]=o}catch(S){ut(t,t.return,S)}}break;case 6:if(an(e,t),xn(t),n&4){if(t.stateNode===null)throw Error(z(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(S){ut(t,t.return,S)}}break;case 3:if(an(e,t),xn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{fa(e.containerInfo)}catch(S){ut(t,t.return,S)}break;case 4:an(e,t),xn(t);break;case 13:an(e,t),xn(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(kp=ft())),n&4&&Iy(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Yt=(u=Yt)||d,an(e,t),Yt=u):an(e,t),xn(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Z=t,d=t.child;d!==null;){for(f=Z=d;Z!==null;){switch(m=Z,p=m.child,m.tag){case 0:case 11:case 14:case 15:Jl(4,m,m.return);break;case 1:Rs(m,m.return);var C=m.stateNode;if(typeof C.componentWillUnmount=="function"){n=m,r=m.return;try{e=n,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(S){ut(n,r,S)}}break;case 5:Rs(m,m.return);break;case 22:if(m.memoizedState!==null){Py(f);continue}}p!==null?(p.return=m,Z=p):Py(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,a=f.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=$0("display",s))}catch(S){ut(t,t.return,S)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(S){ut(t,t.return,S)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:an(e,t),xn(t),n&4&&Iy(t);break;case 21:break;default:an(e,t),xn(t)}}function xn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(dE(r)){var n=r;break e}r=r.return}throw Error(z(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ua(i,""),n.flags&=-33);var o=My(t);rg(t,o,i);break;case 3:case 4:var s=n.stateNode.containerInfo,l=My(t);tg(t,l,s);break;default:throw Error(z(161))}}catch(a){ut(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function FM(t,e,r){Z=t,mE(t)}function mE(t,e,r){for(var n=(t.mode&1)!==0;Z!==null;){var i=Z,o=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||vu;if(!s){var l=i.alternate,a=l!==null&&l.memoizedState!==null||Yt;l=vu;var u=Yt;if(vu=s,(Yt=a)&&!u)for(Z=i;Z!==null;)s=Z,a=s.child,s.tag===22&&s.memoizedState!==null?Ay(i):a!==null?(a.return=s,Z=a):Ay(i);for(;o!==null;)Z=o,mE(o),o=o.sibling;Z=i,vu=l,Yt=u}Hy(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Z=o):Hy(t)}}function Hy(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yt||Ad(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Yt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:pn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&gy(e,o,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}gy(e,s,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break;case"img":a.src&&(r.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&fa(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Yt||e.flags&512&&eg(e)}catch(m){ut(e,e.return,m)}}if(e===t){Z=null;break}if(r=e.sibling,r!==null){r.return=e.return,Z=r;break}Z=e.return}}function Py(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Z=r;break}Z=e.return}}function Ay(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Ad(4,e)}catch(a){ut(e,r,a)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(a){ut(e,i,a)}}var o=e.return;try{eg(e)}catch(a){ut(e,o,a)}break;case 5:var s=e.return;try{eg(e)}catch(a){ut(e,s,a)}}}catch(a){ut(e,e.return,a)}if(e===t){Z=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Z=l;break}Z=e.return}}var $M=Math.ceil,Zc=Ci.ReactCurrentDispatcher,Np=Ci.ReactCurrentOwner,Jr=Ci.ReactCurrentBatchConfig,Ie=0,Ht=null,wt=null,Lt=0,xr=0,Es=io(0),Rt=0,ba=null,Do=0,Nd=0,Dp=0,ea=null,Cr=null,kp=0,js=1/0,ii=null,Jc=!1,ng=null,Gi=null,yu=!1,Fi=null,ed=0,ta=0,ig=null,pc=-1,wc=0;function rr(){return Ie&6?ft():pc!==-1?pc:pc=ft()}function Ki(t){return t.mode&1?Ie&2&&Lt!==0?Lt&-Lt:RM.transition!==null?(wc===0&&(wc=Z0()),wc):(t=ke,t!==0||(t=window.event,t=t===void 0?16:oR(t.type)),t):1}function En(t,e,r,n){if(50<ta)throw ta=0,ig=null,Error(z(185));La(t,r,n),(!(Ie&2)||t!==Ht)&&(t===Ht&&(!(Ie&2)&&(Nd|=r),Rt===4&&Di(t,Lt)),Tr(t,n),r===1&&Ie===0&&!(e.mode&1)&&(js=ft()+500,Id&&oo()))}function Tr(t,e){var r=t.callbackNode;Rx(t,e);var n=Lc(t,t===Ht?Lt:0);if(n===0)r!==null&&Bv(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Bv(r),e===1)t.tag===0?SM(Ny.bind(null,t)):bR(Ny.bind(null,t)),wM(function(){!(Ie&6)&&oo()}),r=null;else{switch(J0(n)){case 1:r=ap;break;case 4:r=Q0;break;case 16:r=kc;break;case 536870912:r=q0;break;default:r=kc}r=RE(r,gE.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function gE(t,e){if(pc=-1,wc=0,Ie&6)throw Error(z(327));var r=t.callbackNode;if(Ns()&&t.callbackNode!==r)return null;var n=Lc(t,t===Ht?Lt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=td(t,n);else{e=n;var i=Ie;Ie|=2;var o=wE();(Ht!==t||Lt!==e)&&(ii=null,js=ft()+500,Mo(t,e));do try{BM();break}catch(l){pE(t,l)}while(!0);Sp(),Zc.current=o,Ie=i,wt!==null?e=0:(Ht=null,Lt=0,e=Rt)}if(e!==0){if(e===2&&(i=Hm(t),i!==0&&(n=i,e=og(t,i))),e===1)throw r=ba,Mo(t,0),Di(t,n),Tr(t,ft()),r;if(e===6)Di(t,n);else{if(i=t.current.alternate,!(n&30)&&!VM(i)&&(e=td(t,n),e===2&&(o=Hm(t),o!==0&&(n=o,e=og(t,o))),e===1))throw r=ba,Mo(t,0),Di(t,n),Tr(t,ft()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(z(345));case 2:Eo(t,Cr,ii);break;case 3:if(Di(t,n),(n&130023424)===n&&(e=kp+500-ft(),10<e)){if(Lc(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){rr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=$m(Eo.bind(null,t,Cr,ii),e);break}Eo(t,Cr,ii);break;case 4:if(Di(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-Rn(n);o=1<<s,s=e[s],s>i&&(i=s),n&=~o}if(n=i,n=ft()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*$M(n/1960))-n,10<n){t.timeoutHandle=$m(Eo.bind(null,t,Cr,ii),n);break}Eo(t,Cr,ii);break;case 5:Eo(t,Cr,ii);break;default:throw Error(z(329))}}}return Tr(t,ft()),t.callbackNode===r?gE.bind(null,t):null}function og(t,e){var r=ea;return t.current.memoizedState.isDehydrated&&(Mo(t,e).flags|=256),t=td(t,e),t!==2&&(e=Cr,Cr=r,e!==null&&sg(e)),t}function sg(t){Cr===null?Cr=t:Cr.push.apply(Cr,t)}function VM(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!bn(o(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Di(t,e){for(e&=~Dp,e&=~Nd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Rn(e),n=1<<r;t[r]=-1,e&=~n}}function Ny(t){if(Ie&6)throw Error(z(327));Ns();var e=Lc(t,0);if(!(e&1))return Tr(t,ft()),null;var r=td(t,e);if(t.tag!==0&&r===2){var n=Hm(t);n!==0&&(e=n,r=og(t,n))}if(r===1)throw r=ba,Mo(t,0),Di(t,e),Tr(t,ft()),r;if(r===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Eo(t,Cr,ii),Tr(t,ft()),null}function Lp(t,e){var r=Ie;Ie|=1;try{return t(e)}finally{Ie=r,Ie===0&&(js=ft()+500,Id&&oo())}}function ko(t){Fi!==null&&Fi.tag===0&&!(Ie&6)&&Ns();var e=Ie;Ie|=1;var r=Jr.transition,n=ke;try{if(Jr.transition=null,ke=1,t)return t()}finally{ke=n,Jr.transition=r,Ie=e,!(Ie&6)&&oo()}}function Fp(){xr=Es.current,Ue(Es)}function Mo(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,pM(r)),wt!==null)for(r=wt.return;r!==null;){var n=r;switch(vp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Bc();break;case 3:Bs(),Ue(Er),Ue(Xt),Op();break;case 5:_p(n);break;case 4:Bs();break;case 13:Ue(it);break;case 19:Ue(it);break;case 10:Rp(n.type._context);break;case 22:case 23:Fp()}r=r.return}if(Ht=t,wt=t=Xi(t.current,null),Lt=xr=e,Rt=0,ba=null,Dp=Nd=Do=0,Cr=ea=null,_o!==null){for(e=0;e<_o.length;e++)if(r=_o[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var s=o.next;o.next=i,n.next=s}r.pending=n}_o=null}return t}function pE(t,e){do{var r=wt;try{if(Sp(),fc.current=qc,Qc){for(var n=st.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Qc=!1}if(No=0,Mt=Ct=st=null,Zl=!1,Sa=0,Np.current=null,r===null||r.return===null){Rt=1,ba=e,wt=null;break}e:{var o=t,s=r.return,l=r,a=e;if(e=Lt,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Sy(s);if(p!==null){p.flags&=-257,Ry(p,s,l,o,e),p.mode&1&&Cy(o,u,e),e=p,a=u;var C=e.updateQueue;if(C===null){var S=new Set;S.add(a),e.updateQueue=S}else C.add(a);break e}else{if(!(e&1)){Cy(o,u,e),$p();break e}a=Error(z(426))}}else if(tt&&l.mode&1){var H=Sy(s);if(H!==null){!(H.flags&65536)&&(H.flags|=256),Ry(H,s,l,o,e),yp(zs(a,l));break e}}o=a=zs(a,l),Rt!==4&&(Rt=2),ea===null?ea=[o]:ea.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var w=JR(o,a,e);my(o,w);break e;case 1:l=a;var v=o.type,E=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Gi===null||!Gi.has(E)))){o.flags|=65536,e&=-e,o.lanes|=e;var x=eE(o,l,e);my(o,x);break e}}o=o.return}while(o!==null)}yE(r)}catch($){e=$,wt===r&&r!==null&&(wt=r=r.return);continue}break}while(!0)}function wE(){var t=Zc.current;return Zc.current=qc,t===null?qc:t}function $p(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),Ht===null||!(Do&268435455)&&!(Nd&268435455)||Di(Ht,Lt)}function td(t,e){var r=Ie;Ie|=2;var n=wE();(Ht!==t||Lt!==e)&&(ii=null,Mo(t,e));do try{WM();break}catch(i){pE(t,i)}while(!0);if(Sp(),Ie=r,Zc.current=n,wt!==null)throw Error(z(261));return Ht=null,Lt=0,Rt}function WM(){for(;wt!==null;)vE(wt)}function BM(){for(;wt!==null&&!fx();)vE(wt)}function vE(t){var e=SE(t.alternate,t,xr);t.memoizedProps=t.pendingProps,e===null?yE(t):wt=e,Np.current=null}function yE(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=DM(r,e),r!==null){r.flags&=32767,wt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Rt=6,wt=null;return}}else if(r=NM(r,e,xr),r!==null){wt=r;return}if(e=e.sibling,e!==null){wt=e;return}wt=e=t}while(e!==null);Rt===0&&(Rt=5)}function Eo(t,e,r){var n=ke,i=Jr.transition;try{Jr.transition=null,ke=1,zM(t,e,r,n)}finally{Jr.transition=i,ke=n}return null}function zM(t,e,r,n){do Ns();while(Fi!==null);if(Ie&6)throw Error(z(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(Ex(t,o),t===Ht&&(wt=Ht=null,Lt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yu||(yu=!0,RE(kc,function(){return Ns(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Jr.transition,Jr.transition=null;var s=ke;ke=1;var l=Ie;Ie|=4,Np.current=null,LM(t,r),fE(r,t),uM(Lm),Fc=!!km,Lm=km=null,t.current=r,FM(r),mx(),Ie=l,ke=s,Jr.transition=o}else t.current=r;if(yu&&(yu=!1,Fi=t,ed=i),o=t.pendingLanes,o===0&&(Gi=null),wx(r.stateNode),Tr(t,ft()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Jc)throw Jc=!1,t=ng,ng=null,t;return ed&1&&t.tag!==0&&Ns(),o=t.pendingLanes,o&1?t===ig?ta++:(ta=0,ig=t):ta=0,oo(),null}function Ns(){if(Fi!==null){var t=J0(ed),e=Jr.transition,r=ke;try{if(Jr.transition=null,ke=16>t?16:t,Fi===null)var n=!1;else{if(t=Fi,Fi=null,ed=0,Ie&6)throw Error(z(331));var i=Ie;for(Ie|=4,Z=t.current;Z!==null;){var o=Z,s=o.child;if(Z.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(Z=u;Z!==null;){var d=Z;switch(d.tag){case 0:case 11:case 15:Jl(8,d,o)}var f=d.child;if(f!==null)f.return=d,Z=f;else for(;Z!==null;){d=Z;var m=d.sibling,p=d.return;if(cE(d),d===u){Z=null;break}if(m!==null){m.return=p,Z=m;break}Z=p}}}var C=o.alternate;if(C!==null){var S=C.child;if(S!==null){C.child=null;do{var H=S.sibling;S.sibling=null,S=H}while(S!==null)}}Z=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Z=s;else e:for(;Z!==null;){if(o=Z,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Jl(9,o,o.return)}var w=o.sibling;if(w!==null){w.return=o.return,Z=w;break e}Z=o.return}}var v=t.current;for(Z=v;Z!==null;){s=Z;var E=s.child;if(s.subtreeFlags&2064&&E!==null)E.return=s,Z=E;else e:for(s=v;Z!==null;){if(l=Z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ad(9,l)}}catch($){ut(l,l.return,$)}if(l===s){Z=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,Z=x;break e}Z=l.return}}if(Ie=i,oo(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(Td,t)}catch{}n=!0}return n}finally{ke=r,Jr.transition=e}}return!1}function Dy(t,e,r){e=zs(r,e),e=JR(t,e,1),t=Yi(t,e,1),e=rr(),t!==null&&(La(t,1,e),Tr(t,e))}function ut(t,e,r){if(t.tag===3)Dy(t,t,r);else for(;e!==null;){if(e.tag===3){Dy(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Gi===null||!Gi.has(n))){t=zs(r,t),t=eE(e,t,1),e=Yi(e,t,1),t=rr(),e!==null&&(La(e,1,t),Tr(e,t));break}}e=e.return}}function jM(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=rr(),t.pingedLanes|=t.suspendedLanes&r,Ht===t&&(Lt&r)===r&&(Rt===4||Rt===3&&(Lt&130023424)===Lt&&500>ft()-kp?Mo(t,0):Dp|=r),Tr(t,e)}function CE(t,e){e===0&&(t.mode&1?(e=uu,uu<<=1,!(uu&130023424)&&(uu=4194304)):e=1);var r=rr();t=wi(t,e),t!==null&&(La(t,e,r),Tr(t,r))}function UM(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),CE(t,r)}function YM(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(z(314))}n!==null&&n.delete(e),CE(t,r)}var SE;SE=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Er.current)Rr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Rr=!1,AM(t,e,r);Rr=!!(t.flags&131072)}else Rr=!1,tt&&e.flags&1048576&&TR(e,Uc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;gc(t,e),t=e.pendingProps;var i=$s(e,Xt.current);As(e,r),i=Mp(null,e,n,t,i,r);var o=Ip();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,br(n)?(o=!0,zc(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,bp(e),i.updater=Pd,e.stateNode=i,i._reactInternals=e,Ym(e,n,t,r),e=Xm(null,e,n,!0,o,r)):(e.tag=0,tt&&o&&wp(e),tr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(gc(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=KM(n),t=pn(n,t),i){case 0:e=Km(null,e,n,t,r);break e;case 1:e=Ty(null,e,n,t,r);break e;case 11:e=Ey(null,e,n,t,r);break e;case 14:e=by(null,e,n,pn(n.type,t),r);break e}throw Error(z(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),Km(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),Ty(t,e,n,i,r);case 3:e:{if(iE(e),t===null)throw Error(z(387));n=e.pendingProps,o=e.memoizedState,i=o.element,HR(t,e),Kc(e,n,null,r);var s=e.memoizedState;if(n=s.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=zs(Error(z(423)),e),e=_y(t,e,n,r,i);break e}else if(n!==i){i=zs(Error(z(424)),e),e=_y(t,e,n,r,i);break e}else for(Ir=Ui(e.stateNode.containerInfo.firstChild),Pr=e,tt=!0,vn=null,r=MR(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Vs(),n===i){e=vi(t,e,r);break e}tr(t,e,n,r)}e=e.child}return e;case 5:return PR(e),t===null&&zm(e),n=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Fm(n,i)?s=null:o!==null&&Fm(n,o)&&(e.flags|=32),nE(t,e),tr(t,e,s,r),e.child;case 6:return t===null&&zm(e),null;case 13:return oE(t,e,r);case 4:return Tp(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ws(e,null,n,r):tr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),Ey(t,e,n,i,r);case 7:return tr(t,e,e.pendingProps,r),e.child;case 8:return tr(t,e,e.pendingProps.children,r),e.child;case 12:return tr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,ze(Yc,n._currentValue),n._currentValue=s,o!==null)if(bn(o.value,s)){if(o.children===i.children&&!Er.current){e=vi(t,e,r);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var a=l.firstContext;a!==null;){if(a.context===n){if(o.tag===1){a=fi(-1,r&-r),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?a.next=a:(a.next=d.next,d.next=a),u.pending=a}}o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),jm(o.return,r,e),l.lanes|=r;break}a=a.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(z(341));s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),jm(s,r,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}tr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,As(e,r),i=tn(i),n=n(i),e.flags|=1,tr(t,e,n,r),e.child;case 14:return n=e.type,i=pn(n,e.pendingProps),i=pn(n.type,i),by(t,e,n,i,r);case 15:return tE(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),gc(t,e),e.tag=1,br(n)?(t=!0,zc(e)):t=!1,As(e,r),ZR(e,n,i),Ym(e,n,i,r),Xm(null,e,n,!0,t,r);case 19:return sE(t,e,r);case 22:return rE(t,e,r)}throw Error(z(156,e.tag))};function RE(t,e){return X0(t,e)}function GM(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zr(t,e,r,n){return new GM(t,e,r,n)}function Vp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function KM(t){if(typeof t=="function")return Vp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===op)return 11;if(t===sp)return 14}return 2}function Xi(t,e){var r=t.alternate;return r===null?(r=Zr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function vc(t,e,r,n,i,o){var s=2;if(n=t,typeof t=="function")Vp(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case fs:return Io(r.children,i,o,e);case ip:s=8,i|=8;break;case pm:return t=Zr(12,r,e,i|2),t.elementType=pm,t.lanes=o,t;case wm:return t=Zr(13,r,e,i),t.elementType=wm,t.lanes=o,t;case vm:return t=Zr(19,r,e,i),t.elementType=vm,t.lanes=o,t;case P0:return Dd(r,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case I0:s=10;break e;case H0:s=9;break e;case op:s=11;break e;case sp:s=14;break e;case Ii:s=16,n=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=Zr(s,r,e,i),e.elementType=t,e.type=n,e.lanes=o,e}function Io(t,e,r,n){return t=Zr(7,t,n,e),t.lanes=r,t}function Dd(t,e,r,n){return t=Zr(22,t,n,e),t.elementType=P0,t.lanes=r,t.stateNode={isHidden:!1},t}function Qh(t,e,r){return t=Zr(6,t,null,e),t.lanes=r,t}function qh(t,e,r){return e=Zr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function XM(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hh(0),this.expirationTimes=Hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hh(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wp(t,e,r,n,i,o,s,l,a){return t=new XM(t,e,r,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Zr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},bp(o),t}function QM(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hs,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function EE(t){if(!t)return eo;t=t._reactInternals;e:{if(zo(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(br(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var r=t.type;if(br(r))return ER(t,r,e)}return e}function bE(t,e,r,n,i,o,s,l,a){return t=Wp(r,n,!0,t,i,o,s,l,a),t.context=EE(null),r=t.current,n=rr(),i=Ki(r),o=fi(n,i),o.callback=e??null,Yi(r,o,i),t.current.lanes=i,La(t,i,n),Tr(t,n),t}function kd(t,e,r,n){var i=e.current,o=rr(),s=Ki(i);return r=EE(r),e.context===null?e.context=r:e.pendingContext=r,e=fi(o,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Yi(i,e,s),t!==null&&(En(t,i,s,o),hc(t,i,s)),s}function rd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ky(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Bp(t,e){ky(t,e),(t=t.alternate)&&ky(t,e)}function qM(){return null}var TE=typeof reportError=="function"?reportError:function(t){console.error(t)};function zp(t){this._internalRoot=t}Ld.prototype.render=zp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));kd(t,e,null,null)};Ld.prototype.unmount=zp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ko(function(){kd(null,t,null,null)}),e[pi]=null}};function Ld(t){this._internalRoot=t}Ld.prototype.unstable_scheduleHydration=function(t){if(t){var e=rR();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ni.length&&e!==0&&e<Ni[r].priority;r++);Ni.splice(r,0,t),r===0&&iR(t)}};function jp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Fd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ly(){}function ZM(t,e,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var u=rd(s);o.call(u)}}var s=bE(e,n,t,0,null,!1,!1,"",Ly);return t._reactRootContainer=s,t[pi]=s.current,pa(t.nodeType===8?t.parentNode:t),ko(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=rd(a);l.call(u)}}var a=Wp(t,0,!1,null,null,!1,!1,"",Ly);return t._reactRootContainer=a,t[pi]=a.current,pa(t.nodeType===8?t.parentNode:t),ko(function(){kd(e,a,r,n)}),a}function $d(t,e,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var a=rd(s);l.call(a)}}kd(e,s,t,i)}else s=ZM(r,e,t,i,n);return rd(s)}eR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=zl(e.pendingLanes);r!==0&&(up(e,r|1),Tr(e,ft()),!(Ie&6)&&(js=ft()+500,oo()))}break;case 13:ko(function(){var n=wi(t,1);if(n!==null){var i=rr();En(n,t,1,i)}}),Bp(t,1)}};cp=function(t){if(t.tag===13){var e=wi(t,134217728);if(e!==null){var r=rr();En(e,t,134217728,r)}Bp(t,134217728)}};tR=function(t){if(t.tag===13){var e=Ki(t),r=wi(t,e);if(r!==null){var n=rr();En(r,t,e,n)}Bp(t,e)}};rR=function(){return ke};nR=function(t,e){var r=ke;try{return ke=t,e()}finally{ke=r}};xm=function(t,e,r){switch(e){case"input":if(Sm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Md(n);if(!i)throw Error(z(90));N0(n),Sm(n,i)}}}break;case"textarea":k0(t,r);break;case"select":e=r.value,e!=null&&Ms(t,!!r.multiple,e,!1)}};z0=Lp;j0=ko;var JM={usingClientEntryPoint:!1,Events:[$a,ws,Md,W0,B0,Lp]},pl={findFiberByHostInstance:To,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eI={bundleType:pl.bundleType,version:pl.version,rendererPackageName:pl.rendererPackageName,rendererConfig:pl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ci.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=G0(t),t===null?null:t.stateNode},findFiberByHostInstance:pl.findFiberByHostInstance||qM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cu.isDisabled&&Cu.supportsFiber)try{Td=Cu.inject(eI),Vn=Cu}catch{}}kr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JM;kr.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jp(e))throw Error(z(200));return QM(t,e,null,r)};kr.createRoot=function(t,e){if(!jp(t))throw Error(z(299));var r=!1,n="",i=TE;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Wp(t,1,!1,null,null,r,!1,n,i),t[pi]=e.current,pa(t.nodeType===8?t.parentNode:t),new zp(e)};kr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=G0(e),t=t===null?null:t.stateNode,t};kr.flushSync=function(t){return ko(t)};kr.hydrate=function(t,e,r){if(!Fd(e))throw Error(z(200));return $d(null,t,e,!0,r)};kr.hydrateRoot=function(t,e,r){if(!jp(t))throw Error(z(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",s=TE;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=bE(e,null,t,1,r??null,i,!1,o,s),t[pi]=e.current,pa(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Ld(e)};kr.render=function(t,e,r){if(!Fd(e))throw Error(z(200));return $d(null,t,e,!1,r)};kr.unmountComponentAtNode=function(t){if(!Fd(t))throw Error(z(40));return t._reactRootContainer?(ko(function(){$d(null,null,t,!1,function(){t._reactRootContainer=null,t[pi]=null})}),!0):!1};kr.unstable_batchedUpdates=Lp;kr.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Fd(r))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return $d(t,e,r,!1,n)};kr.version="18.3.1-next-f1338f8080-20240426";function _E(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_E)}catch(t){console.error(t)}}_E(),_0.exports=kr;var OE=_0.exports;const xE=Qg(OE);var Fy=OE;mm.createRoot=Fy.createRoot,mm.hydrateRoot=Fy.hydrateRoot;var wl=function(t){return t&&t.Math===Math&&t},Qt=wl(typeof globalThis=="object"&&globalThis)||wl(typeof window=="object"&&window)||wl(typeof self=="object"&&self)||wl(typeof Vl=="object"&&Vl)||wl(typeof Vl=="object"&&Vl)||function(){return this}()||Function("return this")(),Up={},on=function(t){try{return!!t()}catch{return!0}},tI=on,Un=!tI(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),rI=on,Vd=!rI(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),nI=Vd,Su=Function.prototype.call,rl=nI?Su.bind(Su):function(){return Su.apply(Su,arguments)},ME={},IE={}.propertyIsEnumerable,HE=Object.getOwnPropertyDescriptor,iI=HE&&!IE.call({1:2},1);ME.f=iI?function(e){var r=HE(this,e);return!!r&&r.enumerable}:IE;var Yp=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},PE=Vd,AE=Function.prototype,lg=AE.call,oI=PE&&AE.bind.bind(lg,lg),$t=PE?oI:function(t){return function(){return lg.apply(t,arguments)}},NE=$t,sI=NE({}.toString),lI=NE("".slice),jo=function(t){return lI(sI(t),8,-1)},aI=$t,uI=on,cI=jo,Zh=Object,dI=aI("".split),hI=uI(function(){return!Zh("z").propertyIsEnumerable(0)})?function(t){return cI(t)==="String"?dI(t,""):Zh(t)}:Zh,Gp=function(t){return t==null},fI=Gp,mI=TypeError,Wd=function(t){if(fI(t))throw new mI("Can't call method on "+t);return t},gI=hI,pI=Wd,Bd=function(t){return gI(pI(t))},Jh=typeof document=="object"&&document.all,Vt=typeof Jh>"u"&&Jh!==void 0?function(t){return typeof t=="function"||t===Jh}:function(t){return typeof t=="function"},wI=Vt,Yn=function(t){return typeof t=="object"?t!==null:wI(t)},ef=Qt,vI=Vt,yI=function(t){return vI(t)?t:void 0},Wa=function(t,e){return arguments.length<2?yI(ef[t]):ef[t]&&ef[t][e]},CI=$t,Kp=CI({}.isPrototypeOf),Xp=typeof navigator<"u"&&String(navigator.userAgent)||"",DE=Qt,tf=Xp,$y=DE.process,Vy=DE.Deno,Wy=$y&&$y.versions||Vy&&Vy.version,By=Wy&&Wy.v8,yn,nd;By&&(yn=By.split("."),nd=yn[0]>0&&yn[0]<4?1:+(yn[0]+yn[1]));!nd&&tf&&(yn=tf.match(/Edge\/(\d+)/),(!yn||yn[1]>=74)&&(yn=tf.match(/Chrome\/(\d+)/),yn&&(nd=+yn[1])));var SI=nd,zy=SI,RI=on,EI=Qt,bI=EI.String,Qp=!!Object.getOwnPropertySymbols&&!RI(function(){var t=Symbol("symbol detection");return!bI(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&zy&&zy<41}),TI=Qp,kE=TI&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_I=Wa,OI=Vt,xI=Kp,MI=kE,II=Object,qp=MI?function(t){return typeof t=="symbol"}:function(t){var e=_I("Symbol");return OI(e)&&xI(e.prototype,II(t))},HI=String,PI=function(t){try{return HI(t)}catch{return"Object"}},AI=Vt,NI=PI,DI=TypeError,Zp=function(t){if(AI(t))return t;throw new DI(NI(t)+" is not a function")},kI=Zp,LI=Gp,LE=function(t,e){var r=t[e];return LI(r)?void 0:kI(r)},rf=rl,nf=Vt,of=Yn,FI=TypeError,$I=function(t,e){var r,n;if(e==="string"&&nf(r=t.toString)&&!of(n=rf(r,t))||nf(r=t.valueOf)&&!of(n=rf(r,t))||e!=="string"&&nf(r=t.toString)&&!of(n=rf(r,t)))return n;throw new FI("Can't convert object to primitive value")},FE={exports:{}},jy=Qt,VI=Object.defineProperty,Jp=function(t,e){try{VI(jy,t,{value:e,configurable:!0,writable:!0})}catch{jy[t]=e}return e},WI=Qt,BI=Jp,Uy="__core-js_shared__",Yy=FE.exports=WI[Uy]||BI(Uy,{});(Yy.versions||(Yy.versions=[])).push({version:"3.37.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"});var ew=FE.exports,Gy=ew,$E=function(t,e){return Gy[t]||(Gy[t]=e||{})},zI=Wd,jI=Object,zd=function(t){return jI(zI(t))},UI=$t,YI=zd,GI=UI({}.hasOwnProperty),Gn=Object.hasOwn||function(e,r){return GI(YI(e),r)},KI=$t,XI=0,QI=Math.random(),qI=KI(1 .toString),VE=function(t){return"Symbol("+(t===void 0?"":t)+")_"+qI(++XI+QI,36)},ZI=Qt,JI=$E,Ky=Gn,eH=VE,tH=Qp,rH=kE,bs=ZI.Symbol,sf=JI("wks"),nH=rH?bs.for||bs:bs&&bs.withoutSetter||eH,nl=function(t){return Ky(sf,t)||(sf[t]=tH&&Ky(bs,t)?bs[t]:nH("Symbol."+t)),sf[t]},iH=rl,Xy=Yn,Qy=qp,oH=LE,sH=$I,lH=nl,aH=TypeError,uH=lH("toPrimitive"),cH=function(t,e){if(!Xy(t)||Qy(t))return t;var r=oH(t,uH),n;if(r){if(e===void 0&&(e="default"),n=iH(r,t,e),!Xy(n)||Qy(n))return n;throw new aH("Can't convert object to primitive value")}return e===void 0&&(e="number"),sH(t,e)},dH=cH,hH=qp,WE=function(t){var e=dH(t,"string");return hH(e)?e:e+""},fH=Qt,qy=Yn,ag=fH.document,mH=qy(ag)&&qy(ag.createElement),tw=function(t){return mH?ag.createElement(t):{}},gH=Un,pH=on,wH=tw,BE=!gH&&!pH(function(){return Object.defineProperty(wH("div"),"a",{get:function(){return 7}}).a!==7}),vH=Un,yH=rl,CH=ME,SH=Yp,RH=Bd,EH=WE,bH=Gn,TH=BE,Zy=Object.getOwnPropertyDescriptor;Up.f=vH?Zy:function(e,r){if(e=RH(e),r=EH(r),TH)try{return Zy(e,r)}catch{}if(bH(e,r))return SH(!yH(CH.f,e,r),e[r])};var Uo={},_H=Un,OH=on,zE=_H&&OH(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),xH=Yn,MH=String,IH=TypeError,Ba=function(t){if(xH(t))return t;throw new IH(MH(t)+" is not an object")},HH=Un,PH=BE,AH=zE,Ru=Ba,Jy=WE,NH=TypeError,lf=Object.defineProperty,DH=Object.getOwnPropertyDescriptor,af="enumerable",uf="configurable",cf="writable";Uo.f=HH?AH?function(e,r,n){if(Ru(e),r=Jy(r),Ru(n),typeof e=="function"&&r==="prototype"&&"value"in n&&cf in n&&!n[cf]){var i=DH(e,r);i&&i[cf]&&(e[r]=n.value,n={configurable:uf in n?n[uf]:i[uf],enumerable:af in n?n[af]:i[af],writable:!1})}return lf(e,r,n)}:lf:function(e,r,n){if(Ru(e),r=Jy(r),Ru(n),PH)try{return lf(e,r,n)}catch{}if("get"in n||"set"in n)throw new NH("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var kH=Un,LH=Uo,FH=Yp,za=kH?function(t,e,r){return LH.f(t,e,FH(1,r))}:function(t,e,r){return t[e]=r,t},jE={exports:{}},ug=Un,$H=Gn,UE=Function.prototype,VH=ug&&Object.getOwnPropertyDescriptor,rw=$H(UE,"name"),WH=rw&&(function(){}).name==="something",BH=rw&&(!ug||ug&&VH(UE,"name").configurable),zH={EXISTS:rw,PROPER:WH,CONFIGURABLE:BH},jH=$t,UH=Vt,cg=ew,YH=jH(Function.toString);UH(cg.inspectSource)||(cg.inspectSource=function(t){return YH(t)});var GH=cg.inspectSource,KH=Qt,XH=Vt,eC=KH.WeakMap,QH=XH(eC)&&/native code/.test(String(eC)),qH=$E,ZH=VE,tC=qH("keys"),YE=function(t){return tC[t]||(tC[t]=ZH(t))},nw={},JH=QH,GE=Qt,eP=Yn,tP=za,df=Gn,hf=ew,rP=YE,nP=nw,rC="Object already initialized",dg=GE.TypeError,iP=GE.WeakMap,id,Ta,od,oP=function(t){return od(t)?Ta(t):id(t,{})},sP=function(t){return function(e){var r;if(!eP(e)||(r=Ta(e)).type!==t)throw new dg("Incompatible receiver, "+t+" required");return r}};if(JH||hf.state){var Mn=hf.state||(hf.state=new iP);Mn.get=Mn.get,Mn.has=Mn.has,Mn.set=Mn.set,id=function(t,e){if(Mn.has(t))throw new dg(rC);return e.facade=t,Mn.set(t,e),e},Ta=function(t){return Mn.get(t)||{}},od=function(t){return Mn.has(t)}}else{var es=rP("state");nP[es]=!0,id=function(t,e){if(df(t,es))throw new dg(rC);return e.facade=t,tP(t,es,e),e},Ta=function(t){return df(t,es)?t[es]:{}},od=function(t){return df(t,es)}}var lP={set:id,get:Ta,has:od,enforce:oP,getterFor:sP},iw=$t,aP=on,uP=Vt,Eu=Gn,hg=Un,cP=zH.CONFIGURABLE,dP=GH,KE=lP,hP=KE.enforce,fP=KE.get,nC=String,yc=Object.defineProperty,mP=iw("".slice),gP=iw("".replace),pP=iw([].join),wP=hg&&!aP(function(){return yc(function(){},"length",{value:8}).length!==8}),vP=String(String).split("String"),yP=jE.exports=function(t,e,r){mP(nC(e),0,7)==="Symbol("&&(e="["+gP(nC(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!Eu(t,"name")||cP&&t.name!==e)&&(hg?yc(t,"name",{value:e,configurable:!0}):t.name=e),wP&&r&&Eu(r,"arity")&&t.length!==r.arity&&yc(t,"length",{value:r.arity});try{r&&Eu(r,"constructor")&&r.constructor?hg&&yc(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=hP(t);return Eu(n,"source")||(n.source=pP(vP,typeof e=="string"?e:"")),t};Function.prototype.toString=yP(function(){return uP(this)&&fP(this).source||dP(this)},"toString");var CP=jE.exports,SP=Vt,RP=Uo,EP=CP,bP=Jp,TP=function(t,e,r,n){n||(n={});var i=n.enumerable,o=n.name!==void 0?n.name:e;if(SP(r)&&EP(r,o,n),n.global)i?t[e]=r:bP(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:RP.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},XE={},_P=Math.ceil,OP=Math.floor,xP=Math.trunc||function(e){var r=+e;return(r>0?OP:_P)(r)},MP=xP,ow=function(t){var e=+t;return e!==e||e===0?0:MP(e)},IP=ow,HP=Math.max,PP=Math.min,AP=function(t,e){var r=IP(t);return r<0?HP(r+e,0):PP(r,e)},NP=ow,DP=Math.min,kP=function(t){var e=NP(t);return e>0?DP(e,9007199254740991):0},LP=kP,sw=function(t){return LP(t.length)},FP=Bd,$P=AP,VP=sw,iC=function(t){return function(e,r,n){var i=FP(e),o=VP(i);if(o===0)return!t&&-1;var s=$P(n,o),l;if(t&&r!==r){for(;o>s;)if(l=i[s++],l!==l)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===r)return t||s||0;return!t&&-1}},WP={includes:iC(!0),indexOf:iC(!1)},BP=$t,ff=Gn,zP=Bd,jP=WP.indexOf,UP=nw,oC=BP([].push),QE=function(t,e){var r=zP(t),n=0,i=[],o;for(o in r)!ff(UP,o)&&ff(r,o)&&oC(i,o);for(;e.length>n;)ff(r,o=e[n++])&&(~jP(i,o)||oC(i,o));return i},lw=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],YP=QE,GP=lw,KP=GP.concat("length","prototype");XE.f=Object.getOwnPropertyNames||function(e){return YP(e,KP)};var qE={};qE.f=Object.getOwnPropertySymbols;var XP=Wa,QP=$t,qP=XE,ZP=qE,JP=Ba,eA=QP([].concat),tA=XP("Reflect","ownKeys")||function(e){var r=qP.f(JP(e)),n=ZP.f;return n?eA(r,n(e)):r},sC=Gn,rA=tA,nA=Up,iA=Uo,ZE=function(t,e,r){for(var n=rA(e),i=iA.f,o=nA.f,s=0;s<n.length;s++){var l=n[s];!sC(t,l)&&!(r&&sC(r,l))&&i(t,l,o(e,l))}},oA=on,sA=Vt,lA=/#|\.prototype\./,ja=function(t,e){var r=uA[aA(t)];return r===dA?!0:r===cA?!1:sA(e)?oA(e):!!e},aA=ja.normalize=function(t){return String(t).replace(lA,".").toLowerCase()},uA=ja.data={},cA=ja.NATIVE="N",dA=ja.POLYFILL="P",hA=ja,bu=Qt,fA=Up.f,mA=za,gA=TP,pA=Jp,wA=ZE,vA=hA,Yo=function(t,e){var r=t.target,n=t.global,i=t.stat,o,s,l,a,u,d;if(n?s=bu:i?s=bu[r]||pA(r,{}):s=bu[r]&&bu[r].prototype,s)for(l in e){if(u=e[l],t.dontCallGetSet?(d=fA(s,l),a=d&&d.value):a=s[l],o=vA(n?l:r+(i?".":"#")+l,t.forced),!o&&a!==void 0){if(typeof u==typeof a)continue;wA(u,a)}(t.sham||a&&a.sham)&&mA(u,"sham",!0),gA(s,l,u,t)}},yA=Vd,JE=Function.prototype,lC=JE.apply,aC=JE.call,jd=typeof Reflect=="object"&&Reflect.apply||(yA?aC.bind(lC):function(){return aC.apply(lC,arguments)}),CA=$t,SA=Zp,RA=function(t,e,r){try{return CA(SA(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},EA=Yn,bA=function(t){return EA(t)||t===null},TA=bA,_A=String,OA=TypeError,xA=function(t){if(TA(t))return t;throw new OA("Can't set "+_A(t)+" as a prototype")},MA=RA,IA=Yn,HA=Wd,PA=xA,eb=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=MA(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,o){return HA(i),PA(o),IA(i)&&(t?r(i,o):i.__proto__=o),i}}():void 0),AA=Uo.f,NA=function(t,e,r){r in t||AA(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},DA=Vt,kA=Yn,uC=eb,LA=function(t,e,r){var n,i;return uC&&DA(n=e.constructor)&&n!==r&&kA(i=n.prototype)&&i!==r.prototype&&uC(t,i),t},FA=nl,$A=FA("toStringTag"),tb={};tb[$A]="z";var VA=String(tb)==="[object z]",WA=VA,BA=Vt,Cc=jo,zA=nl,jA=zA("toStringTag"),UA=Object,YA=Cc(function(){return arguments}())==="Arguments",GA=function(t,e){try{return t[e]}catch{}},KA=WA?Cc:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=GA(e=UA(t),jA))=="string"?r:YA?Cc(e):(n=Cc(e))==="Object"&&BA(e.callee)?"Arguments":n},XA=KA,QA=String,aw=function(t){if(XA(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return QA(t)},qA=aw,ZA=function(t,e){return t===void 0?arguments.length<2?"":e:qA(t)},JA=Yn,eN=za,tN=function(t,e){JA(e)&&"cause"in e&&eN(t,"cause",e.cause)},rN=$t,rb=Error,nN=rN("".replace),iN=function(t){return String(new rb(t).stack)}("zxcasd"),nb=/\n\s*at [^:]*:[^\n]*/,oN=nb.test(iN),sN=function(t,e){if(oN&&typeof t=="string"&&!rb.prepareStackTrace)for(;e--;)t=nN(t,nb,"");return t},lN=on,aN=Yp,uN=!lN(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",aN(1,7)),t.stack!==7):!0}),cN=za,dN=sN,hN=uN,cC=Error.captureStackTrace,fN=function(t,e,r,n){hN&&(cC?cC(t,e):cN(t,"stack",dN(r,n)))},dC=Wa,mN=Gn,hC=za,gN=Kp,fC=eb,mC=ZE,gC=NA,pN=LA,wN=ZA,vN=tN,yN=fN,CN=Un,SN=function(t,e,r,n){var i="stackTraceLimit",o=n?2:1,s=t.split("."),l=s[s.length-1],a=dC.apply(null,s);if(a){var u=a.prototype;if(mN(u,"cause")&&delete u.cause,!r)return a;var d=dC("Error"),f=e(function(m,p){var C=wN(n?p:m,void 0),S=n?new a(m):new a;return C!==void 0&&hC(S,"message",C),yN(S,f,S.stack,2),this&&gN(u,this)&&pN(S,this,f),arguments.length>o&&vN(S,arguments[o]),S});f.prototype=u,l!=="Error"?fC?fC(f,d):mC(f,d,{name:!0}):CN&&i in a&&(gC(f,a,i),gC(f,a,"prepareStackTrace")),mC(f,a);try{u.name!==l&&hC(u,"name",l),u.constructor=f}catch{}return f}},ib=Yo,RN=Qt,Kn=jd,ob=SN,fg="WebAssembly",pC=RN[fg],sd=new Error("e",{cause:7}).cause!==7,Go=function(t,e){var r={};r[t]=ob(t,e,sd),ib({global:!0,constructor:!0,arity:1,forced:sd},r)},uw=function(t,e){if(pC&&pC[t]){var r={};r[t]=ob(fg+"."+t,e,sd),ib({target:fg,stat:!0,constructor:!0,arity:1,forced:sd},r)}};Go("Error",function(t){return function(r){return Kn(t,this,arguments)}});Go("EvalError",function(t){return function(r){return Kn(t,this,arguments)}});Go("RangeError",function(t){return function(r){return Kn(t,this,arguments)}});Go("ReferenceError",function(t){return function(r){return Kn(t,this,arguments)}});Go("SyntaxError",function(t){return function(r){return Kn(t,this,arguments)}});Go("TypeError",function(t){return function(r){return Kn(t,this,arguments)}});Go("URIError",function(t){return function(r){return Kn(t,this,arguments)}});uw("CompileError",function(t){return function(r){return Kn(t,this,arguments)}});uw("LinkError",function(t){return function(r){return Kn(t,this,arguments)}});uw("RuntimeError",function(t){return function(r){return Kn(t,this,arguments)}});var EN=jo,sb=Array.isArray||function(e){return EN(e)==="Array"},bN=Un,TN=sb,_N=TypeError,ON=Object.getOwnPropertyDescriptor,xN=bN&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),MN=xN?function(t,e){if(TN(t)&&!ON(t,"length").writable)throw new _N("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},IN=TypeError,HN=9007199254740991,PN=function(t){if(t>HN)throw IN("Maximum allowed index exceeded");return t},AN=Yo,NN=zd,DN=sw,kN=MN,LN=PN,FN=on,$N=FN(function(){return[].push.call({length:4294967296},1)!==4294967297}),VN=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},WN=$N||!VN();AN({target:"Array",proto:!0,arity:1,forced:WN},{push:function(e){var r=NN(this),n=DN(r),i=arguments.length;LN(n+i);for(var o=0;o<i;o++)r[n]=arguments[o],n++;return kN(r,n),n}});var BN=jo,zN=$t,jN=function(t){if(BN(t)==="Function")return zN(t)},wC=jN,UN=Zp,YN=Vd,GN=wC(wC.bind),KN=function(t,e){return UN(t),e===void 0?t:YN?GN(t,e):function(){return t.apply(e,arguments)}},XN=Wa,lb=XN("document","documentElement"),QN=$t,cw=QN([].slice),qN=TypeError,ab=function(t,e){if(t<e)throw new qN("Not enough arguments");return t},ZN=Xp,JN=/(?:ipad|iphone|ipod).*applewebkit/i.test(ZN),eD=Qt,tD=jo,rD=tD(eD.process)==="process",Hr=Qt,nD=jd,iD=KN,vC=Vt,oD=Gn,ub=on,yC=lb,sD=cw,CC=tw,lD=ab,aD=JN,uD=rD,mg=Hr.setImmediate,gg=Hr.clearImmediate,cD=Hr.process,mf=Hr.Dispatch,dD=Hr.Function,SC=Hr.MessageChannel,hD=Hr.String,gf=0,ra={},RC="onreadystatechange",_a,uo,pf,wf;ub(function(){_a=Hr.location});var dw=function(t){if(oD(ra,t)){var e=ra[t];delete ra[t],e()}},vf=function(t){return function(){dw(t)}},EC=function(t){dw(t.data)},bC=function(t){Hr.postMessage(hD(t),_a.protocol+"//"+_a.host)};(!mg||!gg)&&(mg=function(e){lD(arguments.length,1);var r=vC(e)?e:dD(e),n=sD(arguments,1);return ra[++gf]=function(){nD(r,void 0,n)},uo(gf),gf},gg=function(e){delete ra[e]},uD?uo=function(t){cD.nextTick(vf(t))}:mf&&mf.now?uo=function(t){mf.now(vf(t))}:SC&&!aD?(pf=new SC,wf=pf.port2,pf.port1.onmessage=EC,uo=iD(wf.postMessage,wf)):Hr.addEventListener&&vC(Hr.postMessage)&&!Hr.importScripts&&_a&&_a.protocol!=="file:"&&!ub(bC)?(uo=bC,Hr.addEventListener("message",EC,!1)):RC in CC("script")?uo=function(t){yC.appendChild(CC("script"))[RC]=function(){yC.removeChild(this),dw(t)}}:uo=function(t){setTimeout(vf(t),0)});var cb={set:mg,clear:gg},fD=Yo,mD=Qt,TC=cb.clear;fD({global:!0,bind:!0,enumerable:!0,forced:mD.clearImmediate!==TC},{clearImmediate:TC});var gD=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",db=Qt,pD=jd,wD=Vt,vD=gD,yD=Xp,CD=cw,SD=ab,RD=db.Function,ED=/MSIE .\./.test(yD)||vD&&function(){var t=db.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),bD=function(t,e){var r=e?2:1;return ED?function(n,i){var o=SD(arguments.length,1)>r,s=wD(n)?n:RD(n),l=o?CD(arguments,r):[],a=o?function(){pD(s,this,l)}:s;return e?t(a,i):t(a)}:t},TD=Yo,hb=Qt,_C=cb.set,_D=bD,OC=hb.setImmediate?_D(_C,!1):_C;TD({global:!0,bind:!0,enumerable:!0,forced:hb.setImmediate!==OC},{setImmediate:OC});/*! @license DOMPurify 2.5.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.3/LICENSE */function ki(t){"@babel/helpers - typeof";return ki=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ki(t)}function pg(t,e){return pg=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},pg(t,e)}function OD(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sc(t,e,r){return OD()?Sc=Reflect.construct:Sc=function(i,o,s){var l=[null];l.push.apply(l,o);var a=Function.bind.apply(i,l),u=new a;return s&&pg(u,s.prototype),u},Sc.apply(null,arguments)}function gn(t){return xD(t)||MD(t)||ID(t)||HD()}function xD(t){if(Array.isArray(t))return wg(t)}function MD(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ID(t,e){if(t){if(typeof t=="string")return wg(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wg(t,e)}}function wg(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function HD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var PD=Object.hasOwnProperty,xC=Object.setPrototypeOf,AD=Object.isFrozen,ND=Object.getPrototypeOf,DD=Object.getOwnPropertyDescriptor,ir=Object.freeze,nn=Object.seal,kD=Object.create,fb=typeof Reflect<"u"&&Reflect,ld=fb.apply,vg=fb.construct;ld||(ld=function(e,r,n){return e.apply(r,n)});ir||(ir=function(e){return e});nn||(nn=function(e){return e});vg||(vg=function(e,r){return Sc(e,gn(r))});var LD=Dr(Array.prototype.forEach),MC=Dr(Array.prototype.pop),vl=Dr(Array.prototype.push),Rc=Dr(String.prototype.toLowerCase),yf=Dr(String.prototype.toString),IC=Dr(String.prototype.match),un=Dr(String.prototype.replace),FD=Dr(String.prototype.indexOf),$D=Dr(String.prototype.trim),Dt=Dr(RegExp.prototype.test),Cf=VD(TypeError),HC=Dr(Number.isNaN);function Dr(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return ld(t,e,n)}}function VD(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return vg(t,r)}}function we(t,e,r){var n;r=(n=r)!==null&&n!==void 0?n:Rc,xC&&xC(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=r(o);s!==o&&(AD(e)||(e[i]=s),o=s)}t[o]=!0}return t}function co(t){var e=kD(null),r;for(r in t)ld(PD,t,[r])===!0&&(e[r]=t[r]);return e}function Tu(t,e){for(;t!==null;){var r=DD(t,e);if(r){if(r.get)return Dr(r.get);if(typeof r.value=="function")return Dr(r.value)}t=ND(t)}function n(i){return console.warn("fallback value for",i),null}return n}var PC=ir(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Sf=ir(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Rf=ir(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),WD=ir(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ef=ir(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),BD=ir(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),AC=ir(["#text"]),NC=ir(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),bf=ir(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),DC=ir(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),_u=ir(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),zD=nn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),jD=nn(/<%[\w\W]*|[\w\W]*%>/gm),UD=nn(/\${[\w\W]*}/gm),YD=nn(/^data-[\-\w.\u00B7-\uFFFF]/),GD=nn(/^aria-[\-\w]+$/),KD=nn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),XD=nn(/^(?:\w+script|data):/i),QD=nn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),qD=nn(/^html$/i),ZD=nn(/^[a-z][.\w]*(-[.\w]+)+$/i),JD=function(){return typeof window>"u"?null:window},ek=function(e,r){if(ki(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function mb(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:JD(),e=function(T){return mb(T)};if(e.version="2.5.3",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,l=t.Element,a=t.NodeFilter,u=t.NamedNodeMap,d=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,f=t.HTMLFormElement,m=t.DOMParser,p=t.trustedTypes,C=l.prototype,S=Tu(C,"cloneNode"),H=Tu(C,"nextSibling"),w=Tu(C,"childNodes"),v=Tu(C,"parentNode");if(typeof o=="function"){var E=n.createElement("template");E.content&&E.content.ownerDocument&&(n=E.content.ownerDocument)}var x=ek(p,r),$=x?x.createHTML(""):"",k=n,P=k.implementation,y=k.createNodeIterator,b=k.createDocumentFragment,M=k.getElementsByTagName,U=r.importNode,Y={};try{Y=co(n).documentMode?n.documentMode:{}}catch{}var B={};e.isSupported=typeof v=="function"&&P&&P.createHTMLDocument!==void 0&&Y!==9;var Q=zD,me=jD,se=UD,G=YD,N=GD,A=XD,J=QD,c=ZD,h=KD,g=null,_=we({},[].concat(gn(PC),gn(Sf),gn(Rf),gn(Ef),gn(AC))),R=null,O=we({},[].concat(gn(NC),gn(bf),gn(DC),gn(_u))),I=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),L=null,D=null,W=!0,F=!0,ee=!1,ne=!0,re=!1,ue=!0,le=!1,Ae=!1,ye=!1,he=!1,Oe=!1,Ce=!1,ce=!0,Re=!1,$e="user-content-",Te=!0,at=!1,Ve={},gt=null,lr=we({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ar=null,Jt=we({},["audio","video","img","source","image","track"]),We=null,Vr=we({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xe="http://www.w3.org/1998/Math/MathML",Or="http://www.w3.org/2000/svg",Qe="http://www.w3.org/1999/xhtml",At=Qe,Qo=!1,qo=null,RO=we({},[Xe,Or,Qe],yf),lo,EO=["application/xhtml+xml","text/html"],bO="text/html",bt,Zo=null,vv=255,TO=n.createElement("form"),yv=function(T){return T instanceof RegExp||T instanceof Function},bh=function(T){Zo&&Zo===T||((!T||ki(T)!=="object")&&(T={}),T=co(T),lo=EO.indexOf(T.PARSER_MEDIA_TYPE)===-1?lo=bO:lo=T.PARSER_MEDIA_TYPE,bt=lo==="application/xhtml+xml"?yf:Rc,g="ALLOWED_TAGS"in T?we({},T.ALLOWED_TAGS,bt):_,R="ALLOWED_ATTR"in T?we({},T.ALLOWED_ATTR,bt):O,qo="ALLOWED_NAMESPACES"in T?we({},T.ALLOWED_NAMESPACES,yf):RO,We="ADD_URI_SAFE_ATTR"in T?we(co(Vr),T.ADD_URI_SAFE_ATTR,bt):Vr,ar="ADD_DATA_URI_TAGS"in T?we(co(Jt),T.ADD_DATA_URI_TAGS,bt):Jt,gt="FORBID_CONTENTS"in T?we({},T.FORBID_CONTENTS,bt):lr,L="FORBID_TAGS"in T?we({},T.FORBID_TAGS,bt):{},D="FORBID_ATTR"in T?we({},T.FORBID_ATTR,bt):{},Ve="USE_PROFILES"in T?T.USE_PROFILES:!1,W=T.ALLOW_ARIA_ATTR!==!1,F=T.ALLOW_DATA_ATTR!==!1,ee=T.ALLOW_UNKNOWN_PROTOCOLS||!1,ne=T.ALLOW_SELF_CLOSE_IN_ATTR!==!1,re=T.SAFE_FOR_TEMPLATES||!1,ue=T.SAFE_FOR_XML!==!1,le=T.WHOLE_DOCUMENT||!1,he=T.RETURN_DOM||!1,Oe=T.RETURN_DOM_FRAGMENT||!1,Ce=T.RETURN_TRUSTED_TYPE||!1,ye=T.FORCE_BODY||!1,ce=T.SANITIZE_DOM!==!1,Re=T.SANITIZE_NAMED_PROPS||!1,Te=T.KEEP_CONTENT!==!1,at=T.IN_PLACE||!1,h=T.ALLOWED_URI_REGEXP||h,At=T.NAMESPACE||Qe,I=T.CUSTOM_ELEMENT_HANDLING||{},T.CUSTOM_ELEMENT_HANDLING&&yv(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(I.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&yv(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(I.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(I.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),re&&(F=!1),Oe&&(he=!0),Ve&&(g=we({},gn(AC)),R=[],Ve.html===!0&&(we(g,PC),we(R,NC)),Ve.svg===!0&&(we(g,Sf),we(R,bf),we(R,_u)),Ve.svgFilters===!0&&(we(g,Rf),we(R,bf),we(R,_u)),Ve.mathMl===!0&&(we(g,Ef),we(R,DC),we(R,_u))),T.ADD_TAGS&&(g===_&&(g=co(g)),we(g,T.ADD_TAGS,bt)),T.ADD_ATTR&&(R===O&&(R=co(R)),we(R,T.ADD_ATTR,bt)),T.ADD_URI_SAFE_ATTR&&we(We,T.ADD_URI_SAFE_ATTR,bt),T.FORBID_CONTENTS&&(gt===lr&&(gt=co(gt)),we(gt,T.FORBID_CONTENTS,bt)),Te&&(g["#text"]=!0),le&&we(g,["html","head","body"]),g.table&&(we(g,["tbody"]),delete L.tbody),ir&&ir(T),Zo=T)},Cv=we({},["mi","mo","mn","ms","mtext"]),Sv=we({},["foreignobject","annotation-xml"]),_O=we({},["title","style","font","a","script"]),ru=we({},Sf);we(ru,Rf),we(ru,WD);var Th=we({},Ef);we(Th,BD);var OO=function(T){var V=v(T);(!V||!V.tagName)&&(V={namespaceURI:At,tagName:"template"});var K=Rc(T.tagName),de=Rc(V.tagName);return qo[T.namespaceURI]?T.namespaceURI===Or?V.namespaceURI===Qe?K==="svg":V.namespaceURI===Xe?K==="svg"&&(de==="annotation-xml"||Cv[de]):!!ru[K]:T.namespaceURI===Xe?V.namespaceURI===Qe?K==="math":V.namespaceURI===Or?K==="math"&&Sv[de]:!!Th[K]:T.namespaceURI===Qe?V.namespaceURI===Or&&!Sv[de]||V.namespaceURI===Xe&&!Cv[de]?!1:!Th[K]&&(_O[K]||!ru[K]):!!(lo==="application/xhtml+xml"&&qo[T.namespaceURI]):!1},ur=function(T){vl(e.removed,{element:T});try{T.parentNode.removeChild(T)}catch{try{T.outerHTML=$}catch{T.remove()}}},nu=function(T,V){try{vl(e.removed,{attribute:V.getAttributeNode(T),from:V})}catch{vl(e.removed,{attribute:null,from:V})}if(V.removeAttribute(T),T==="is"&&!R[T])if(he||Oe)try{ur(V)}catch{}else try{V.setAttribute(T,"")}catch{}},Rv=function(T){var V,K;if(ye)T="<remove></remove>"+T;else{var de=IC(T,/^[\r\n\t ]+/);K=de&&de[0]}lo==="application/xhtml+xml"&&At===Qe&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");var cr=x?x.createHTML(T):T;if(At===Qe)try{V=new m().parseFromString(cr,lo)}catch{}if(!V||!V.documentElement){V=P.createDocument(At,"template",null);try{V.documentElement.innerHTML=Qo?$:cr}catch{}}var Wt=V.body||V.documentElement;return T&&K&&Wt.insertBefore(n.createTextNode(K),Wt.childNodes[0]||null),At===Qe?M.call(V,le?"html":"body")[0]:le?V.documentElement:Wt},Ev=function(T){return y.call(T.ownerDocument||T,T,a.SHOW_ELEMENT|a.SHOW_COMMENT|a.SHOW_TEXT|a.SHOW_PROCESSING_INSTRUCTION|a.SHOW_CDATA_SECTION,null,!1)},bv=function(T){return T instanceof f&&(typeof T.__depth<"u"&&typeof T.__depth!="number"||typeof T.__removalCount<"u"&&typeof T.__removalCount!="number"||typeof T.nodeName!="string"||typeof T.textContent!="string"||typeof T.removeChild!="function"||!(T.attributes instanceof d)||typeof T.removeAttribute!="function"||typeof T.setAttribute!="function"||typeof T.namespaceURI!="string"||typeof T.insertBefore!="function"||typeof T.hasChildNodes!="function")},al=function(T){return ki(s)==="object"?T instanceof s:T&&ki(T)==="object"&&typeof T.nodeType=="number"&&typeof T.nodeName=="string"},qn=function(T,V,K){B[T]&&LD(B[T],function(de){de.call(e,V,K,Zo)})},Tv=function(T){var V;if(qn("beforeSanitizeElements",T,null),bv(T)||Dt(/[\u0080-\uFFFF]/,T.nodeName))return ur(T),!0;var K=bt(T.nodeName);if(qn("uponSanitizeElement",T,{tagName:K,allowedTags:g}),T.hasChildNodes()&&!al(T.firstElementChild)&&(!al(T.content)||!al(T.content.firstElementChild))&&Dt(/<[/\w]/g,T.innerHTML)&&Dt(/<[/\w]/g,T.textContent)||K==="select"&&Dt(/<template/i,T.innerHTML)||T.nodeType===7||ue&&T.nodeType===8&&Dt(/<[/\w]/g,T.data))return ur(T),!0;if(!g[K]||L[K]){if(!L[K]&&Ov(K)&&(I.tagNameCheck instanceof RegExp&&Dt(I.tagNameCheck,K)||I.tagNameCheck instanceof Function&&I.tagNameCheck(K)))return!1;if(Te&&!gt[K]){var de=v(T)||T.parentNode,cr=w(T)||T.childNodes;if(cr&&de)for(var Wt=cr.length,Nt=Wt-1;Nt>=0;--Nt){var ao=S(cr[Nt],!0);ao.__removalCount=(T.__removalCount||0)+1,de.insertBefore(ao,H(T))}}return ur(T),!0}return T instanceof l&&!OO(T)||(K==="noscript"||K==="noembed"||K==="noframes")&&Dt(/<\/no(script|embed|frames)/i,T.innerHTML)?(ur(T),!0):(re&&T.nodeType===3&&(V=T.textContent,V=un(V,Q," "),V=un(V,me," "),V=un(V,se," "),T.textContent!==V&&(vl(e.removed,{element:T.cloneNode()}),T.textContent=V)),qn("afterSanitizeElements",T,null),!1)},_v=function(T,V,K){if(ce&&(V==="id"||V==="name")&&(K in n||K in TO||K==="__depth"||K==="__removalCount"))return!1;if(!(F&&!D[V]&&Dt(G,V))){if(!(W&&Dt(N,V))){if(!R[V]||D[V]){if(!(Ov(T)&&(I.tagNameCheck instanceof RegExp&&Dt(I.tagNameCheck,T)||I.tagNameCheck instanceof Function&&I.tagNameCheck(T))&&(I.attributeNameCheck instanceof RegExp&&Dt(I.attributeNameCheck,V)||I.attributeNameCheck instanceof Function&&I.attributeNameCheck(V))||V==="is"&&I.allowCustomizedBuiltInElements&&(I.tagNameCheck instanceof RegExp&&Dt(I.tagNameCheck,K)||I.tagNameCheck instanceof Function&&I.tagNameCheck(K))))return!1}else if(!We[V]){if(!Dt(h,un(K,J,""))){if(!((V==="src"||V==="xlink:href"||V==="href")&&T!=="script"&&FD(K,"data:")===0&&ar[T])){if(!(ee&&!Dt(A,un(K,J,"")))){if(K)return!1}}}}}}return!0},Ov=function(T){return T!=="annotation-xml"&&IC(T,c)},xv=function(T){var V,K,de,cr;qn("beforeSanitizeAttributes",T,null);var Wt=T.attributes;if(Wt){var Nt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};for(cr=Wt.length;cr--;){V=Wt[cr];var ao=V,Wr=ao.name,dr=ao.namespaceURI;if(K=Wr==="value"?V.value:$D(V.value),de=bt(Wr),Nt.attrName=de,Nt.attrValue=K,Nt.keepAttr=!0,Nt.forceKeepAttr=void 0,qn("uponSanitizeAttribute",T,Nt),K=Nt.attrValue,!Nt.forceKeepAttr&&(nu(Wr,T),!!Nt.keepAttr)){if(!ne&&Dt(/\/>/i,K)){nu(Wr,T);continue}if(ue&&Dt(/((--!?|])>)|<\/(style|title)/i,K)){nu(Wr,T);continue}re&&(K=un(K,Q," "),K=un(K,me," "),K=un(K,se," "));var Mv=bt(T.nodeName);if(_v(Mv,de,K)){if(Re&&(de==="id"||de==="name")&&(nu(Wr,T),K=$e+K),x&&ki(p)==="object"&&typeof p.getAttributeType=="function"&&!dr)switch(p.getAttributeType(Mv,de)){case"TrustedHTML":{K=x.createHTML(K);break}case"TrustedScriptURL":{K=x.createScriptURL(K);break}}try{dr?T.setAttributeNS(dr,Wr,K):T.setAttribute(Wr,K),bv(T)?ur(T):MC(e.removed)}catch{}}}}qn("afterSanitizeAttributes",T,null)}},xO=function ie(T){var V,K=Ev(T);for(qn("beforeSanitizeShadowDOM",T,null);V=K.nextNode();)if(qn("uponSanitizeShadowNode",V,null),!Tv(V)){var de=v(V);V.nodeType===1&&(de&&de.__depth?V.__depth=(V.__removalCount||0)+de.__depth+1:V.__depth=1),(V.__depth>=vv||HC(V.__depth))&&ur(V),V.content instanceof i&&(V.content.__depth=V.__depth,ie(V.content)),xv(V)}qn("afterSanitizeShadowDOM",T,null)};return e.sanitize=function(ie){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},V,K,de,cr,Wt;if(Qo=!ie,Qo&&(ie="<!-->"),typeof ie!="string"&&!al(ie))if(typeof ie.toString=="function"){if(ie=ie.toString(),typeof ie!="string")throw Cf("dirty is not a string, aborting")}else throw Cf("toString is not a function");if(!e.isSupported){if(ki(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof ie=="string")return t.toStaticHTML(ie);if(al(ie))return t.toStaticHTML(ie.outerHTML)}return ie}if(Ae||bh(T),e.removed=[],typeof ie=="string"&&(at=!1),at){if(ie.nodeName){var Nt=bt(ie.nodeName);if(!g[Nt]||L[Nt])throw Cf("root node is forbidden and cannot be sanitized in-place")}}else if(ie instanceof s)V=Rv("<!---->"),K=V.ownerDocument.importNode(ie,!0),K.nodeType===1&&K.nodeName==="BODY"||K.nodeName==="HTML"?V=K:V.appendChild(K);else{if(!he&&!re&&!le&&ie.indexOf("<")===-1)return x&&Ce?x.createHTML(ie):ie;if(V=Rv(ie),!V)return he?null:Ce?$:""}V&&ye&&ur(V.firstChild);for(var ao=Ev(at?ie:V);de=ao.nextNode();)if(!(de.nodeType===3&&de===cr)&&!Tv(de)){var Wr=v(de);de.nodeType===1&&(Wr&&Wr.__depth?de.__depth=(de.__removalCount||0)+Wr.__depth+1:de.__depth=1),(de.__depth>=vv||HC(de.__depth))&&ur(de),de.content instanceof i&&(de.content.__depth=de.__depth,xO(de.content)),xv(de),cr=de}if(cr=null,at)return ie;if(he){if(Oe)for(Wt=b.call(V.ownerDocument);V.firstChild;)Wt.appendChild(V.firstChild);else Wt=V;return(R.shadowroot||R.shadowrootmod)&&(Wt=U.call(r,Wt,!0)),Wt}var dr=le?V.outerHTML:V.innerHTML;return le&&g["!doctype"]&&V.ownerDocument&&V.ownerDocument.doctype&&V.ownerDocument.doctype.name&&Dt(qD,V.ownerDocument.doctype.name)&&(dr="<!DOCTYPE "+V.ownerDocument.doctype.name+`>
`+dr),re&&(dr=un(dr,Q," "),dr=un(dr,me," "),dr=un(dr,se," ")),x&&Ce?x.createHTML(dr):dr},e.setConfig=function(ie){bh(ie),Ae=!0},e.clearConfig=function(){Zo=null,Ae=!1},e.isValidAttribute=function(ie,T,V){Zo||bh({});var K=bt(ie),de=bt(T);return _v(K,de,V)},e.addHook=function(ie,T){typeof T=="function"&&(B[ie]=B[ie]||[],vl(B[ie],T))},e.removeHook=function(ie){if(B[ie])return MC(B[ie])},e.removeHooks=function(ie){B[ie]&&(B[ie]=[])},e.removeAllHooks=function(){B={}},e}var tk=mb();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var gb;function X(){return gb.apply(null,arguments)}function rk(t){gb=t}function Tn(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ho(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hw(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(He(t,e))return!1;return!0}function pr(t){return t===void 0}function yi(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Ua(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function pb(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function $i(t,e){for(var r in e)He(e,r)&&(t[r]=e[r]);return He(e,"toString")&&(t.toString=e.toString),He(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Xn(t,e,r,n){return Vb(t,e,r,n,!0).utc()}function nk(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function pe(t){return t._pf==null&&(t._pf=nk()),t._pf}var yg;Array.prototype.some?yg=Array.prototype.some:yg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function fw(t){if(t._isValid==null){var e=pe(t),r=yg.call(e.parsedDateParts,function(i){return i!=null}),n=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n}return t._isValid}function Ud(t){var e=Xn(NaN);return t!=null?$i(pe(e),t):pe(e).userInvalidated=!0,e}var kC=X.momentProperties=[],Tf=!1;function mw(t,e){var r,n,i,o=kC.length;if(pr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),pr(e._i)||(t._i=e._i),pr(e._f)||(t._f=e._f),pr(e._l)||(t._l=e._l),pr(e._strict)||(t._strict=e._strict),pr(e._tzm)||(t._tzm=e._tzm),pr(e._isUTC)||(t._isUTC=e._isUTC),pr(e._offset)||(t._offset=e._offset),pr(e._pf)||(t._pf=pe(e)),pr(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=kC[r],i=e[n],pr(i)||(t[n]=i);return t}function Ya(t){mw(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Tf===!1&&(Tf=!0,X.updateOffset(this),Tf=!1)}function _n(t){return t instanceof Ya||t!=null&&t._isAMomentObject!=null}function wb(t){X.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function sn(t,e){var r=!0;return $i(function(){if(X.deprecationHandler!=null&&X.deprecationHandler(null,t),r){var n=[],i,o,s,l=arguments.length;for(o=0;o<l;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])He(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}wb(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var LC={};function vb(t,e){X.deprecationHandler!=null&&X.deprecationHandler(t,e),LC[t]||(wb(e),LC[t]=!0)}X.suppressDeprecationWarnings=!1;X.deprecationHandler=null;function Qn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function ik(t){var e,r;for(r in t)He(t,r)&&(e=t[r],Qn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Cg(t,e){var r=$i({},t),n;for(n in e)He(e,n)&&(Ho(t[n])&&Ho(e[n])?(r[n]={},$i(r[n],t[n]),$i(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)He(t,n)&&!He(e,n)&&Ho(t[n])&&(r[n]=$i({},r[n]));return r}function gw(t){t!=null&&this.set(t)}var Sg;Object.keys?Sg=Object.keys:Sg=function(t){var e,r=[];for(e in t)He(t,e)&&r.push(e);return r};var ok={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function sk(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Qn(n)?n.call(e,r):n}function Bn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var pw=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ou=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,_f={},Ds={};function oe(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Ds[t]=i),e&&(Ds[e[0]]=function(){return Bn(i.apply(this,arguments),e[1],e[2])}),r&&(Ds[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function lk(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function ak(t){var e=t.match(pw),r,n;for(r=0,n=e.length;r<n;r++)Ds[e[r]]?e[r]=Ds[e[r]]:e[r]=lk(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Qn(e[s])?e[s].call(i,t):e[s];return o}}function Ec(t,e){return t.isValid()?(e=yb(e,t.localeData()),_f[e]=_f[e]||ak(e),_f[e](t)):t.localeData().invalidDate()}function yb(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Ou.lastIndex=0;r>=0&&Ou.test(t);)t=t.replace(Ou,n),Ou.lastIndex=0,r-=1;return t}var uk={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ck(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(pw).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var dk="Invalid date";function hk(){return this._invalidDate}var fk="%d",mk=/\d{1,2}/;function gk(t){return this._ordinal.replace("%d",t)}var pk={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function wk(t,e,r,n){var i=this._relativeTime[r];return Qn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function vk(t,e){var r=this._relativeTime[t>0?"future":"past"];return Qn(r)?r(e):r.replace(/%s/i,e)}var na={};function qt(t,e){var r=t.toLowerCase();na[r]=na[r+"s"]=na[e]=t}function ln(t){return typeof t=="string"?na[t]||na[t.toLowerCase()]:void 0}function ww(t){var e={},r,n;for(n in t)He(t,n)&&(r=ln(n),r&&(e[r]=t[n]));return e}var Cb={};function Zt(t,e){Cb[t]=e}function yk(t){var e=[],r;for(r in t)He(t,r)&&e.push({unit:r,priority:Cb[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}function Yd(t){return t%4===0&&t%100!==0||t%400===0}function Xr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function be(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Xr(e)),r}function il(t,e){return function(r){return r!=null?(Sb(this,t,r),X.updateOffset(this,e),this):ad(this,t)}}function ad(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function Sb(t,e,r){t.isValid()&&!isNaN(r)&&(e==="FullYear"&&Yd(t.year())&&t.month()===1&&t.date()===29?(r=be(r),t._d["set"+(t._isUTC?"UTC":"")+e](r,t.month(),Zd(r,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](r))}function Ck(t){return t=ln(t),Qn(this[t])?this[t]():this}function Sk(t,e){if(typeof t=="object"){t=ww(t);var r=yk(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=ln(t),Qn(this[t]))return this[t](e);return this}var Rb=/\d/,Fr=/\d\d/,Eb=/\d{3}/,vw=/\d{4}/,Gd=/[+-]?\d{6}/,Ke=/\d\d?/,bb=/\d\d\d\d?/,Tb=/\d\d\d\d\d\d?/,Kd=/\d{1,3}/,yw=/\d{1,4}/,Xd=/[+-]?\d{1,6}/,ol=/\d+/,Qd=/[+-]?\d+/,Rk=/Z|[+-]\d\d:?\d\d/gi,qd=/Z|[+-]\d\d(?::?\d\d)?/gi,Ek=/[+-]?\d+(\.\d{1,3})?/,Ga=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ud;ud={};function q(t,e,r){ud[t]=Qn(e)?e:function(n,i){return n&&r?r:e}}function bk(t,e){return He(ud,t)?ud[t](e._strict,e._locale):new RegExp(Tk(t))}function Tk(t){return Mr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function Mr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Rg={};function Le(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),yi(e)&&(n=function(o,s){s[e]=be(o)}),i=t.length,r=0;r<i;r++)Rg[t[r]]=n}function Ka(t,e){Le(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function _k(t,e,r){e!=null&&He(Rg,t)&&Rg[t](e,r._a,r,t)}var Kt=0,ci=1,Fn=2,Et=3,Cn=4,di=5,xo=6,Ok=7,xk=8;function Mk(t,e){return(t%e+e)%e}var ht;Array.prototype.indexOf?ht=Array.prototype.indexOf:ht=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Zd(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=Mk(e,12);return t+=(e-r)/12,r===1?Yd(t)?29:28:31-r%7%2}oe("M",["MM",2],"Mo",function(){return this.month()+1});oe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});oe("MMMM",0,0,function(t){return this.localeData().months(this,t)});qt("month","M");Zt("month",8);q("M",Ke);q("MM",Ke,Fr);q("MMM",function(t,e){return e.monthsShortRegex(t)});q("MMMM",function(t,e){return e.monthsRegex(t)});Le(["M","MM"],function(t,e){e[ci]=be(t)-1});Le(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[ci]=i:pe(r).invalidMonth=t});var Ik="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),_b="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ob=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Hk=Ga,Pk=Ga;function Ak(t,e){return t?Tn(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Ob).test(e)?"format":"standalone"][t.month()]:Tn(this._months)?this._months:this._months.standalone}function Nk(t,e){return t?Tn(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Ob.test(e)?"format":"standalone"][t.month()]:Tn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Dk(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Xn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=ht.call(this._shortMonthsParse,s),i!==-1?i:null):(i=ht.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=ht.call(this._shortMonthsParse,s),i!==-1?i:(i=ht.call(this._longMonthsParse,s),i!==-1?i:null)):(i=ht.call(this._longMonthsParse,s),i!==-1?i:(i=ht.call(this._shortMonthsParse,s),i!==-1?i:null))}function kk(t,e,r){var n,i,o;if(this._monthsParseExact)return Dk.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Xn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function xb(t,e){var r;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=be(e);else if(e=t.localeData().monthsParse(e),!yi(e))return t}return r=Math.min(t.date(),Zd(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,r),t}function Mb(t){return t!=null?(xb(this,t),X.updateOffset(this,!0),this):ad(this,"Month")}function Lk(){return Zd(this.year(),this.month())}function Fk(t){return this._monthsParseExact?(He(this,"_monthsRegex")||Ib.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(He(this,"_monthsShortRegex")||(this._monthsShortRegex=Hk),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function $k(t){return this._monthsParseExact?(He(this,"_monthsRegex")||Ib.call(this),t?this._monthsStrictRegex:this._monthsRegex):(He(this,"_monthsRegex")||(this._monthsRegex=Pk),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Ib(){function t(s,l){return l.length-s.length}var e=[],r=[],n=[],i,o;for(i=0;i<12;i++)o=Xn([2e3,i]),e.push(this.monthsShort(o,"")),r.push(this.months(o,"")),n.push(this.months(o,"")),n.push(this.monthsShort(o,""));for(e.sort(t),r.sort(t),n.sort(t),i=0;i<12;i++)e[i]=Mr(e[i]),r[i]=Mr(r[i]);for(i=0;i<24;i++)n[i]=Mr(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}oe("Y",0,0,function(){var t=this.year();return t<=9999?Bn(t,4):"+"+t});oe(0,["YY",2],0,function(){return this.year()%100});oe(0,["YYYY",4],0,"year");oe(0,["YYYYY",5],0,"year");oe(0,["YYYYYY",6,!0],0,"year");qt("year","y");Zt("year",1);q("Y",Qd);q("YY",Ke,Fr);q("YYYY",yw,vw);q("YYYYY",Xd,Gd);q("YYYYYY",Xd,Gd);Le(["YYYYY","YYYYYY"],Kt);Le("YYYY",function(t,e){e[Kt]=t.length===2?X.parseTwoDigitYear(t):be(t)});Le("YY",function(t,e){e[Kt]=X.parseTwoDigitYear(t)});Le("Y",function(t,e){e[Kt]=parseInt(t,10)});function ia(t){return Yd(t)?366:365}X.parseTwoDigitYear=function(t){return be(t)+(be(t)>68?1900:2e3)};var Hb=il("FullYear",!0);function Vk(){return Yd(this.year())}function Wk(t,e,r,n,i,o,s){var l;return t<100&&t>=0?(l=new Date(t+400,e,r,n,i,o,s),isFinite(l.getFullYear())&&l.setFullYear(t)):l=new Date(t,e,r,n,i,o,s),l}function Oa(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function cd(t,e,r){var n=7+e-r,i=(7+Oa(t,0,n).getUTCDay()-e)%7;return-i+n-1}function Pb(t,e,r,n,i){var o=(7+r-n)%7,s=cd(t,n,i),l=1+7*(e-1)+o+s,a,u;return l<=0?(a=t-1,u=ia(a)+l):l>ia(t)?(a=t+1,u=l-ia(t)):(a=t,u=l),{year:a,dayOfYear:u}}function xa(t,e,r){var n=cd(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+mi(s,e,r)):i>mi(t.year(),e,r)?(o=i-mi(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function mi(t,e,r){var n=cd(t,e,r),i=cd(t+1,e,r);return(ia(t)-n+i)/7}oe("w",["ww",2],"wo","week");oe("W",["WW",2],"Wo","isoWeek");qt("week","w");qt("isoWeek","W");Zt("week",5);Zt("isoWeek",5);q("w",Ke);q("ww",Ke,Fr);q("W",Ke);q("WW",Ke,Fr);Ka(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=be(t)});function Bk(t){return xa(t,this._week.dow,this._week.doy).week}var zk={dow:0,doy:6};function jk(){return this._week.dow}function Uk(){return this._week.doy}function Yk(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Gk(t){var e=xa(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}oe("d",0,"do","day");oe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});oe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});oe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});oe("e",0,0,"weekday");oe("E",0,0,"isoWeekday");qt("day","d");qt("weekday","e");qt("isoWeekday","E");Zt("day",11);Zt("weekday",11);Zt("isoWeekday",11);q("d",Ke);q("e",Ke);q("E",Ke);q("dd",function(t,e){return e.weekdaysMinRegex(t)});q("ddd",function(t,e){return e.weekdaysShortRegex(t)});q("dddd",function(t,e){return e.weekdaysRegex(t)});Ka(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:pe(r).invalidWeekday=t});Ka(["d","e","E"],function(t,e,r,n){e[n]=be(t)});function Kk(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Xk(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Cw(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Qk="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ab="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),qk="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Zk=Ga,Jk=Ga,eL=Ga;function tL(t,e){var r=Tn(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Cw(r,this._week.dow):t?r[t.day()]:r}function rL(t){return t===!0?Cw(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function nL(t){return t===!0?Cw(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function iL(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Xn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=ht.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=ht.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=ht.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=ht.call(this._weekdaysParse,s),i!==-1||(i=ht.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=ht.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=ht.call(this._shortWeekdaysParse,s),i!==-1||(i=ht.call(this._weekdaysParse,s),i!==-1)?i:(i=ht.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=ht.call(this._minWeekdaysParse,s),i!==-1||(i=ht.call(this._weekdaysParse,s),i!==-1)?i:(i=ht.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function oL(t,e,r){var n,i,o;if(this._weekdaysParseExact)return iL.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Xn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function sL(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=Kk(t,this.localeData()),this.add(t-e,"d")):e}function lL(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function aL(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Xk(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function uL(t){return this._weekdaysParseExact?(He(this,"_weekdaysRegex")||Sw.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(He(this,"_weekdaysRegex")||(this._weekdaysRegex=Zk),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function cL(t){return this._weekdaysParseExact?(He(this,"_weekdaysRegex")||Sw.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(He(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Jk),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function dL(t){return this._weekdaysParseExact?(He(this,"_weekdaysRegex")||Sw.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(He(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=eL),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Sw(){function t(d,f){return f.length-d.length}var e=[],r=[],n=[],i=[],o,s,l,a,u;for(o=0;o<7;o++)s=Xn([2e3,1]).day(o),l=Mr(this.weekdaysMin(s,"")),a=Mr(this.weekdaysShort(s,"")),u=Mr(this.weekdays(s,"")),e.push(l),r.push(a),n.push(u),i.push(l),i.push(a),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Rw(){return this.hours()%12||12}function hL(){return this.hours()||24}oe("H",["HH",2],0,"hour");oe("h",["hh",2],0,Rw);oe("k",["kk",2],0,hL);oe("hmm",0,0,function(){return""+Rw.apply(this)+Bn(this.minutes(),2)});oe("hmmss",0,0,function(){return""+Rw.apply(this)+Bn(this.minutes(),2)+Bn(this.seconds(),2)});oe("Hmm",0,0,function(){return""+this.hours()+Bn(this.minutes(),2)});oe("Hmmss",0,0,function(){return""+this.hours()+Bn(this.minutes(),2)+Bn(this.seconds(),2)});function Nb(t,e){oe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Nb("a",!0);Nb("A",!1);qt("hour","h");Zt("hour",13);function Db(t,e){return e._meridiemParse}q("a",Db);q("A",Db);q("H",Ke);q("h",Ke);q("k",Ke);q("HH",Ke,Fr);q("hh",Ke,Fr);q("kk",Ke,Fr);q("hmm",bb);q("hmmss",Tb);q("Hmm",bb);q("Hmmss",Tb);Le(["H","HH"],Et);Le(["k","kk"],function(t,e,r){var n=be(t);e[Et]=n===24?0:n});Le(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Le(["h","hh"],function(t,e,r){e[Et]=be(t),pe(r).bigHour=!0});Le("hmm",function(t,e,r){var n=t.length-2;e[Et]=be(t.substr(0,n)),e[Cn]=be(t.substr(n)),pe(r).bigHour=!0});Le("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Et]=be(t.substr(0,n)),e[Cn]=be(t.substr(n,2)),e[di]=be(t.substr(i)),pe(r).bigHour=!0});Le("Hmm",function(t,e,r){var n=t.length-2;e[Et]=be(t.substr(0,n)),e[Cn]=be(t.substr(n))});Le("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Et]=be(t.substr(0,n)),e[Cn]=be(t.substr(n,2)),e[di]=be(t.substr(i))});function fL(t){return(t+"").toLowerCase().charAt(0)==="p"}var mL=/[ap]\.?m?\.?/i,gL=il("Hours",!0);function pL(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var kb={calendar:ok,longDateFormat:uk,invalidDate:dk,ordinal:fk,dayOfMonthOrdinalParse:mk,relativeTime:pk,months:Ik,monthsShort:_b,week:zk,weekdays:Qk,weekdaysMin:qk,weekdaysShort:Ab,meridiemParse:mL},Ze={},yl={},Ma;function wL(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function FC(t){return t&&t.toLowerCase().replace("_","-")}function vL(t){for(var e=0,r,n,i,o;e<t.length;){for(o=FC(t[e]).split("-"),r=o.length,n=FC(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Jd(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&wL(o,n)>=r-1)break;r--}e++}return Ma}function yL(t){return t.match("^[^/\\\\]*$")!=null}function Jd(t){var e=null,r;if(Ze[t]===void 0&&typeof Pc<"u"&&Pc&&Pc.exports&&yL(t))try{e=Ma._abbr,r=require,r("./locale/"+t),Qi(e)}catch{Ze[t]=null}return Ze[t]}function Qi(t,e){var r;return t&&(pr(e)?r=Si(t):r=Ew(t,e),r?Ma=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ma._abbr}function Ew(t,e){if(e!==null){var r,n=kb;if(e.abbr=t,Ze[t]!=null)vb("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ze[t]._config;else if(e.parentLocale!=null)if(Ze[e.parentLocale]!=null)n=Ze[e.parentLocale]._config;else if(r=Jd(e.parentLocale),r!=null)n=r._config;else return yl[e.parentLocale]||(yl[e.parentLocale]=[]),yl[e.parentLocale].push({name:t,config:e}),null;return Ze[t]=new gw(Cg(n,e)),yl[t]&&yl[t].forEach(function(i){Ew(i.name,i.config)}),Qi(t),Ze[t]}else return delete Ze[t],null}function CL(t,e){if(e!=null){var r,n,i=kb;Ze[t]!=null&&Ze[t].parentLocale!=null?Ze[t].set(Cg(Ze[t]._config,e)):(n=Jd(t),n!=null&&(i=n._config),e=Cg(i,e),n==null&&(e.abbr=t),r=new gw(e),r.parentLocale=Ze[t],Ze[t]=r),Qi(t)}else Ze[t]!=null&&(Ze[t].parentLocale!=null?(Ze[t]=Ze[t].parentLocale,t===Qi()&&Qi(t)):Ze[t]!=null&&delete Ze[t]);return Ze[t]}function Si(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ma;if(!Tn(t)){if(e=Jd(t),e)return e;t=[t]}return vL(t)}function SL(){return Sg(Ze)}function bw(t){var e,r=t._a;return r&&pe(t).overflow===-2&&(e=r[ci]<0||r[ci]>11?ci:r[Fn]<1||r[Fn]>Zd(r[Kt],r[ci])?Fn:r[Et]<0||r[Et]>24||r[Et]===24&&(r[Cn]!==0||r[di]!==0||r[xo]!==0)?Et:r[Cn]<0||r[Cn]>59?Cn:r[di]<0||r[di]>59?di:r[xo]<0||r[xo]>999?xo:-1,pe(t)._overflowDayOfYear&&(e<Kt||e>Fn)&&(e=Fn),pe(t)._overflowWeeks&&e===-1&&(e=Ok),pe(t)._overflowWeekday&&e===-1&&(e=xk),pe(t).overflow=e),t}var RL=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,EL=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bL=/Z|[+-]\d\d(?::?\d\d)?/,xu=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Of=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],TL=/^\/?Date\((-?\d+)/i,_L=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,OL={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Lb(t){var e,r,n=t._i,i=RL.exec(n)||EL.exec(n),o,s,l,a,u=xu.length,d=Of.length;if(i){for(pe(t).iso=!0,e=0,r=u;e<r;e++)if(xu[e][1].exec(i[1])){s=xu[e][0],o=xu[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=d;e<r;e++)if(Of[e][1].exec(i[3])){l=(i[2]||" ")+Of[e][0];break}if(l==null){t._isValid=!1;return}}if(!o&&l!=null){t._isValid=!1;return}if(i[4])if(bL.exec(i[4]))a="Z";else{t._isValid=!1;return}t._f=s+(l||"")+(a||""),_w(t)}else t._isValid=!1}function xL(t,e,r,n,i,o){var s=[ML(t),_b.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function ML(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function IL(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function HL(t,e,r){if(t){var n=Ab.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return pe(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function PL(t,e,r){if(t)return OL[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function Fb(t){var e=_L.exec(IL(t._i)),r;if(e){if(r=xL(e[4],e[3],e[2],e[5],e[6],e[7]),!HL(e[1],r,t))return;t._a=r,t._tzm=PL(e[8],e[9],e[10]),t._d=Oa.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),pe(t).rfc2822=!0}else t._isValid=!1}function AL(t){var e=TL.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(Lb(t),t._isValid===!1)delete t._isValid;else return;if(Fb(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:X.createFromInputFallback(t)}X.createFromInputFallback=sn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ds(t,e,r){return t??e??r}function NL(t){var e=new Date(X.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Tw(t){var e,r,n=[],i,o,s;if(!t._d){for(i=NL(t),t._w&&t._a[Fn]==null&&t._a[ci]==null&&DL(t),t._dayOfYear!=null&&(s=ds(t._a[Kt],i[Kt]),(t._dayOfYear>ia(s)||t._dayOfYear===0)&&(pe(t)._overflowDayOfYear=!0),r=Oa(s,0,t._dayOfYear),t._a[ci]=r.getUTCMonth(),t._a[Fn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Et]===24&&t._a[Cn]===0&&t._a[di]===0&&t._a[xo]===0&&(t._nextDay=!0,t._a[Et]=0),t._d=(t._useUTC?Oa:Wk).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Et]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(pe(t).weekdayMismatch=!0)}}function DL(t){var e,r,n,i,o,s,l,a,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=ds(e.GG,t._a[Kt],xa(Ge(),1,4).year),n=ds(e.W,1),i=ds(e.E,1),(i<1||i>7)&&(a=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=xa(Ge(),o,s),r=ds(e.gg,t._a[Kt],u.year),n=ds(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(a=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(a=!0)):i=o),n<1||n>mi(r,o,s)?pe(t)._overflowWeeks=!0:a!=null?pe(t)._overflowWeekday=!0:(l=Pb(r,n,i,o,s),t._a[Kt]=l.year,t._dayOfYear=l.dayOfYear)}X.ISO_8601=function(){};X.RFC_2822=function(){};function _w(t){if(t._f===X.ISO_8601){Lb(t);return}if(t._f===X.RFC_2822){Fb(t);return}t._a=[],pe(t).empty=!0;var e=""+t._i,r,n,i,o,s,l=e.length,a=0,u,d;for(i=yb(t._f,t._locale).match(pw)||[],d=i.length,r=0;r<d;r++)o=i[r],n=(e.match(bk(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&pe(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),a+=n.length),Ds[o]?(n?pe(t).empty=!1:pe(t).unusedTokens.push(o),_k(o,n,t)):t._strict&&!n&&pe(t).unusedTokens.push(o);pe(t).charsLeftOver=l-a,e.length>0&&pe(t).unusedInput.push(e),t._a[Et]<=12&&pe(t).bigHour===!0&&t._a[Et]>0&&(pe(t).bigHour=void 0),pe(t).parsedDateParts=t._a.slice(0),pe(t).meridiem=t._meridiem,t._a[Et]=kL(t._locale,t._a[Et],t._meridiem),u=pe(t).era,u!==null&&(t._a[Kt]=t._locale.erasConvertYear(u,t._a[Kt])),Tw(t),bw(t)}function kL(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function LL(t){var e,r,n,i,o,s,l=!1,a=t._f.length;if(a===0){pe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<a;i++)o=0,s=!1,e=mw({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],_w(e),fw(e)&&(s=!0),o+=pe(e).charsLeftOver,o+=pe(e).unusedTokens.length*10,pe(e).score=o,l?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(l=!0));$i(t,r||e)}function FL(t){if(!t._d){var e=ww(t._i),r=e.day===void 0?e.date:e.day;t._a=pb([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),Tw(t)}}function $L(t){var e=new Ya(bw($b(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function $b(t){var e=t._i,r=t._f;return t._locale=t._locale||Si(t._l),e===null||r===void 0&&e===""?Ud({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),_n(e)?new Ya(bw(e)):(Ua(e)?t._d=e:Tn(r)?LL(t):r?_w(t):VL(t),fw(t)||(t._d=null),t))}function VL(t){var e=t._i;pr(e)?t._d=new Date(X.now()):Ua(e)?t._d=new Date(e.valueOf()):typeof e=="string"?AL(t):Tn(e)?(t._a=pb(e.slice(0),function(r){return parseInt(r,10)}),Tw(t)):Ho(e)?FL(t):yi(e)?t._d=new Date(e):X.createFromInputFallback(t)}function Vb(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ho(t)&&hw(t)||Tn(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,$L(o)}function Ge(t,e,r,n){return Vb(t,e,r,n,!1)}var WL=sn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ge.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Ud()}),BL=sn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ge.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Ud()});function Wb(t,e){var r,n;if(e.length===1&&Tn(e[0])&&(e=e[0]),!e.length)return Ge();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function zL(){var t=[].slice.call(arguments,0);return Wb("isBefore",t)}function jL(){var t=[].slice.call(arguments,0);return Wb("isAfter",t)}var UL=function(){return Date.now?Date.now():+new Date},Cl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function YL(t){var e,r=!1,n,i=Cl.length;for(e in t)if(He(t,e)&&!(ht.call(Cl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Cl[n]]){if(r)return!1;parseFloat(t[Cl[n]])!==be(t[Cl[n]])&&(r=!0)}return!0}function GL(){return this._isValid}function KL(){return On(NaN)}function eh(t){var e=ww(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,l=e.hour||0,a=e.minute||0,u=e.second||0,d=e.millisecond||0;this._isValid=YL(e),this._milliseconds=+d+u*1e3+a*6e4+l*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=Si(),this._bubble()}function bc(t){return t instanceof eh}function Eg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function XL(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)be(t[s])!==be(e[s])&&o++;return o+i}function Bb(t,e){oe(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Bn(~~(r/60),2)+e+Bn(~~r%60,2)})}Bb("Z",":");Bb("ZZ","");q("Z",qd);q("ZZ",qd);Le(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=Ow(qd,t)});var QL=/([\+\-]|\d\d)/gi;function Ow(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(QL)||["-",0,0],o=+(i[1]*60)+be(i[2]),o===0?0:i[0]==="+"?o:-o)}function xw(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(_n(t)||Ua(t)?t.valueOf():Ge(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),X.updateOffset(r,!1),r):Ge(t).local()}function bg(t){return-Math.round(t._d.getTimezoneOffset())}X.updateOffset=function(){};function qL(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Ow(qd,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=bg(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?Ub(this,On(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,X.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:bg(this)}function ZL(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function JL(t){return this.utcOffset(0,t)}function eF(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(bg(this),"m")),this}function tF(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Ow(Rk,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function rF(t){return this.isValid()?(t=t?Ge(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function nF(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function iF(){if(!pr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return mw(t,this),t=$b(t),t._a?(e=t._isUTC?Xn(t._a):Ge(t._a),this._isDSTShifted=this.isValid()&&XL(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function oF(){return this.isValid()?!this._isUTC:!1}function sF(){return this.isValid()?this._isUTC:!1}function zb(){return this.isValid()?this._isUTC&&this._offset===0:!1}var lF=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,aF=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function On(t,e){var r=t,n=null,i,o,s;return bc(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:yi(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=lF.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:be(n[Fn])*i,h:be(n[Et])*i,m:be(n[Cn])*i,s:be(n[di])*i,ms:be(Eg(n[xo]*1e3))*i}):(n=aF.exec(t))?(i=n[1]==="-"?-1:1,r={y:ho(n[2],i),M:ho(n[3],i),w:ho(n[4],i),d:ho(n[5],i),h:ho(n[6],i),m:ho(n[7],i),s:ho(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=uF(Ge(r.from),Ge(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new eh(r),bc(t)&&He(t,"_locale")&&(o._locale=t._locale),bc(t)&&He(t,"_isValid")&&(o._isValid=t._isValid),o}On.fn=eh.prototype;On.invalid=KL;function ho(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function $C(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function uF(t,e){var r;return t.isValid()&&e.isValid()?(e=xw(e,t),t.isBefore(e)?r=$C(t,e):(r=$C(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function jb(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(vb(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=On(r,n),Ub(this,i,t),this}}function Ub(t,e,r,n){var i=e._milliseconds,o=Eg(e._days),s=Eg(e._months);t.isValid()&&(n=n??!0,s&&xb(t,ad(t,"Month")+s*r),o&&Sb(t,"Date",ad(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&X.updateOffset(t,o||s))}var cF=jb(1,"add"),dF=jb(-1,"subtract");function Yb(t){return typeof t=="string"||t instanceof String}function hF(t){return _n(t)||Ua(t)||Yb(t)||yi(t)||mF(t)||fF(t)||t===null||t===void 0}function fF(t){var e=Ho(t)&&!hw(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||He(t,o);return e&&r}function mF(t){var e=Tn(t),r=!1;return e&&(r=t.filter(function(n){return!yi(n)&&Yb(t)}).length===0),e&&r}function gF(t){var e=Ho(t)&&!hw(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||He(t,o);return e&&r}function pF(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function wF(t,e){arguments.length===1&&(arguments[0]?hF(arguments[0])?(t=arguments[0],e=void 0):gF(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ge(),n=xw(r,this).startOf("day"),i=X.calendarFormat(this,n)||"sameElse",o=e&&(Qn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Ge(r)))}function vF(){return new Ya(this)}function yF(t,e){var r=_n(t)?t:Ge(t);return this.isValid()&&r.isValid()?(e=ln(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function CF(t,e){var r=_n(t)?t:Ge(t);return this.isValid()&&r.isValid()?(e=ln(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function SF(t,e,r,n){var i=_n(t)?t:Ge(t),o=_n(e)?e:Ge(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function RF(t,e){var r=_n(t)?t:Ge(t),n;return this.isValid()&&r.isValid()?(e=ln(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function EF(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function bF(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function TF(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=xw(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=ln(e),e){case"year":o=Tc(this,n)/12;break;case"month":o=Tc(this,n);break;case"quarter":o=Tc(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Xr(o)}function Tc(t,e){if(t.date()<e.date())return-Tc(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}X.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";X.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function _F(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function OF(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Ec(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ec(r,"Z")):Ec(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function xF(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function MF(t){t||(t=this.isUtc()?X.defaultFormatUtc:X.defaultFormat);var e=Ec(this,t);return this.localeData().postformat(e)}function IF(t,e){return this.isValid()&&(_n(t)&&t.isValid()||Ge(t).isValid())?On({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function HF(t){return this.from(Ge(),t)}function PF(t,e){return this.isValid()&&(_n(t)&&t.isValid()||Ge(t).isValid())?On({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function AF(t){return this.to(Ge(),t)}function Gb(t){var e;return t===void 0?this._locale._abbr:(e=Si(t),e!=null&&(this._locale=e),this)}var Kb=sn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Xb(){return this._locale}var dd=1e3,ks=60*dd,hd=60*ks,Qb=(365*400+97)*24*hd;function Ls(t,e){return(t%e+e)%e}function qb(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-Qb:new Date(t,e,r).valueOf()}function Zb(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-Qb:Date.UTC(t,e,r)}function NF(t){var e,r;if(t=ln(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Zb:qb,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ls(e+(this._isUTC?0:this.utcOffset()*ks),hd);break;case"minute":e=this._d.valueOf(),e-=Ls(e,ks);break;case"second":e=this._d.valueOf(),e-=Ls(e,dd);break}return this._d.setTime(e),X.updateOffset(this,!0),this}function DF(t){var e,r;if(t=ln(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?Zb:qb,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=hd-Ls(e+(this._isUTC?0:this.utcOffset()*ks),hd)-1;break;case"minute":e=this._d.valueOf(),e+=ks-Ls(e,ks)-1;break;case"second":e=this._d.valueOf(),e+=dd-Ls(e,dd)-1;break}return this._d.setTime(e),X.updateOffset(this,!0),this}function kF(){return this._d.valueOf()-(this._offset||0)*6e4}function LF(){return Math.floor(this.valueOf()/1e3)}function FF(){return new Date(this.valueOf())}function $F(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function VF(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function WF(){return this.isValid()?this.toISOString():null}function BF(){return fw(this)}function zF(){return $i({},pe(this))}function jF(){return pe(this).overflow}function UF(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}oe("N",0,0,"eraAbbr");oe("NN",0,0,"eraAbbr");oe("NNN",0,0,"eraAbbr");oe("NNNN",0,0,"eraName");oe("NNNNN",0,0,"eraNarrow");oe("y",["y",1],"yo","eraYear");oe("y",["yy",2],0,"eraYear");oe("y",["yyy",3],0,"eraYear");oe("y",["yyyy",4],0,"eraYear");q("N",Mw);q("NN",Mw);q("NNN",Mw);q("NNNN",r$);q("NNNNN",n$);Le(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?pe(r).era=i:pe(r).invalidEra=t});q("y",ol);q("yy",ol);q("yyy",ol);q("yyyy",ol);q("yo",i$);Le(["y","yy","yyy","yyyy"],Kt);Le(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Kt]=r._locale.eraYearOrdinalParse(t,i):e[Kt]=parseInt(t,10)});function YF(t,e){var r,n,i,o=this._eras||Si("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=X(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=X(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function GF(t,e,r){var n,i,o=this.eras(),s,l,a;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),l=o[n].abbr.toUpperCase(),a=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(l===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(a===t)return o[n];break}else if([s,l,a].indexOf(t)>=0)return o[n]}function KF(t,e){var r=t.since<=t.until?1:-1;return e===void 0?X(t.since).year():X(t.since).year()+(e-t.offset)*r}function XF(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function QF(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function qF(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function ZF(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-X(i[t].since).year())*r+i[t].offset;return this.year()}function JF(t){return He(this,"_erasNameRegex")||Iw.call(this),t?this._erasNameRegex:this._erasRegex}function e$(t){return He(this,"_erasAbbrRegex")||Iw.call(this),t?this._erasAbbrRegex:this._erasRegex}function t$(t){return He(this,"_erasNarrowRegex")||Iw.call(this),t?this._erasNarrowRegex:this._erasRegex}function Mw(t,e){return e.erasAbbrRegex(t)}function r$(t,e){return e.erasNameRegex(t)}function n$(t,e){return e.erasNarrowRegex(t)}function i$(t,e){return e._eraYearOrdinalRegex||ol}function Iw(){var t=[],e=[],r=[],n=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(Mr(s[i].name)),t.push(Mr(s[i].abbr)),r.push(Mr(s[i].narrow)),n.push(Mr(s[i].name)),n.push(Mr(s[i].abbr)),n.push(Mr(s[i].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}oe(0,["gg",2],0,function(){return this.weekYear()%100});oe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function th(t,e){oe(0,[t,t.length],0,e)}th("gggg","weekYear");th("ggggg","weekYear");th("GGGG","isoWeekYear");th("GGGGG","isoWeekYear");qt("weekYear","gg");qt("isoWeekYear","GG");Zt("weekYear",1);Zt("isoWeekYear",1);q("G",Qd);q("g",Qd);q("GG",Ke,Fr);q("gg",Ke,Fr);q("GGGG",yw,vw);q("gggg",yw,vw);q("GGGGG",Xd,Gd);q("ggggg",Xd,Gd);Ka(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=be(t)});Ka(["gg","GG"],function(t,e,r,n){e[n]=X.parseTwoDigitYear(t)});function o$(t){return Jb.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function s$(t){return Jb.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function l$(){return mi(this.year(),1,4)}function a$(){return mi(this.isoWeekYear(),1,4)}function u$(){var t=this.localeData()._week;return mi(this.year(),t.dow,t.doy)}function c$(){var t=this.localeData()._week;return mi(this.weekYear(),t.dow,t.doy)}function Jb(t,e,r,n,i){var o;return t==null?xa(this,n,i).year:(o=mi(t,n,i),e>o&&(e=o),d$.call(this,t,e,r,n,i))}function d$(t,e,r,n,i){var o=Pb(t,e,r,n,i),s=Oa(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}oe("Q",0,"Qo","quarter");qt("quarter","Q");Zt("quarter",7);q("Q",Rb);Le("Q",function(t,e){e[ci]=(be(t)-1)*3});function h$(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}oe("D",["DD",2],"Do","date");qt("date","D");Zt("date",9);q("D",Ke);q("DD",Ke,Fr);q("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Le(["D","DD"],Fn);Le("Do",function(t,e){e[Fn]=be(t.match(Ke)[0])});var eT=il("Date",!0);oe("DDD",["DDDD",3],"DDDo","dayOfYear");qt("dayOfYear","DDD");Zt("dayOfYear",4);q("DDD",Kd);q("DDDD",Eb);Le(["DDD","DDDD"],function(t,e,r){r._dayOfYear=be(t)});function f$(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}oe("m",["mm",2],0,"minute");qt("minute","m");Zt("minute",14);q("m",Ke);q("mm",Ke,Fr);Le(["m","mm"],Cn);var m$=il("Minutes",!1);oe("s",["ss",2],0,"second");qt("second","s");Zt("second",15);q("s",Ke);q("ss",Ke,Fr);Le(["s","ss"],di);var g$=il("Seconds",!1);oe("S",0,0,function(){return~~(this.millisecond()/100)});oe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});oe(0,["SSS",3],0,"millisecond");oe(0,["SSSS",4],0,function(){return this.millisecond()*10});oe(0,["SSSSS",5],0,function(){return this.millisecond()*100});oe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});oe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});oe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});oe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});qt("millisecond","ms");Zt("millisecond",16);q("S",Kd,Rb);q("SS",Kd,Fr);q("SSS",Kd,Eb);var Vi,tT;for(Vi="SSSS";Vi.length<=9;Vi+="S")q(Vi,ol);function p$(t,e){e[xo]=be(("0."+t)*1e3)}for(Vi="S";Vi.length<=9;Vi+="S")Le(Vi,p$);tT=il("Milliseconds",!1);oe("z",0,0,"zoneAbbr");oe("zz",0,0,"zoneName");function w$(){return this._isUTC?"UTC":""}function v$(){return this._isUTC?"Coordinated Universal Time":""}var j=Ya.prototype;j.add=cF;j.calendar=wF;j.clone=vF;j.diff=TF;j.endOf=DF;j.format=MF;j.from=IF;j.fromNow=HF;j.to=PF;j.toNow=AF;j.get=Ck;j.invalidAt=jF;j.isAfter=yF;j.isBefore=CF;j.isBetween=SF;j.isSame=RF;j.isSameOrAfter=EF;j.isSameOrBefore=bF;j.isValid=BF;j.lang=Kb;j.locale=Gb;j.localeData=Xb;j.max=BL;j.min=WL;j.parsingFlags=zF;j.set=Sk;j.startOf=NF;j.subtract=dF;j.toArray=$F;j.toObject=VF;j.toDate=FF;j.toISOString=OF;j.inspect=xF;typeof Symbol<"u"&&Symbol.for!=null&&(j[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});j.toJSON=WF;j.toString=_F;j.unix=LF;j.valueOf=kF;j.creationData=UF;j.eraName=XF;j.eraNarrow=QF;j.eraAbbr=qF;j.eraYear=ZF;j.year=Hb;j.isLeapYear=Vk;j.weekYear=o$;j.isoWeekYear=s$;j.quarter=j.quarters=h$;j.month=Mb;j.daysInMonth=Lk;j.week=j.weeks=Yk;j.isoWeek=j.isoWeeks=Gk;j.weeksInYear=u$;j.weeksInWeekYear=c$;j.isoWeeksInYear=l$;j.isoWeeksInISOWeekYear=a$;j.date=eT;j.day=j.days=sL;j.weekday=lL;j.isoWeekday=aL;j.dayOfYear=f$;j.hour=j.hours=gL;j.minute=j.minutes=m$;j.second=j.seconds=g$;j.millisecond=j.milliseconds=tT;j.utcOffset=qL;j.utc=JL;j.local=eF;j.parseZone=tF;j.hasAlignedHourOffset=rF;j.isDST=nF;j.isLocal=oF;j.isUtcOffset=sF;j.isUtc=zb;j.isUTC=zb;j.zoneAbbr=w$;j.zoneName=v$;j.dates=sn("dates accessor is deprecated. Use date instead.",eT);j.months=sn("months accessor is deprecated. Use month instead",Mb);j.years=sn("years accessor is deprecated. Use year instead",Hb);j.zone=sn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ZL);j.isDSTShifted=sn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",iF);function y$(t){return Ge(t*1e3)}function C$(){return Ge.apply(null,arguments).parseZone()}function rT(t){return t}var Pe=gw.prototype;Pe.calendar=sk;Pe.longDateFormat=ck;Pe.invalidDate=hk;Pe.ordinal=gk;Pe.preparse=rT;Pe.postformat=rT;Pe.relativeTime=wk;Pe.pastFuture=vk;Pe.set=ik;Pe.eras=YF;Pe.erasParse=GF;Pe.erasConvertYear=KF;Pe.erasAbbrRegex=e$;Pe.erasNameRegex=JF;Pe.erasNarrowRegex=t$;Pe.months=Ak;Pe.monthsShort=Nk;Pe.monthsParse=kk;Pe.monthsRegex=$k;Pe.monthsShortRegex=Fk;Pe.week=Bk;Pe.firstDayOfYear=Uk;Pe.firstDayOfWeek=jk;Pe.weekdays=tL;Pe.weekdaysMin=nL;Pe.weekdaysShort=rL;Pe.weekdaysParse=oL;Pe.weekdaysRegex=uL;Pe.weekdaysShortRegex=cL;Pe.weekdaysMinRegex=dL;Pe.isPM=fL;Pe.meridiem=pL;function fd(t,e,r,n){var i=Si(),o=Xn().set(n,e);return i[r](o,t)}function nT(t,e,r){if(yi(t)&&(e=t,t=void 0),t=t||"",e!=null)return fd(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=fd(t,n,r,"month");return i}function Hw(t,e,r,n){typeof t=="boolean"?(yi(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,yi(e)&&(r=e,e=void 0),e=e||"");var i=Si(),o=t?i._week.dow:0,s,l=[];if(r!=null)return fd(e,(r+o)%7,n,"day");for(s=0;s<7;s++)l[s]=fd(e,(s+o)%7,n,"day");return l}function S$(t,e){return nT(t,e,"months")}function R$(t,e){return nT(t,e,"monthsShort")}function E$(t,e,r){return Hw(t,e,r,"weekdays")}function b$(t,e,r){return Hw(t,e,r,"weekdaysShort")}function T$(t,e,r){return Hw(t,e,r,"weekdaysMin")}Qi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=be(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});X.lang=sn("moment.lang is deprecated. Use moment.locale instead.",Qi);X.langData=sn("moment.langData is deprecated. Use moment.localeData instead.",Si);var Zn=Math.abs;function _$(){var t=this._data;return this._milliseconds=Zn(this._milliseconds),this._days=Zn(this._days),this._months=Zn(this._months),t.milliseconds=Zn(t.milliseconds),t.seconds=Zn(t.seconds),t.minutes=Zn(t.minutes),t.hours=Zn(t.hours),t.months=Zn(t.months),t.years=Zn(t.years),this}function iT(t,e,r,n){var i=On(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function O$(t,e){return iT(this,t,e,1)}function x$(t,e){return iT(this,t,e,-1)}function VC(t){return t<0?Math.floor(t):Math.ceil(t)}function M$(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,l,a;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=VC(Tg(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Xr(t/1e3),n.seconds=i%60,o=Xr(i/60),n.minutes=o%60,s=Xr(o/60),n.hours=s%24,e+=Xr(s/24),a=Xr(oT(e)),r+=a,e-=VC(Tg(a)),l=Xr(r/12),r%=12,n.days=e,n.months=r,n.years=l,this}function oT(t){return t*4800/146097}function Tg(t){return t*146097/4800}function I$(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=ln(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+oT(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(Tg(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function H$(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+be(this._months/12)*31536e6:NaN}function Ri(t){return function(){return this.as(t)}}var P$=Ri("ms"),A$=Ri("s"),N$=Ri("m"),D$=Ri("h"),k$=Ri("d"),L$=Ri("w"),F$=Ri("M"),$$=Ri("Q"),V$=Ri("y");function W$(){return On(this)}function B$(t){return t=ln(t),this.isValid()?this[t+"s"]():NaN}function Ko(t){return function(){return this.isValid()?this._data[t]:NaN}}var z$=Ko("milliseconds"),j$=Ko("seconds"),U$=Ko("minutes"),Y$=Ko("hours"),G$=Ko("days"),K$=Ko("months"),X$=Ko("years");function Q$(){return Xr(this.days()/7)}var oi=Math.round,Ts={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function q$(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function Z$(t,e,r,n){var i=On(t).abs(),o=oi(i.as("s")),s=oi(i.as("m")),l=oi(i.as("h")),a=oi(i.as("d")),u=oi(i.as("M")),d=oi(i.as("w")),f=oi(i.as("y")),m=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||l<=1&&["h"]||l<r.h&&["hh",l]||a<=1&&["d"]||a<r.d&&["dd",a];return r.w!=null&&(m=m||d<=1&&["w"]||d<r.w&&["ww",d]),m=m||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],m[2]=e,m[3]=+t>0,m[4]=n,q$.apply(null,m)}function J$(t){return t===void 0?oi:typeof t=="function"?(oi=t,!0):!1}function eV(t,e){return Ts[t]===void 0?!1:e===void 0?Ts[t]:(Ts[t]=e,t==="s"&&(Ts.ss=e-1),!0)}function tV(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Ts,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Ts,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=Z$(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var xf=Math.abs;function ts(t){return(t>0)-(t<0)||+t}function rh(){if(!this.isValid())return this.localeData().invalidDate();var t=xf(this._milliseconds)/1e3,e=xf(this._days),r=xf(this._months),n,i,o,s,l=this.asSeconds(),a,u,d,f;return l?(n=Xr(t/60),i=Xr(n/60),t%=60,n%=60,o=Xr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",a=l<0?"-":"",u=ts(this._months)!==ts(l)?"-":"",d=ts(this._days)!==ts(l)?"-":"",f=ts(this._milliseconds)!==ts(l)?"-":"",a+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?d+e+"D":"")+(i||n||t?"T":"")+(i?f+i+"H":"")+(n?f+n+"M":"")+(t?f+s+"S":"")):"P0D"}var Me=eh.prototype;Me.isValid=GL;Me.abs=_$;Me.add=O$;Me.subtract=x$;Me.as=I$;Me.asMilliseconds=P$;Me.asSeconds=A$;Me.asMinutes=N$;Me.asHours=D$;Me.asDays=k$;Me.asWeeks=L$;Me.asMonths=F$;Me.asQuarters=$$;Me.asYears=V$;Me.valueOf=H$;Me._bubble=M$;Me.clone=W$;Me.get=B$;Me.milliseconds=z$;Me.seconds=j$;Me.minutes=U$;Me.hours=Y$;Me.days=G$;Me.weeks=Q$;Me.months=K$;Me.years=X$;Me.humanize=tV;Me.toISOString=rh;Me.toString=rh;Me.toJSON=rh;Me.locale=Gb;Me.localeData=Xb;Me.toIsoString=sn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",rh);Me.lang=Kb;oe("X",0,0,"unix");oe("x",0,0,"valueOf");q("x",Qd);q("X",Ek);Le("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Le("x",function(t,e,r){r._d=new Date(be(t))});//! moment.js
X.version="2.29.4";rk(Ge);X.fn=j;X.min=zL;X.max=jL;X.now=UL;X.utc=Xn;X.unix=y$;X.months=S$;X.isDate=Ua;X.locale=Qi;X.invalid=Ud;X.duration=On;X.isMoment=_n;X.weekdays=E$;X.parseZone=C$;X.localeData=Si;X.isDuration=bc;X.monthsShort=R$;X.weekdaysMin=T$;X.defineLocale=Ew;X.updateLocale=CL;X.locales=SL;X.weekdaysShort=b$;X.normalizeUnits=ln;X.relativeTimeRounding=J$;X.relativeTimeThreshold=eV;X.calendarFormat=pF;X.prototype=j;X.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function rV(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function WC(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Mf(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function nh(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const l=o.length;for(i+=1;i<l;)s=e(s,o[i],i,o),i+=1;return s}function Pw(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const l=n[r];e(l,r,n)&&(s+=1,o[s]=l),r+=1}return o}function Lo(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const l=n[r];s+=1,o[s]=e(l,r,n),r+=1}return o}function ge(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function BC(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return ge(i,s=>{o=o.filter(l=>!s.includes(l))}),o}function zC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Ar(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return nh(t,(o,s,l)=>{const a=s.replace(/\r?\n\s*/g,""),u=r[l]?r[l]:"";return o+a+u},"").trim()}function sT(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Se(t){return typeof t<"u"}function Sr(t){return typeof t>"u"}function Us(t){return t===null||t===""||Sr(t)}function nV(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ul="length",oa=t=>parseInt(t,16),jC=t=>parseInt(t,10),md=(t,e,r)=>t.substr(e,r),sa=t=>t.codePointAt(0)-65,_g=t=>`${t}`.replace(/\-/g,""),iV=t=>oa(md(_g(t),oa("12"),sa("F")))/(oa(md(_g(t),sa("B"),~~![][Ul]))||9),oV=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let UC=!1;const YC={invalid:()=>Ar`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ar`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ar`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},GC={invalid:()=>Ar`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ar`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ar`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function sV(t,e){const r=!Us(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.3.0";let o,s="invalid",l="invalid";t=_g(t||"");const a=lV(t);if(r||n||a)if(a){const u=X("16/04/2024","DD/MM/YYYY"),d=Math.floor(u.toDate().getTime()/864e5),f=iV(t);o=X((f+1)*864e5,"x").format("MMMM DD, YYYY"),d>f?(s="expired",l="expired"):(s="valid",l="valid")}else n?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";if(oV()&&(s="valid",l="valid"),!UC&&s!=="valid"&&(YC[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](YC[s]({keyValidityDate:o,hotVersion:i})),UC=!0),l!=="valid"&&e.parentNode&&GC[l]({keyValidityDate:o,hotVersion:i})){const d=document.createElement("div");d.className="hot-display-license-info",d.innerHTML=GC[l]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(d,e.nextSibling)}}function lV(t){let e=[][Ul],r=e;if(t[Ul]!==sa("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=sa(i.shift());o;o=sa(i.shift()||"A"))--o<""[Ul]?r=r|(jC(`${jC(oa(n)+(oa(md(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=md(t,o,o?i[Ul]===1?9:8:6);return r===e}function Aw(t){return t[0].toUpperCase()+t.substr(1)}function lT(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function aV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function uV(t,e){return tk.sanitize(t,e)}const ih=t=>["tabindex",t],cV=()=>["role","treegrid"],hi=()=>["role","presentation"],dV=()=>["role","gridcell"],hV=()=>["role","rowheader"],aT=()=>["role","rowgroup"],fV=()=>["role","columnheader"],Og=()=>["role","row"],mV=()=>["scope","col"],gV=()=>["scope","row"],uT=()=>["aria-hidden","true"],pV=()=>["aria-multiselectable","true"],cT=t=>["aria-rowcount",t],oh=t=>["aria-colcount",t],dT=t=>["aria-rowindex",t],Nw=t=>["aria-colindex",t],KC=()=>["aria-readonly","true"],XC=()=>["aria-invalid","true"],hT=()=>["aria-selected","true"];function wV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function vV(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function yV(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function gd(t){return yV(t)&&t.parent}function fT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:l}=o;if(s===n&&(e.includes(l)||e.includes(o)))return o;const{host:a}=o;a&&s===i?o=a:o=o.parentNode}return null}function Mu(t,e,r){const n=[];let i=t;for(;i&&(i=fT(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function xg(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function CV(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function fo(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function mT(t){return!t||!t.length?[]:t.filter(e=>!!e)}function gT(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function ot(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Ne(t,e){typeof e=="string"&&(e=e.split(" ")),e=mT(e),e.length>0&&t.classList.add(...e)}function St(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=gT(e,!0);r=mT(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function rt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Xa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=gT(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function pT(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)pT(e[r])}}function Ys(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const SV=/(<(.*)>|&(.*);)/;function RV(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;SV.test(e)?t.innerHTML=r?uV(e):e:Qa(t,e)}function Qa(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Ys(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Ia(t){const e=t.ownerDocument.documentElement;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Ia(r.host.impl);if(r.host)return Ia(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(to(r).display==="none")return!1;r=r.parentNode}return!0}function Qr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,l;for(o=i.offsetLeft,s=i.offsetTop,l=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,l=i;return l&&l.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function wT(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Dw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function kw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?wT(e):t.scrollTop}function vT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Dw(e):t.scrollLeft}function pd(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:l}=i.style;if([o,s,l].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:l}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(l)||i.clientHeight<=i.scrollHeight+1&&(n.includes(l)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function EV(t){return t.scrollHeight-t.clientHeight}function bV(t){return t.scrollWidth-t.clientWidth}function wd(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=to(n,r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),l=i.getPropertyValue("overflow-y"),a=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(l)||o.includes(a))return n;n=n.parentNode}return r}function Mg(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=to(t,r);if(i[e]!==""&&i[e]!==void 0)return i[e]}function to(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function It(t){return t.offsetWidth}function en(t){return t.offsetHeight}function _s(t){return t.clientHeight||t.innerHeight}function yT(t){return t.clientWidth||t.innerWidth}function TV(t){return t.selectionStart?t.selectionStart:0}function QC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function CT(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let If;function _V(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function nr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return If===void 0&&(If=_V(t)),If}function OV(t){return t.offsetWidth!==t.clientWidth}function xV(t){return t.offsetHeight!==t.clientHeight}function Lw(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function sh(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function _c(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function ST(t){return _c(t)&&t.hasAttribute("data-hot-input")===!1}function MV(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Je(t){return typeof t=="function"}function IV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function HV(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return t.apply(this,r.concat(s))}}function Ig(t,e,r,n,i,o,s,l){return Se(l)?t.call(e,r,n,i,o,s,l):Se(s)?t.call(e,r,n,i,o,s):Se(o)?t.call(e,r,n,i,o):Se(i)?t.call(e,r,n,i):Se(n)?t.call(e,r,n):Se(r)?t.call(e,r):t.call(e)}var PV=$t,qC=sb,AV=Vt,ZC=jo,NV=aw,JC=PV([].push),DV=function(t){if(AV(t))return t;if(qC(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?JC(r,i):(typeof i=="number"||ZC(i)==="Number"||ZC(i)==="String")&&JC(r,NV(i))}var o=r.length,s=!0;return function(l,a){if(s)return s=!1,a;if(qC(this))return a;for(var u=0;u<o;u++)if(r[u]===l)return a}}},kV=Yo,RT=Wa,ET=jd,LV=rl,qa=$t,bT=on,eS=Vt,tS=qp,TT=cw,FV=DV,$V=Qp,VV=String,qi=RT("JSON","stringify"),Iu=qa(/./.exec),rS=qa("".charAt),WV=qa("".charCodeAt),BV=qa("".replace),zV=qa(1 .toString),jV=/[\uD800-\uDFFF]/g,nS=/^[\uD800-\uDBFF]$/,iS=/^[\uDC00-\uDFFF]$/,oS=!$V||bT(function(){var t=RT("Symbol")("stringify detection");return qi([t])!=="[null]"||qi({a:t})!=="{}"||qi(Object(t))!=="{}"}),sS=bT(function(){return qi("\uDF06\uD834")!=='"\\udf06\\ud834"'||qi("\uDEAD")!=='"\\udead"'}),UV=function(t,e){var r=TT(arguments),n=FV(e);if(!(!eS(n)&&(t===void 0||tS(t))))return r[1]=function(i,o){if(eS(n)&&(o=LV(n,this,VV(i),o)),!tS(o))return o},ET(qi,null,r)},YV=function(t,e,r){var n=rS(r,e-1),i=rS(r,e+1);return Iu(nS,t)&&!Iu(iS,i)||Iu(iS,t)&&!Iu(nS,n)?"\\u"+zV(WV(t,0),16):t};qi&&kV({target:"JSON",stat:!0,arity:3,forced:oS||sS},{stringify:function(e,r,n){var i=TT(arguments),o=ET(oS?UV:qi,null,i);return sS&&typeof o=="string"?BV(o,jV,YV):o}});function Ha(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ye(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Ha(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Ha(r[0])]:e[n]=[]:e[n]=null)})),e}function GV(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Gs(t,e,r){const n=Array.isArray(r);return Ye(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function _T(t,e){Ye(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),_T(t[n],e[n])):t[n]=e[n]})}function ro(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function mt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return ge(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Ye(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const l=function(d,f){const m=`_${d}`,p=C=>{let S=C;return(Array.isArray(S)||zn(S))&&(S=ro(S)),S};return function(){return this[m]===void 0&&(this[m]=p(f)),this[m]}},a=function(d){const f=`_${d}`;return function(m){this[f]=m}};Object.defineProperty(t.prototype,s,{get:l(s,o),set:a(s),configurable:!0})}})}),t}function OT(t,e){return JSON.stringify(t)===JSON.stringify(e)}function zn(t){return Object.prototype.toString.call(t)==="[object Object]"}function so(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Ye(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function KV(t,e){const r=e.split(".");let n=t;return Ye(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Hf(t,e,r){const n=e.split(".");let i=t;n.forEach((o,s)=>{s!==n.length-1?(Ks(i,o)||(i[o]={}),i=i[o]):i[o]=r})}function Fw(t){if(!zn(t))return 0;const e=function(r){let n=0;return zn(r)?Ye(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function Sn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Ks(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function XV(t){return window.requestAnimationFrame(t)}function QV(){return"ontouchstart"in window}function qV(){return typeof window<"u"}const Yr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Xo={chrome:Yr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Yr(t=>/CriOS/.test(t)),edge:Yr(t=>/Edge/.test(t)),edgeWebKit:Yr(t=>/EdgiOS/.test(t)),firefox:Yr(t=>/Firefox/.test(t)),firefoxWebKit:Yr(t=>/FxiOS/.test(t)),mobile:Yr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Yr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},lh={mac:Yr(t=>/^Mac/.test(t)),win:Yr(t=>/^Win/.test(t)),linux:Yr(t=>/^Linux/.test(t)),ios:Yr(t=>/iPhone|iPad|iPod/i.test(t))};function ZV(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(Xo,r=>{let{test:n}=r;return void n(t,e)})}function JV(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(lh,e=>{let{test:r}=e;return void r(t)})}qV()&&(ZV(),JV());function eW(){return Xo.chrome.value}function tW(){return Xo.chromeWebKit.value}function Pf(){return Xo.firefox.value}function rW(){return Xo.firefoxWebKit.value}function nW(){return Xo.edge.value}function Os(){return Xo.mobile.value}function xT(){return lh.ios.value}function iW(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&lh.mac.value}function lS(){return lh.mac.value}const ae={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Pf()?182:174,AUDIO_MUTE:Pf()?181:173,AUDIO_UP:Pf()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},oW=[ae.ALT,ae.ARROW_DOWN,ae.ARROW_LEFT,ae.ARROW_RIGHT,ae.ARROW_UP,ae.AUDIO_DOWN,ae.AUDIO_MUTE,ae.AUDIO_UP,ae.BACKSPACE,ae.CAPS_LOCK,ae.DELETE,ae.END,ae.ENTER,ae.ESCAPE,ae.F1,ae.F2,ae.F3,ae.F4,ae.F5,ae.F6,ae.F7,ae.F8,ae.F9,ae.F10,ae.F11,ae.F12,ae.F13,ae.F14,ae.F15,ae.F16,ae.F17,ae.F18,ae.F19,ae.HOME,ae.INSERT,ae.MEDIA_NEXT,ae.MEDIA_PLAY_PAUSE,ae.MEDIA_PREV,ae.MEDIA_STOP,ae.NULL,ae.NUM_LOCK,ae.PAGE_DOWN,ae.PAGE_UP,ae.PAUSE,ae.SCROLL_LOCK,ae.SHIFT,ae.TAB];function sW(t){return oW.includes(t)}function lW(t){return[ae.CONTROL,ae.COMMAND_LEFT,ae.COMMAND_RIGHT,ae.COMMAND_FIREFOX].includes(t)}function aW(t,e){const r=e.split("|");let n=!1;return ge(r,i=>{if(t===ae[i])return n=!0,!1}),n}function ah(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function bo(t){return t.isImmediatePropagationEnabled===!1}function Hg(t){return t.button===2}function MT(t){return t.button===0}function Xs(){Se(console)&&console.warn(...arguments)}function uW(){Se(console)&&console.error(...arguments)}function cW(t,e,r){return e=dW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dW(t){var e=hW(t,"string");return typeof e=="symbol"?e:e+""}function hW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rs=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],fW=Ar`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Af=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Nf=new Map([[]]);class vr{static getSingleton(){return gW()}constructor(){cW(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return ge(rs,r=>e[r]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(r))ge(r,i=>this.add(e,i,n));else{Af.has(e)&&Xs(aV(fW,{hookName:e,removedInVersion:Af.get(e)})),Nf.has(e)&&Xs(Nf.get(e));const i=this.getBucket(n);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),r.skip=!1,i[e].indexOf(r)===-1){let o=!1;r.initialHook&&ge(i[e],(s,l)=>{if(s.initialHook)return i[e][l]=r,o=!0,!1}),o||i[e].push(r)}}return this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(r)?ge(r,i=>this.once(e,i,n)):(r.runOnce=!0,this.add(e,r,n))}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(n);return typeof i[e]<"u"&&i[e].indexOf(r)>=0?(r.skip=!0,!0):!1}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const n=this.getBucket(r);return!!(n[e]!==void 0&&n[e].length)}run(e,r,n,i,o,s,l,a){{const u=this.globalBucket[r],d=u?u.length:0;let f=0;if(d)for(;f<d;){if(!u[f]||u[f].skip){f+=1;continue}const m=Ig(u[f],e,n,i,o,s,l,a);m!==void 0&&(n=m),u[f]&&u[f].runOnce&&this.remove(r,u[f]),f+=1}}{const u=this.getBucket(e)[r],d=u?u.length:0;let f=0;if(d)for(;f<d;){if(!u[f]||u[f].skip){f+=1;continue}const m=Ig(u[f],e,n,i,o,s,l,a);m!==void 0&&(n=m),u[f]&&u[f].runOnce&&this.remove(r,u[f],e),f+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ye(this.getBucket(e),(r,n,i)=>i[n].length=0)}register(e){this.isRegistered(e)||rs.push(e)}deregister(e){this.isRegistered(e)&&rs.splice(rs.indexOf(e),1)}isDeprecated(e){return Nf.has(e)||Af.has(e)}isRegistered(e){return rs.indexOf(e)>=0}getRegistered(){return rs}}const mW=new vr;function gW(){return mW}const Df=new Map;function sl(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Df.has(t)||Df.set(t,new Map);const e=Df.get(t);function r(l,a){e.set(l,a)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s}}const Pg=new WeakMap,{register:pW,getItem:IT,hasItem:wW,getNames:f6,getValues:m6}=sl("editors");function vW(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},vr.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function yW(t,e){let r;if(typeof t=="function")Pg.get(t)||HT(null,t),r=Pg.get(t);else if(typeof t=="string")r=IT(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function Ag(t){if(typeof t=="function")return t;if(!wW(t))throw Error(`No registered editor found under "${t}" name`);return IT(t).getConstructor()}function HT(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new vW(e);typeof t=="string"&&pW(t,r),Pg.set(e,r)}function CW(t,e,r){return e=SW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SW(t){var e=RW(t,"string");return typeof e=="symbol"?e:e+""}function RW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;CW(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,EW(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function EW(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ah(this)},t}function bW(t,e){TW(t,e),e.add(t)}function TW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _i(t,e,r){return e=_W(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _W(t){var e=OW(t,"string");return typeof e=="symbol"?e:e+""}function OW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $w="editorManager.navigation";var kf=new WeakSet;class Ng{constructor(e,r,n){bW(this,kf),_i(this,"hot",void 0),_i(this,"tableMeta",void 0),_i(this,"selection",void 0),_i(this,"eventManager",void 0),_i(this,"destroyed",!1),_i(this,"lock",!1),_i(this,"activeEditor",void 0),_i(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Qs(e),this.hot.addHook("afterDocumentKeyDown",i=>aS(kf,this,xW).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>aS(kf,this,MW).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i);let s=n,l=i;if(Array.isArray(o)&&([s,l]=o),this.cellProperties=this.hot.getCellMeta(s,l),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,i,!0);if(a){const u=this.hot.getCellEditor(this.cellProperties),d=this.hot.colToProp(l),f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),l);this.activeEditor=yW(u,this.hot),this.activeEditor.prepare(n,i,d,a,f,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,l=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||l)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function xW(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||bo(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!sW(r)&&!lW(r)&&!n&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>Se(this.hot.getSelected()),group:$w};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function MW(t,e){e.isCell()&&this.openEditor(null,t,!0)}const uS=new WeakMap;Ng.getInstance=function(t,e,r){let n=uS.get(t);return n||(n=new Ng(t,e,r),uS.set(t,n)),n};function IW(t,e){PT(t,e),e.add(t)}function Sl(t,e,r){PT(t,e),e.set(t,r)}function PT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(li(t,e))}function Rl(t,e,r){return t.set(li(t,e),r),r}function li(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Wi=Object.freeze({CELL:"cell",MIXED:"mixed"});var xt=new WeakMap,Hu=new WeakMap,Pu=new WeakMap,Au=new WeakMap,Nu=new WeakMap,Pi=new WeakSet;class HW{constructor(e){var r=this;IW(this,Pi),Sl(this,xt,void 0),Sl(this,Hu,void 0),Sl(this,Pu,50),Sl(this,Au,null),Sl(this,Nu,new Map);const n=e.getSettings();Rl(xt,this,e),Rl(Hu,this,n.imeFastEdit?Wi.MIXED:Wi.CELL),qe(xt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return li(Pi,r,AW).call(r,...o)}),qe(xt,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return li(Pi,r,cS).call(r,...o)}),qe(xt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return li(Pi,r,cS).call(r,...o)}),qe(xt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return li(Pi,r,PW).call(r,...o)})}getFocusMode(){return qe(Hu,this)}setFocusMode(e){Object.values(Wi).includes(e)?Rl(Hu,this,e):Xs(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return qe(Pu,this)}setRefocusDelay(e){Rl(Pu,this,e)}setRefocusElementGetter(e){Rl(Au,this,e)}getRefocusElement(){if(typeof qe(Au,this)=="function")return qe(Au,this).call(this);var e;return(e=qe(xt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=qe(xt,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let l=qe(xt,this).runHooks("modifyFocusedElement",s.row,s.col,n);l instanceof HTMLElement||(l=n),l&&!((o=qe(xt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&l.focus({preventScroll:!0})};e?r(e):li(Pi,this,Vw).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qe(Pu,this);const n=this.getRefocusElement();qe(xt,this).getSettings().imeFastEdit&&!((e=qe(xt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&n&&(qe(Nu,this).has(r)||qe(Nu,this).set(r,IV(()=>{n.select()},r)),qe(Nu,this).get(r)())}}function Vw(t){var e;const r=(e=qe(xt,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!qe(xt,this).selection.isCellVisible(r)){t(null);return}const n=qe(xt,this).getCell(r.row,r.col,!0);n===null?qe(xt,this).addHookOnce("afterScroll",()=>{t(qe(xt,this).getCell(r.row,r.col,!0))}):t(n)}function cS(){li(Pi,this,Vw).call(this,t=>{const{activeElement:e}=qe(xt,this).rootDocument;e&&ST(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function PW(){li(Pi,this,Vw).call(this,t=>{this.getFocusMode()===Wi.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function AW(t){t.imeFastEdit&&this.getFocusMode()!==Wi.MIXED?this.setFocusMode(Wi.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Wi.CELL&&this.setFocusMode(Wi.CELL)}var NW=Yn,DW=jo,kW=nl,LW=kW("match"),FW=function(t){var e;return NW(t)&&((e=t[LW])!==void 0?!!e:DW(t)==="RegExp")},$W=Ba,VW=function(){var t=$W(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},WW=rl,BW=Gn,zW=Kp,jW=VW,dS=RegExp.prototype,UW=function(t){var e=t.flags;return e===void 0&&!("flags"in dS)&&!BW(t,"flags")&&zW(dS,t)?WW(jW,t):e},Ww=$t,YW=zd,GW=Math.floor,Lf=Ww("".charAt),KW=Ww("".replace),Ff=Ww("".slice),XW=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,QW=/\$([$&'`]|\d{1,2})/g,qW=function(t,e,r,n,i,o){var s=r+t.length,l=n.length,a=QW;return i!==void 0&&(i=YW(i),a=XW),KW(o,a,function(u,d){var f;switch(Lf(d,0)){case"$":return"$";case"&":return t;case"`":return Ff(e,0,r);case"'":return Ff(e,s);case"<":f=i[Ff(d,1,-1)];break;default:var m=+d;if(m===0)return u;if(m>l){var p=GW(m/10);return p===0?u:p<=l?n[p-1]===void 0?Lf(d,1):n[p-1]+Lf(d,1):u}f=n[m-1]}return f===void 0?"":f})},ZW=Yo,JW=rl,Bw=$t,hS=Wd,eB=Vt,tB=Gp,rB=FW,El=aw,nB=LE,iB=UW,oB=qW,sB=nl,lB=sB("replace"),aB=TypeError,$f=Bw("".indexOf);Bw("".replace);var fS=Bw("".slice),uB=Math.max;ZW({target:"String",proto:!0},{replaceAll:function(e,r){var n=hS(this),i,o,s,l,a,u,d,f,m,p=0,C=0,S="";if(!tB(e)){if(i=rB(e),i&&(o=El(hS(iB(e))),!~$f(o,"g")))throw new aB("`.replaceAll` does not allow non-global regexes");if(s=nB(e,lB),s)return JW(s,e,n,r)}for(l=El(n),a=El(e),u=eB(r),u||(r=El(r)),d=a.length,f=uB(1,d),p=$f(l,a);p!==-1;)m=u?El(r(a,p,l)):oB(a,l,p,[],void 0,r),S+=fS(l,C,p)+m,C=p+d,p=p+f>l.length?-1:$f(l,a,p+f);return C<l.length&&(S+=fS(l,C)),S}});const cB={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"};new RegExp(Object.keys(cB).map(t=>`(${t})`).join("|"),"gi");function mS(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],d=r?1:0,f=e?1:0;for(let m=0;m<o;m+=1){const p=e&&m===0,C=[];for(let H=0;H<s;H+=1){const w=!p&&r&&H===0;let v="";if(p)v=`<th>${t.getColHeader(H-d)}</th>`;else if(w)v=`<th>${t.getRowHeader(m-f)}</th>`;else{const E=i[m][H],{hidden:x,rowspan:$,colspan:k}=t.getCellMeta(m-f,H-d);if(!x){const P=[];if($&&P.push(`rowspan="${$}"`),k&&P.push(`colspan="${k}"`),Us(E))v=`<td ${P.join(" ")}></td>`;else{const y=E.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${P.join(" ")}>${y}</td>`}}}C.push(v)}const S=["<tr>",...C,"</tr>"].join("");p?a.splice(1,0,S):u.splice(-1,0,S)}return l.splice(1,0,a.join(""),u.join("")),l.join("")}function AT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function dB(t){return AT(t,[","])}function qr(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function gS(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function In(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const Dg="asc",hB="desc",pS=new Map([[Dg,[-1,1]],[hB,[1,-1]]]),fB=t=>`The priority '${t}' is already declared in a map.`,mB=t=>`The priority '${t}' is not a number.`;function gB(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Je(t)?t:fB,e=Je(e)?e:mB;function n(o,s){if(!AT(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dg;const[s,l]=pS.get(o)||pS.get(Dg);return[...r].sort((a,u)=>a[0]<u[0]?s:l).map(a=>a[1])}return{addItem:n,getItems:i}}const pB=t=>`The id '${t}' is already declared in a map.`;function uh(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Je(t)?t:pB;function r(u,d){if(a(u))throw new Error(t(u));e.set(u,d)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[d]=l().find(f=>{let[m,p]=f;return u===p?m:!1})||[null];return d}function s(u){return e.get(u)}function l(){return[...e]}function a(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:l,hasItem:a,removeItem:n}}const wB=t=>`'${t}' value is already declared in a unique set.`;function vB(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Je(t)?t:wB;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const NT=t=>`There is already registered "${t}" plugin.`,yB=t=>`There is already registered plugin on priority "${t}".`,CB=t=>`The priority "${t}" is not a number.`,SB=gB({errorPriorityExists:yB,errorPriorityNaN:CB}),RB=vB({errorItemExists:NT}),EB=uh({errorIdExists:NT});function bB(){return[...SB.getItems(),...RB.getItems()]}function TB(t){const e=Aw(t);return EB.getItem(e)}const{register:_B,getItem:OB,hasItem:xB,getNames:g6,getValues:p6}=sl("renderers");function kg(t){if(typeof t=="function")return t;if(!xB(t))throw Error(`No registered renderer found under "${t}" name`);return OB(t)}function MB(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),_B(t,e)}const{register:IB,getItem:HB,hasItem:PB,getNames:w6,getValues:v6}=sl("validators");function AB(t){if(typeof t=="function")return t;if(!PB(t))throw Error(`No registered validator found under "${t}" name`);return HB(t)}function NB(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),IB(t,e)}function Du(t,e,r){return e=DB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DB(t){var e=kB(t,"string");return typeof e=="symbol"?e:e+""}function kB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LB{constructor(e){Du(this,"count",0),Du(this,"startColumn",0),Du(this,"endColumn",0),Du(this,"startPosition",0),this.count=e.totalColumns,this.endColumn=this.count-1}}function ku(t,e,r){return e=FB(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FB(t){var e=$B(t,"string");return typeof e=="symbol"?e:e+""}function $B(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VB{constructor(e){ku(this,"count",0),ku(this,"startRow",0),ku(this,"endRow",0),ku(this,"startPosition",0),this.count=e.totalRows,this.endRow=this.count-1}}var DT={},WB=QE,BB=lw,zB=Object.keys||function(e){return WB(e,BB)},jB=Un,UB=zE,YB=Uo,GB=Ba,KB=Bd,XB=zB;DT.f=jB&&!UB?Object.defineProperties:function(e,r){GB(e);for(var n=KB(r),i=XB(r),o=i.length,s=0,l;o>s;)YB.f(e,l=i[s++],n[l]);return e};var QB=Ba,qB=DT,wS=lw,ZB=nw,JB=lb,e2=tw,t2=YE,vS=">",yS="<",Lg="prototype",Fg="script",kT=t2("IE_PROTO"),Vf=function(){},LT=function(t){return yS+Fg+vS+t+yS+"/"+Fg+vS},CS=function(t){t.write(LT("")),t.close();var e=t.parentWindow.Object;return t=null,e},r2=function(){var t=e2("iframe"),e="java"+Fg+":",r;return t.style.display="none",JB.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(LT("document.F=Object")),r.close(),r.F},Lu,Oc=function(){try{Lu=new ActiveXObject("htmlfile")}catch{}Oc=typeof document<"u"?document.domain&&Lu?CS(Lu):r2():CS(Lu);for(var t=wS.length;t--;)delete Oc[Lg][wS[t]];return Oc()};ZB[kT]=!0;var n2=Object.create||function(e,r){var n;return e!==null?(Vf[Lg]=QB(e),n=new Vf,Vf[Lg]=null,n[kT]=e):n=Oc(),r===void 0?n:qB.f(n,r)},i2=nl,o2=n2,s2=Uo.f,$g=i2("unscopables"),Vg=Array.prototype;Vg[$g]===void 0&&s2(Vg,$g,{configurable:!0,value:o2(null)});var FT=function(t){Vg[$g][t]=!0},l2=Yo,a2=zd,u2=sw,c2=ow,d2=FT;l2({target:"Array",proto:!0},{at:function(e){var r=a2(this),n=u2(r),i=c2(e),o=i>=0?i:n+i;return o<0||o>=n?void 0:r[o]}});d2("at");const Ai=1,Gt=2,SS=3;function h2(t,e,r){f2(t,e),e.set(t,r)}function f2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bl(t,e,r){return e=m2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m2(t){var e=g2(t,"string");return typeof e=="symbol"?e:e+""}function g2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ns(t,e){return t.get($T(t,e))}function p2(t,e,r){return t.set($T(t,e),r),r}function $T(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oi=new WeakMap;class ch{static get DEFAULT_WIDTH(){return 50}constructor(e){bl(this,"count",0),bl(this,"startColumn",null),bl(this,"endColumn",null),bl(this,"startPosition",null),bl(this,"isVisibleInTrimmingContainer",!1),h2(this,Oi,void 0),p2(Oi,this,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:r,scrollOffset:n,totalColumns:i,viewportWidth:o}=ns(Oi,this),s=Math.max(ns(Oi,this).scrollOffset,0),l=s>0?o+1:o;let a=0,u=!0;const d=[];let f,m=0,p=0;for(let w=0;w<i;w++)if(f=this._getColumnWidth(w),a<=s&&e!==Gt&&(this.startColumn=w,m=f),a>=s&&a+(e===Gt?f:0)<=s+l&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=w,m=f),this.endColumn=w),d.push(a),a+=f,p=f,e!==Gt&&(this.endColumn=w),a>=s+o){u=!1;break}const C=n+o-l,S=e===Gt?0:p,H=e===Gt?m:0;if(C<-1*ns(Oi,this).inlineStartOffset||n>d.at(-1)+S||-1*ns(Oi,this).scrollOffset-ns(Oi,this).viewportWidth>-1*H?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=d[this.endColumn]+f-d[this.startColumn-1];if((w<=o||e!==Gt)&&(this.startColumn-=1),w>o)break}e===Ai&&this.startColumn!==null&&r&&r(this),this.startPosition=d[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(e){let r=ns(Oi,this).columnWidthFn(e);return isNaN(r)&&(r=ch.DEFAULT_WIDTH),r}}function w2(t,e,r){v2(t,e),e.set(t,r)}function v2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tl(t,e,r){return e=y2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y2(t){var e=C2(t,"string");return typeof e=="symbol"?e:e+""}function C2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wf(t,e){return t.get(VT(t,e))}function S2(t,e,r){return t.set(VT(t,e),r),r}function VT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _l=new WeakMap;class zw{static get DEFAULT_HEIGHT(){return 23}constructor(e){Tl(this,"count",0),Tl(this,"startRow",null),Tl(this,"endRow",null),Tl(this,"startPosition",null),Tl(this,"isVisibleInTrimmingContainer",!1),w2(this,_l,void 0),S2(_l,this,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:r,rowHeightFn:n,scrollOffset:i,totalRows:o,viewportHeight:s}=Wf(_l,this),l=Math.max(Wf(_l,this).scrollOffset,0),a=Wf(_l,this).horizontalScrollbarHeight||0;let u=0,d=!0;const f=[];let m,p=0,C=0;for(let v=0;v<o;v++)if(m=n(v),isNaN(m)&&(m=zw.DEFAULT_HEIGHT),u<=l&&e!==Gt&&(this.startRow=v,p=m),u>=l&&u+(e===Gt?m:0)<=l+s-a&&(this.startRow===null&&(this.startRow=v,p=m),this.endRow=v),f.push(u),u+=m,C=m,e!==Gt&&(this.endRow=v),u>=l+s-a){d=!1;break}const S=i+s-a,H=e===Gt?p:0,w=e===Gt?0:C;if(S<H||i>f.at(-1)+w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&d)for(this.startRow=this.endRow;this.startRow>0;){const v=f[this.endRow]+m-f[this.startRow-1];if((v<=s-a||e!==Gt)&&(this.startRow-=1),v>=s-a)break}e===Ai&&this.startRow!==null&&r&&r(this),this.startPosition=f[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function R2(t,e,r){E2(t,e),e.set(t,r)}function E2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RS(t,e,r){return e=b2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b2(t){var e=T2(t,"string");return typeof e=="symbol"?e:e+""}function T2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function is(t,e){return t.get(WT(t,e))}function ES(t,e,r){return t.set(WT(t,e),r),r}function WT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Jn=new WeakMap;class Fo{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;RS(this,"row",null),RS(this,"col",null),R2(this,Jn,!1),ES(Jn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return is(Jn,this)}isSouthEastOf(e){return this.row>=e.row&&(is(Jn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(is(Jn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(is(Jn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(is(Jn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Fo&&ES(Jn,this,e.isRtl()),this}clone(){return new Fo(this.row,this.col,is(Jn,this))}toObject(){return{row:this.row,col:this.col}}}function _2(t,e,r){O2(t,e),e.set(t,r)}function O2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bf(t,e,r){return e=x2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x2(t){var e=M2(t,"string");return typeof e=="symbol"?e:e+""}function M2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Br(t,e){return t.get(BT(t,e))}function I2(t,e,r){return t.set(BT(t,e),r),r}function BT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hr=new WeakMap;class Za{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Bf(this,"highlight",null),Bf(this,"from",null),Bf(this,"to",null),_2(this,hr,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),I2(hr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),a=Math.min(n.row,s.row),u=Math.min(n.col,s.col),d=Math.max(i.row,l.row),f=Math.max(i.col,l.col),m=this._createCellCoords(a,u),p=this._createCellCoords(d,f);return this.from=m,this.to=p,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Br(hr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Br(hr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Br(hr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Br(hr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Br(hr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Br(hr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Br(hr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Br(hr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Fo))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Br(hr,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Br(hr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new Za(this.highlight,this.from,this.to,Br(hr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Fo(e,r,Br(hr,this))}}function Hn(t,e,r){H2(t,e),e.set(t,r)}function H2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function te(t,e){return t.get(zT(t,e))}function xi(t,e,r){return t.set(zT(t,e),r),r}function zT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zr=new WeakMap,zf=new WeakMap,Tt=new WeakMap,os=new WeakMap,Fu=new WeakMap,cn=new WeakMap,jf=new WeakMap,Ol=new WeakMap,mo=new WeakMap,Pn=new WeakMap;class jT{constructor(e,r,n,i,o,s){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Hn(this,zr,void 0),Hn(this,zf,void 0),Hn(this,Tt,void 0),Hn(this,os,void 0),Hn(this,Fu,void 0),Hn(this,cn,void 0),Hn(this,jf,void 0),Hn(this,Ol,void 0),Hn(this,mo,[null,null]),Hn(this,Pn,[null,null]),xi(zr,this,n),xi(zf,this,r),xi(Tt,this,o),xi(os,this,s),xi(Fu,this,l),xi(cn,this,i),xi(jf,this,e),this.registerEvents()}registerEvents(){te(cn,this).addEventListener(te(Tt,this).holder,"contextmenu",n=>this.onContextMenu(n)),te(cn,this).addEventListener(te(Tt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),te(cn,this).addEventListener(te(Tt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{te(cn,this).addEventListener(te(Tt,this).holder,"touchstart",n=>this.onTouchStart(n)),te(cn,this).addEventListener(te(Tt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),te(cn,this).addEventListener(te(Tt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||te(zr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,te(zr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{te(cn,this).addEventListener(te(Tt,this).holder,"mouseup",n=>this.onMouseUp(n)),te(cn,this).addEventListener(te(Tt,this).holder,"mousedown",n=>this.onMouseDown(n))};Os()?e():(QV()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(te(Ol,this)&&n){const[i,o]=[n.row,te(Ol,this).from.row],[s,l]=[n.col,te(Ol,this).from.col];return i===o&&s===l}return!1}parentCell(e){const r={},n=te(Tt,this).TABLE,i=Mu(e,["TD","TH"],n);return i?(r.coords=te(Tt,this).getCoords(i),r.TD=i):ot(e,"wtBorder")&&ot(e,"current")?(r.coords=te(os,this).getFocusSelection().cellRange.highlight,r.TD=te(Tt,this).getCell(r.coords)):ot(e,"wtBorder")&&ot(e,"area")&&te(os,this).getAreaSelection().cellRange&&(r.coords=te(os,this).getAreaSelection().cellRange.to,r.TD=te(Tt,this).getCell(r.coords)),r}onMouseDown(e){const r=te(zf,this).rootDocument.activeElement,n=HV(wV,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);ot(i,"corner")?te(zr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&te(zr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(te(Pn,this)[0]=o.TD,clearTimeout(te(mo,this)[0]),te(mo,this)[0]=setTimeout(()=>{te(Pn,this)[0]=null},1e3))}onContextMenu(e){if(te(zr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!te(zr,this).has("onCellMouseOver"))return;const r=te(Tt,this).TABLE,n=Mu(e.target,["TD","TH"],r),i=te(Fu,this)||this;n&&n!==i.lastMouseOver&&xg(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,te(Tt,this).getCoords(n),n))}onMouseOut(e){if(!te(zr,this).has("onCellMouseOut"))return;const r=te(Tt,this).TABLE,n=Mu(e.target,["TD","TH"],r),i=Mu(e.relatedTarget,["TD","TH"],r),o=te(Fu,this)||this;n&&n!==i&&xg(n,r)&&(this.callListener("onCellMouseOut",e,te(Tt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&te(zr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===te(Pn,this)[0]&&r.TD===te(Pn,this)[1]?(ot(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),te(Pn,this)[0]=null,te(Pn,this)[1]=null):r.TD===te(Pn,this)[0]&&(te(Pn,this)[1]=r.TD,clearTimeout(te(mo,this)[1]),te(mo,this)[1]=setTimeout(()=>{te(Pn,this)[1]=null},500)))}onTouchStart(e){xi(Ol,this,te(os,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=Se(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&te(zr,this).getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];xT()&&(tW()||rW())&&this.selectedCellWasTouched(n)&&!l.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=te(zr,this).getSettingPure(e);o&&o(r,n,i,te(jf,this).call(this))}destroy(){clearTimeout(te(mo,this)[0]),clearTimeout(te(mo,this)[1]),te(cn,this).destroy()}}function Uf(t,e,r){return e=P2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P2(t){var e=A2(t,"string");return typeof e=="symbol"?e:e+""}function A2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N2{constructor(e,r,n){Uf(this,"offset",void 0),Uf(this,"total",void 0),Uf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Yf(t,e,r){return e=D2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D2(t){var e=k2(t,"string");return typeof e=="symbol"?e:e+""}function k2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L2{constructor(e,r,n){Yf(this,"offset",void 0),Yf(this,"total",void 0),Yf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const F2=0,vd=1,yd=2;function $u(t,e,r){return e=$2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $2(t){var e=V2(t,"string");return typeof e=="symbol"?e:e+""}function V2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bS{constructor(){$u(this,"currentSize",0),$u(this,"nextSize",0),$u(this,"currentOffset",0),$u(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Gf(t,e,r){return e=W2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W2(t){var e=B2(t,"string");return typeof e=="symbol"?e:e+""}function B2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z2{constructor(){Gf(this,"size",new bS),Gf(this,"workingSpace",F2),Gf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof bS}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=vd,e.workingSpace=yd,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=yd,e.workingSpace=vd,this.sharedSize=e.getViewSize()}}function ss(t,e,r){return e=j2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j2(t){var e=U2(t,"string");return typeof e=="symbol"?e:e+""}function U2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UT{constructor(e,r,n){ss(this,"rootNode",void 0),ss(this,"nodesPool",void 0),ss(this,"sizeSet",new z2),ss(this,"childNodeType",void 0),ss(this,"visualIndex",0),ss(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=r,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:r}=this;let n=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(vd))break;i=i.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:r}=this,n=this.isSharedViewSet(),{nextSize:i}=r.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const l=this.nodesPool();!n||n&&r.isPlaceOn(yd)?e.appendChild(l):e.insertBefore(l,e.firstChild),o+=1}const s=n&&r.isPlaceOn(vd);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:r}=this;let n=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(yd)&&(n+=r.sharedSize.nextSize);let i=e.childNodes[n];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class YT extends UT{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Y2(t,e,r){return e=G2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G2(t){var e=K2(t,"string");return typeof e=="symbol"?e:e+""}function K2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X2{constructor(e){Y2(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function xl(t,e,r){return e=Q2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q2(t){var e=q2(t,"string");return typeof e=="symbol"?e:e+""}function q2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ja{constructor(e,r){xl(this,"nodesPool",null),xl(this,"nodeType",void 0),xl(this,"rootNode",void 0),xl(this,"table",null),xl(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new X2(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function TS(t,e,r){return e=Z2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z2(t){var e=J2(t,"string");return typeof e=="symbol"?e:e+""}function J2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ez extends Ja{constructor(){super("TH"),TS(this,"orderViews",new WeakMap),TS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new YT(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const l=this.table.renderedRowToSource(s),a=i.getRenderedNode(s);this.sourceRowIndex=l;const u=this.obtainOrderView(a),d=o.obtainOrderView(a);u.appendView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){u.render();const m=u.getCurrentNode();m.className="",m.removeAttribute("style"),Xa(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&rt(m,[hV(),gV(),Nw(f+1),ih(-1)]),r[f](l,m,f)}u.end()}}}class tz extends Ja{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let l=0,a=e;l<a;l++){for(n=this.rootNode.childNodes[l],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let l=e;l<s;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ys(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&rt(this.rootNode,[aT()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&rt(s,[Og(),dT(r+1)]);for(let l=-1*o;l<i;l+=1){const a=this.table.renderedColumnToSource(l),u=s.childNodes[l+o];u.className="",u.removeAttribute("style"),Xa(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&rt(u,[Nw(l+1+this.table.rowHeadersCount),ih(-1),fV(),...l>=0?[mV()]:[Og()]]),n[r](a,u,r)}}}}let _S=!1;class rz extends Ja{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!_S&&e>1e3&&(_S=!0,Xs(Ar`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&Ne(n,"rowHeader")}}function nz(t,e,r){return e=iz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iz(t){var e=oz(t,"string");return typeof e=="symbol"?e:e+""}function oz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let OS=!1;class sz extends Ja{constructor(e){super("TR",e),nz(this,"orderView",void 0),this.orderView=new UT(e,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!OS&&e>1e3&&(OS=!0,Xs(Ar`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&rt(this.rootNode,[aT()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;rt(o,[Og(),dT(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}}this.orderView.end()}}function xS(t,e,r){return e=lz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lz(t){var e=az(t,"string");return typeof e=="symbol"?e:e+""}function az(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uz extends Ja{constructor(){super("TD"),xS(this,"orderViews",new WeakMap),xS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new YT(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let l=0;l<e;l++){const a=this.table.renderedRowToSource(l),u=n.getRenderedNode(l);this.sourceRowIndex=a;const d=this.obtainOrderView(u),f=i.obtainOrderView(u);d.prependView(f).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let m=0;m<r;m++){d.render();const p=d.getCurrentNode(),C=this.table.renderedColumnToSource(m);if(ot(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),Xa(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(a,C,p),this.table.isAriaEnabled()){var o,s;rt(p,[...p.hasAttribute("role")?[]:[dV()],ih(-1),Nw(C+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}d.end()}}}function _t(t,e,r){return e=cz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cz(t){var e=dz(t,"string");return typeof e=="symbol"?e:e+""}function dz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hz{constructor(e){let{cellRenderer:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_t(this,"rootNode",void 0),_t(this,"rootDocument",void 0),_t(this,"rowHeaders",null),_t(this,"columnHeaders",null),_t(this,"colGroup",null),_t(this,"rows",null),_t(this,"cells",null),_t(this,"rowFilter",null),_t(this,"columnFilter",null),_t(this,"rowUtils",null),_t(this,"columnUtils",null),_t(this,"rowsToRender",0),_t(this,"columnsToRender",0),_t(this,"rowHeaderFunctions",[]),_t(this,"rowHeadersCount",0),_t(this,"columnHeaderFunctions",[]),_t(this,"columnHeadersCount",0),_t(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n);if(i.firstChild){const o=this.renderedRowToSource(n),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class fz{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new hz(e,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new ez,columnHeaders:new tz(r),colGroup:new rz(n),rows:new sz(i),cells:new uz}),this.renderer.setAxisUtils(o,s)}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Ml(t,e,r){mz(t,e),e.set(t,r)}function mz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vu(t,e,r){return e=gz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gz(t){var e=pz(t,"string");return typeof e=="symbol"?e:e+""}function pz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jt(t,e){return t.get(GT(t,e))}function Il(t,e,r){return t.set(GT(t,e),r),r}function GT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Wu=new WeakMap,ls=new WeakMap,Hl=new WeakMap,Bu=new WeakMap,go=new WeakMap;class jw{static get DEFAULT_WIDTH(){return 50}constructor(e){let{totalColumns:r,stretchMode:n,stretchingColumnWidthFn:i,columnWidthFn:o}=e;Vu(this,"stretchAllRatio",0),Vu(this,"stretchLastWidth",0),Vu(this,"stretchAllColumnsWidth",[]),Ml(this,Wu,0),Vu(this,"needVerifyLastColumnWidth",!0),Ml(this,ls,()=>0),Ml(this,Hl,s=>s),Ml(this,Bu,s=>s),Ml(this,go,()=>"none"),Il(ls,this,r),Il(go,this,n),Il(Hl,this,i??jt(Hl,this)),Il(Bu,this,o??jt(Bu,this))}refreshStretching(e){if(jt(go,this).call(this)==="none")return;Il(Wu,this,e);let r=0;for(let i=0;i<jt(ls,this).call(this);i++){const o=this._getColumnWidth(i),s=jt(Hl,this).call(this,void 0,i);typeof s=="number"?e-=s:r+=o}const n=e-r;if(jt(go,this).call(this)==="all"&&n>0)this.stretchAllRatio=e/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(jt(go,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(jt(ls,this).call(this)-1),o=n+i;this.stretchLastWidth=o>=0?o:i}}getStretchedColumnWidth(e,r){let n=null;return jt(go,this).call(this)==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(e,r):jt(go,this).call(this)==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,r){let n=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(r*this.stretchAllRatio),o=jt(Hl,this).call(this,i,e);o===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===jt(ls,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==jt(Wu,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=jt(Wu,this)-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===jt(ls,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let r=jt(Bu,this).call(this,e);return isNaN(r)&&(r=jw.DEFAULT_WIDTH),r}}function zu(t,e,r){return e=wz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wz(t){var e=vz(t,"string");return typeof e=="symbol"?e:e+""}function vz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yz{constructor(e,r){zu(this,"dataAccessObject",void 0),zu(this,"wtSettings",void 0),zu(this,"headerWidths",new Map),zu(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=r,this.stretching=new jw({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(n,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",n,i),columnWidthFn:n=>this.dataAccessObject.wtTable.getColumnWidth(n)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let r=this.getWidth(e);const n=this.stretching.getStretchedColumnWidth(e,r);return n&&(r=n),r}getHeaderHeight(e){let r=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:r,cloneSource:n}=this.dataAccessObject,i=n?n.wtTable.holder:e.holder,o=i.offsetHeight<i.scrollHeight?nr():0;this.stretching.refreshStretching(r.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function MS(t,e,r){return e=Cz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cz(t){var e=Sz(t,"string");return typeof e=="symbol"?e:e+""}function Sz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rz{constructor(e,r){MS(this,"dataAccessObject",void 0),MS(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}}function An(t,e,r){return e=Ez(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ez(t){var e=bz(t,"string");return typeof e=="symbol"?e:e+""}function bz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ll{constructor(e,r,n,i,o){An(this,"wtSettings",null),An(this,"domBindings",void 0),An(this,"TBODY",null),An(this,"THEAD",null),An(this,"COLGROUP",null),An(this,"hasTableHeight",!0),An(this,"hasTableWidth",!0),An(this,"isTableVisible",!1),An(this,"tableOffset",0),An(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,pT(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Rz(this.dataAccessObject,this.wtSettings),this.columnUtils=new yz(this.dataAccessObject,this.wtSettings),this.tableRenderer=new fz({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ot(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&rt(n,[hi()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ot(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&rt(n,[hi()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ot(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&rt(n.parentNode,[hi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&rt(n,[hi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),l=r.getSetting("rowHeaders"),a=l.length,u=r.getSetting("columnHeaders"),d=u.length;let f=!1,m=e;if(this.isMaster&&(this.holderOffset=Qr(this.holder),m=i.createRenderCalculators(m),a&&!r.getSetting("fixedColumnsStart"))){const C=n.inlineStartOverlay.getScrollPosition(),S=this.correctHeaderWidth;this.correctHeaderWidth=C!==0,S!==this.correctHeaderWidth&&(m=!1)}if(this.isMaster&&(f=n.updateStateOfRendering()),m)this.isMaster&&(i.createVisibleCalculators(),i.createPartiallyVisibleCalculators()),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=Qr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const C=o>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new L2(C,o,d),this.columnFilter=new N2(S,s,a);let H=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const w={};this.wtSettings.getSetting("beforeDraw",!0,w),H=w.skipRender!==!0}if(H){this.tableRenderer.setHeaderContentRenderers(l,u),(this.is($n)||this.is(Zi))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let w;if(this.isMaster&&(w=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($n))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtViewport.createPartiallyVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const v=It(this.hider),E=It(this.TABLE);v!==0&&E!==v&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),w!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is($n)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let p=!1;return this.isMaster&&(p=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(p=n.bottomOverlay.resetFixedPosition()||p),p=n.inlineStartOverlay.resetFixedPosition()||p,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(m),f&&n.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,l;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(l=_s(s),(!o&&i<l||o<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),Array.isArray(a)?a[n]!==null&&a[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(a[n]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is($n))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n);if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,l=(i<0?this.THEAD:this.TBODY).childNodes[o];return l==null?void 0:l.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=fT(r,["TD","TH"])),r===null)return null;const n=r.parentNode,i=n.parentNode;let o=CV(n),s=r.cellIndex;return fo(Wo,r,this.wtRootElement)||fo($o,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):fo(Zi,r,this.wtRootElement)||fo($n,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),fo(Wo,r,this.wtRootElement)||fo(Vo,r,this.wtRootElement)||fo(Zi,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.wtSettings.getSetting("defaultRowHeight"),n=_s(this.TBODY)-1;let i,o,s,l,a;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),l=this.getTrForRow(s),a=l.querySelector("th"),a?o=_s(a):o=_s(l)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return It(this.TABLE)}getHeight(){return en(this.TABLE)}getTotalWidth(){const e=It(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=en(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Ia(this.TABLE)}_modifyRowHeaderWidth(e){let r=Je(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const Tz="stickyRowsBottom",Uw={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};so(Uw,"MIXIN_NAME",Tz,{writable:!1,enumerable:!1});const _z="stickyColumnsStart",dh={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};so(dh,"MIXIN_NAME",_z,{writable:!1,enumerable:!1});class Yw extends ll{constructor(e,r,n,i){super(e,r,n,i,Zi)}}mt(Yw,Uw);mt(Yw,dh);const $o="top",$n="bottom",Vo="inline_start",Wo="top_inline_start_corner",Zi="bottom_inline_start_corner",Oz=[$o,$n,Vo,Wo,Zi],xz=new Map([[$o,`ht_clone_${$o}`],[$n,`ht_clone_${$n}`],[Vo,`ht_clone_${Vo} ht_clone_left`],[Wo,`ht_clone_${Wo} ht_clone_top_left_corner`],[Zi,`ht_clone_${Zi} ht_clone_bottom_left_corner`]]);function Mz(t,e){Iz(t,e),e.add(t)}function Iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hz(t,e,r){return e=Pz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pz(t){var e=Az(t,"string");return typeof e=="symbol"?e:e+""}function Az(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ju(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pl=new WeakSet;class Nz{constructor(e){Mz(this,Pl),Hz(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n,i,o){const s=this.scrollViewportHorizontally(e.col,n,o),l=this.scrollViewportVertically(e.row,r,i);return s||l}scrollViewportHorizontally(e,r,n){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=r===void 0&&n===void 0,{fixedColumnsStart:l,inlineStartOverlay:a}=this.dataAccessObject;if(s&&e<l||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>o))return!1;const u=this.getFirstVisibleColumn(),d=this.getLastVisibleColumn();let f=!1;return(s&&(e<u||e>d)||!s)&&(f=a.scrollTo(e,s?e>=this.getLastPartiallyVisibleColumn():r)),f}scrollViewportVertically(e,r,n){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=r===void 0&&n===void 0,{fixedRowsBottom:l,fixedRowsTop:a,topOverlay:u}=this.dataAccessObject;if(s&&(e<a||e>o-l-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>o))return!1;const d=this.getFirstVisibleRow(),f=this.getLastVisibleRow();let m=!1;return(s&&(e<d||e>f)||!s)&&(m=u.scrollTo(e,s?e>=this.getLastPartiallyVisibleRow():n)),m}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return ju(Pl,this,HS).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return ju(Pl,this,HS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return ju(Pl,this,IS).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return ju(Pl,this,IS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function IS(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let a=null;if(l){const d=n.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;a=Math.abs(d.right-m)}else a=Qr(n.wtRootElement).left;const u=Math.abs(vT(s,s));if(a>u){const d=yT(s);let f=i.getRowHeaderWidth();for(let m=1;m<=o;m++)if(f+=r.sumCellSizes(m-1,m),a+f-u>=d){t=m-2;break}}}return t}function HS(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Qr(r.wtRootElement),l=kw(o,o);if(s.top>l){const a=_s(o);let u=n.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(u+=e.sumCellSizes(d-1,d),s.top+u-l>=a){t=d-2;break}}}return t}function dn(t,e,r){return e=Dz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dz(t){var e=kz(t,"string");return typeof e=="symbol"?e:e+""}function kz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gw{get eventManager(){return new Qs(this)}constructor(e,r){dn(this,"wtTable",void 0),dn(this,"wtScroll",void 0),dn(this,"wtViewport",void 0),dn(this,"wtOverlays",void 0),dn(this,"selectionManager",void 0),dn(this,"wtEvent",void 0),dn(this,"guid",`wt_${lT()}`),dn(this,"drawInterrupted",!1),dn(this,"drawn",!1),dn(this,"domBindings",void 0),dn(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Nz(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Qa(n,e[r])}])}}createCellCoords(e,r){return new Fo(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new Za(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,r,n,i,o)}scrollViewportHorizontally(e,r,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,r,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function PS(t,e,r){return e=Lz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lz(t){var e=Fz(t,"string");return typeof e=="symbol"?e:e+""}function Fz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $z extends Gw{constructor(e,r,n){super(e,r),PS(this,"cloneSource",void 0),PS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new jT(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function Vz(t,e,r){return e=Wz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wz(t){var e=Bz(t,"string");return typeof e=="symbol"?e:e+""}function Bz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eu{constructor(e,r,n,i,o){Vz(this,"wtSettings",null),so(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:l,spreader:a,holder:u,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=a,this.holder=u,this.wtRootElement=d,this.trimmingContainer=wd(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const r=e!==this.needFullRender;return r&&!this.needFullRender&&this.reset(),r}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=wd(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=pd(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Xs(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),l=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(a),top:a.offsetTop},d={start:this.getRelativeStartPosition(e),top:e.offsetTop};let f=null;return i?f=this.getRelativeCellPositionWithinWindow(s,o,d,u):f=this.getRelativeCellPositionWithinHolder(s,l,o,d,u),f}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,l=0;if(!r)s=i.start;else{let a=o.left;this.isRtl()&&(a=this.domBindings.rootWindow.innerWidth-(o.left+o.width+nr())),s=a<=0?-1*a:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:l=i.top,{start:n.start+s,top:n.top+l}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,a=0;if(n||(l=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(a=s.vertical-o.top);return{start:i.start-l,top:i.top-a}}makeClone(){if(Oz.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),l=e.wtRootElement.parentNode;o.className=`${xz.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&rt(o,[hi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),l.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===$o||u==="vertical"&&this.type===Vo?this.mainTableScrollableElement=i:i.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=pd(e.TABLE),new $z(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.shouldBeRendered();this.clone&&(this.needFullRender||r)&&this.clone.draw(e),this.needFullRender=r}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;ge([n,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class zz extends eu{constructor(e,r,n,i,o,s){super(e,r,Zi,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Yw(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else sh(r),this.repositionOverlay();let n=en(this.clone.wtTable.TABLE);const i=It(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=nr(n)),i.style.bottom=`${o}px`}}const jz="calculatedColumns",hh={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};so(hh,"MIXIN_NAME",jz,{writable:!1,enumerable:!1});class Kw extends ll{constructor(e,r,n,i){super(e,r,n,i,$n)}}mt(Kw,Uw);mt(Kw,hh);function Uz(t,e,r){return e=Yz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yz(t){var e=Gz(t,"string");return typeof e=="symbol"?e:e+""}function Gz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kz extends eu{constructor(e,r,n,i){super(e,r,$n,n,i),Uz(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Kw(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=nr(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.mainTableScrollableElement===r?(r.scrollTo(Dw(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,l=0;for(;s<r;){const a=n.getRowHeight(s);l+=a===void 0?o:a,s+=1}return l}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=nr(n),l=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let d=r.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(d-=o),d=Math.min(d,e.wtRootElement.scrollWidth),l.width=`${d}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let u=en(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),l.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=nr(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return kw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,l=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,l=ot(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Ne(s,"innerBorderBottom"),o=!l):(St(s,"innerBorderBottom"),o=l)}return o}}const Xz="calculatedRows",Xw={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};so(Xw,"MIXIN_NAME",Xz,{writable:!1,enumerable:!1});class Qw extends ll{constructor(e,r,n,i){super(e,r,n,i,Vo)}}mt(Qw,Xw);mt(Qw,dh);const Qz="localHooks",Ei={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)Ig(this._localHooks[t][a],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};so(Ei,"MIXIN_NAME",Qz,{writable:!1,enumerable:!1});let KT=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};mt(KT,Ei);const qz="active-header",XT="header",qw="area",Zw="focus",Zz="fill",Jz="row",ej="column",tj="custom-selection",Jw=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var rj=FT;rj("flat");function nj(t,e){QT(t,e),e.add(t)}function AS(t,e,r){QT(t,e),e.set(t,r)}function QT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dt(t,e){return t.get(la(t,e))}function NS(t,e,r){return t.set(la(t,e),r),r}function la(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hn=new WeakMap,gr=new WeakMap,Uu=new WeakSet;class ij{constructor(){nj(this,Uu),AS(this,hn,void 0),AS(this,gr,void 0)}setActiveOverlay(e){return NS(gr,this,e),this}setActiveSelection(e){return NS(hn,this,e),this}scan(){const e=dt(hn,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=dt(hn,this).getCorners(),{wtTable:s}=dt(gr,this),l=s.getRenderedColumnsCount(),a=s.getColumnHeadersCount();let u=0;for(let d=-s.getRowHeadersCount();d<l;d++){const f=s.columnFilter.renderedToSource(d);if(!(f<n||f>o)){for(let m=-a;m<0;m++){if(m<r||m>i)continue;const p=m+a;let C=s.getColumnHeader(f,p);const S=dt(gr,this).getSetting("onBeforeHighlightingColumnHeader",f,p,{selectionType:dt(hn,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});S!==null&&(S!==f&&(C=s.getColumnHeader(S,p)),e(C))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=dt(hn,this).getCorners(),{wtTable:s}=dt(gr,this),l=s.getRenderedRowsCount(),a=s.getRowHeadersCount();let u=0;for(let d=-s.getColumnHeadersCount();d<l;d++){const f=s.rowFilter.renderedToSource(d);if(!(f<r||f>i)){for(let m=-a;m<0;m++){if(m<n||m>o)continue;const p=m+a;let C=s.getRowHeader(f,p);const S=dt(gr,this).getSetting("onBeforeHighlightingRowHeader",f,p,{selectionType:dt(hn,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});S!==null&&(S!==f&&(C=s.getRowHeader(S,p)),e(C))}u+=1}}}scanCellsRange(e){const[r,n,i,o]=dt(hn,this).getCorners(),{wtTable:s}=dt(gr,this);la(Uu,this,Kf).call(this,(l,a)=>{if(l>=r&&l<=i&&a>=n&&a<=o){const u=s.getCell(dt(gr,this).createCellCoords(l,a)),d=dt(gr,this).getSetting("onAfterDrawSelection",l,a,dt(hn,this).settings.layerLevel);typeof d=="string"&&Ne(u,d),e(u)}})}scanRowsInCellsRange(e){const[r,,n]=dt(hn,this).getCorners(),{wtTable:i}=dt(gr,this);la(Uu,this,Kf).call(this,(o,s)=>{if(o>=r&&o<=n){const l=i.getCell(dt(gr,this).createCellCoords(o,s));e(l)}})}scanColumnsInCellsRange(e){const[,r,,n]=dt(hn,this).getCorners(),{wtTable:i}=dt(gr,this);la(Uu,this,Kf).call(this,(o,s)=>{if(s>=r&&s<=n){const l=i.getCell(dt(gr,this).createCellCoords(o,s));e(l)}})}}function Kf(t){const{wtTable:e}=dt(gr,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class DS{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Jw,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ah(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(a){if(a.clientY<Math.floor(o.top)||a.clientY>Math.ceil(o.top+o.height)||a.clientX<Math.floor(o.left)||a.clientX>Math.ceil(o.left+o.width))return!0}function l(a){s(a)&&(n.eventManager.removeEventListener(i,"mousemove",l),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",l)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let l=0;l<5;l++){const a=n[l],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[a]&&this.settings[a].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:e.border.color,i.height=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,i.width=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Os()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const r=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};Ye(i,(s,l)=>{this.selectionHandles.styles.bottomHitArea[l]=s,this.selectionHandles.styles.topHitArea[l]=s});const o={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ye(o,(s,l)=>{this.selectionHandles.styles.bottom[l]=s,this.selectionHandles.styles.top[l]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:d,bottom:f,bottomHitArea:m}=this.selectionHandles.styles,p=parseInt(u.borderWidth,10),C=parseInt(u.width,10),S=parseInt(d.width,10),H=this.wot.wtTable.getWidth(),w=this.wot.wtTable.getHeight();u.top=`${parseInt(n-C-1,10)}px`,u[a]=`${parseInt(i-C-1,10)}px`,d.top=`${parseInt(n-S/4*3,10)}px`,d[a]=`${parseInt(i-S/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),H-C-p*2),E=Math.min(parseInt(i+o-S/4,10),H-S-p*2);f[a]=`${v}px`,m[a]=`${E}px`;const x=Math.min(parseInt(n+s,10),w-C-p*2),$=Math.min(parseInt(n+s-S/4,10),w-S-p*2);f.top=`${x}px`,m.top=`${$}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",d.display="block",this.isPartRange(e,r)?(f.display="none",m.display="none"):(f.display="block",m.display="block")):(u.display="none",f.display="none",d.display="none",m.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",d.zIndex="9999"):(u.zIndex="",d.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:r,rootDocument:n,rootWindow:i}=this.wot;let o,s,l,a,u,d;const f=r.getRenderedRowsCount();for(let N=0;N<f;N+=1){const A=r.rowFilter.renderedToSource(N);if(A>=e[0]&&A<=e[2]){o=A,u=e[0];break}}for(let N=f-1;N>=0;N-=1){const A=r.rowFilter.renderedToSource(N);if(A>=e[0]&&A<=e[2]){s=A;break}}const m=r.getRenderedColumnsCount();for(let N=0;N<m;N+=1){const A=r.columnFilter.renderedToSource(N);if(A>=e[1]&&A<=e[3]){l=A,d=e[1];break}}for(let N=m-1;N>=0;N-=1){const A=r.columnFilter.renderedToSource(N);if(A>=e[1]&&A<=e[3]){a=A;break}}if(o===void 0||l===void 0){this.disappear();return}let p=r.getCell(this.wot.createCellCoords(o,l));const C=o!==s||l!==a,S=C?r.getCell(this.wot.createCellCoords(s,a)):p,H=Qr(p),w=C?Qr(S):H,v=Qr(r.TABLE),E=It(r.TABLE),x=H.top,$=H.left,k=this.wot.wtSettings.getSetting("rtlMode");let P=0,y=0;if(k){const N=It(p),A=i.innerWidth-v.left-E;y=$+N-w.left,P=i.innerWidth-$-N-A-1}else y=w.left+It(S)-$,P=$-v.left-1;if(this.isEntireColumnSelected(o,s)){const N=this.getDimensionsFromHeader("columns",l,a,u,v);let A=null;N&&([A,P,y]=N),A&&(p=A)}let b=x-v.top-1,M=w.top+en(S)-x;if(this.isEntireRowSelected(l,a)){const N=this.getDimensionsFromHeader("rows",o,s,d,v);let A=null;N&&([A,b,M]=N),A&&(p=A)}const U=to(p,i);parseInt(U.borderTopWidth,10)>0&&(b+=1,M=M>0?M-1:0),parseInt(U[k?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,y=y>0?y-1:0);const Y=k?"right":"left";this.topStyle.top=`${b}px`,this.topStyle[Y]=`${P}px`,this.topStyle.width=`${y}px`,this.topStyle.display="block",this.startStyle.top=`${b}px`,this.startStyle[Y]=`${P}px`,this.startStyle.height=`${M}px`,this.startStyle.display="block";const B=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${b+M-B}px`,this.bottomStyle[Y]=`${P}px`,this.bottomStyle.width=`${y}px`,this.bottomStyle.display="block",this.endStyle.top=`${b}px`,this.endStyle[Y]=`${P+y-B}px`,this.endStyle.height=`${M+1}px`,this.endStyle.display="block";let Q=this.settings.border.cornerVisible;Q=typeof Q=="function"?Q(this.settings.layerLevel):Q;const me=this.wot.getSetting("onModifyGetCellCoords",s,a);let[se,G]=[s,a];if(me&&Array.isArray(me)&&([,,se,G]=me),Os()||!Q||this.isPartRange(se,G))this.cornerStyle.display="none";else{this.cornerStyle.top=`${b+M+this.cornerCenterPointOffset-1}px`,this.cornerStyle[Y]=`${P+y+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let N=wd(r.TABLE);const A=N===i;A&&(N=n.documentElement);const J=parseInt(this.cornerDefaultStyle.width,10)/2,c=parseInt(this.cornerDefaultStyle.height,10)/2;if(a===this.wot.getSetting("totalColumns")-1){const h=A?S.getBoundingClientRect().left:S.offsetLeft;let g=!1,_=0;k?(_=h-parseInt(this.cornerDefaultStyle.width,10)/2,g=_<0):(_=h+It(S)+parseInt(this.cornerDefaultStyle.width,10)/2,g=_>=yT(N)),g&&(this.cornerStyle[Y]=`${Math.floor(P+y+this.cornerCenterPointOffset-J)}px`,this.cornerStyle[k?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(A?S.getBoundingClientRect().top:S.offsetTop)+en(S)+parseInt(this.cornerDefaultStyle.height,10)/2>=_s(N)&&(this.cornerStyle.top=`${Math.floor(b+M+this.cornerCenterPointOffset-c)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Os()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,a,b,P,y,M)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,l=s.wtRootElement.parentNode;let a=null,u=null,d=null,f=null,m=null,p=null,C=null,S=null;switch(e){case"rows":a=function(){return s.getRowHeader(...arguments)},u=function(){return en(...arguments)},d="ht__selection--rows",p="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},u=function(){return It(...arguments)},d="ht__selection--columns",p="left";break}if(l.classList.contains(d)){const H=this.wot.getSetting("columnHeaders").length;if(C=a(r,H-i),S=a(n,H-i),!C||!S)return!1;const w=Qr(C),v=Qr(S);return C&&S&&(f=w[p]-o[p]-1,m=v[p]+u(S)-w[p]),[C,f,m]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?Ne(this[e],"hidden"):(ot(this[e],"hidden")&&St(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Ne(this[e],"hidden"):St(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Os()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function oj(t,e){qT(t,e),e.add(t)}function as(t,e,r){qT(t,e),e.set(t,r)}function qT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ve(t,e){return t.get(ev(t,e))}function kS(t,e,r){return t.set(ev(t,e),r),r}function ev(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ut=new WeakMap,yr=new WeakMap,Xf=new WeakMap,Yl=new WeakMap,Qf=new WeakMap,po=new WeakMap,LS=new WeakSet;class sj{constructor(e){oj(this,LS),as(this,Ut,void 0),as(this,yr,void 0),as(this,Xf,new ij),as(this,Yl,new WeakMap),as(this,Qf,new WeakSet),as(this,po,new Map),kS(yr,this,e)}setActiveOverlay(e){return kS(Ut,this,e),ve(Xf,this).setActiveOverlay(ve(Ut,this)),ve(Yl,this).has(ve(Ut,this))||ve(Yl,this).set(ve(Ut,this),new Set),this}getFocusSelection(){return ve(yr,this)!==null?ve(yr,this).getFocus():null}getAreaSelection(){return ve(yr,this)!==null?ve(yr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ve(po,this).has(e)){const n=ve(po,this).get(e);if(n.has(ve(Ut,this)))return n.get(ve(Ut,this));const i=new DS(ve(Ut,this),e.settings);return n.set(ve(Ut,this),i),i}const r=new DS(ve(Ut,this),e.settings);return ve(po,this).set(e,new Map([[ve(Ut,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=ve(po,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){ve(po,this).get(e).forEach(r=>r.destroy()),ve(po,this).delete(e)}render(e){if(ve(yr,this)===null)return;e&&ev(LS,this,lj).call(this);const r=Array.from(ve(yr,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:l,headerAttributes:a,createLayers:u,selectionType:d}=s.settings;ve(Qf,this).has(s)||(ve(Qf,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const f=this.getBorderInstance(s);if(s.isEmpty()){f==null||f.disappear();continue}l&&ve(Xf,this).setActiveSelection(s).scan().forEach(C=>{if(n.has(C)){const S=n.get(C);S.has(l)&&u===!0?S.set(l,S.get(l)+1):S.set(l,1)}else n.set(C,new Map([[l,1]]));a&&(i.has(C)||i.set(C,[]),C.nodeName==="TH"&&i.get(C).push(...a))});const m=s.getCorners();ve(Ut,this).getSetting("onBeforeDrawBorders",m,d),f==null||f.appear(m)}n.forEach((o,s)=>{var l;const a=Array.from(o).map(u=>{let[d,f]=u;return f===1?d:[d,...Array.from({length:f-1},(m,p)=>`${d}-${p+1}`)]}).flat();a.forEach(u=>ve(Yl,this).get(ve(Ut,this)).add(u)),Ne(s,a),s.nodeName==="TD"&&Array.isArray((l=ve(yr,this).options)===null||l===void 0?void 0:l.cellAttributes)&&rt(s,ve(yr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{rt(o,[...i.get(o)])})}}function lj(){const t=ve(Yl,this).get(ve(Ut,this)),e=ve(Ut,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=ve(Ut,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=ve(yr,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=ve(yr,this).options.cellAttributes.map(l=>l[0])),Array.isArray((i=ve(yr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...ve(yr,this).options.headerAttributes.map(l=>l[0])]);for(let l=0,a=o.length;l<a;l++)St(o[l],r),Xa(o[l],s)}),t.clear()}class aj extends eu{constructor(e,r,n,i){super(e,r,Vo,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Qw(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Lw(n,`${o}px`,"0px")):(o=this.getScrollPosition(),sh(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,wT(r)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=nr(r),s=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||l==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const a=It(this.clone.wtTable.TABLE);s.width=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=this.wot.selectionManager.getFocusSelection()?parseInt(Jw.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),l=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,a=o===0&&i.length>0&&!ot(l.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),d=0;if(r){const f=this.wot.wtTable.getColumnWidth(e),m=this.wot.wtViewport.getViewportWidth();f>m&&(r=!1)}return r&&l.offsetWidth!==l.clientWidth&&(d=nr(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=a):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=d,bV(this.mainTableScrollableElement)===u-a&&a>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(a),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(vT(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?St(r,"emptyRows"):Ne(r,"emptyRows");let s=!1;if(i&&!n.length)Ne(r,"innerBorderLeft innerBorderInlineStart");else if(!i&&n.length){const l=ot(r,"innerBorderInlineStart");e?(Ne(r,"innerBorderLeft innerBorderInlineStart"),s=!l):(St(r,"innerBorderLeft innerBorderInlineStart"),s=l)}return s}}const uj="stickyRowsTop",tv={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};so(tv,"MIXIN_NAME",uj,{writable:!1,enumerable:!1});class rv extends ll{constructor(e,r,n,i){super(e,r,n,i,Wo)}}mt(rv,tv);mt(rv,dh);function FS(t,e,r){return e=cj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cj(t){var e=dj(t,"string");return typeof e=="symbol"?e:e+""}function dj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hj extends eu{constructor(e,r,n,i,o,s){super(e,r,Wo,n,i),FS(this,"topOverlay",void 0),FS(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new rv(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Lw(e,`${i}px`,`${o}px`)}else sh(e);let r=en(this.clone.wtTable.TABLE);const n=It(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class nv extends ll{constructor(e,r,n,i){super(e,r,n,i,$o)}}mt(nv,tv);mt(nv,hh);function fj(t,e,r){return e=mj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mj(t){var e=gj(t,"string");return typeof e=="symbol"?e:e+""}function gj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pj extends eu{constructor(e,r,n,i){super(e,r,$o,n,i),fj(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new nv(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:l}=this.wot,a=l.hider.getBoundingClientRect(),u=Math.ceil(a.bottom),d=e.offsetHeight;o=u===d,i=this.getOverlayOffset(),Lw(e,"0px",`${i}px`)}else i=this.getScrollPosition(),sh(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const r=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo(Dw(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=nr(r),s=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||l==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=en(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=this.wot.selectionManager.getFocusSelection()?parseInt(Jw.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,l=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&l.length>0&&!ot(s.parentNode,"innerBorderTop")?1:0;let d=this.getTableParentOffset(),f=0;if(r){const m=this.wot.wtTable.getRowHeight(e),p=this.wot.wtViewport.getViewportHeight();m>p&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(f=nr(this.domBindings.rootDocument)),r){const m=i.getSetting("fixedRowsBottom"),p=i.getSetting("totalRows");d+=this.sumCellSizes(0,e+1),d-=n.wtViewport.getViewportHeight()-this.sumCellSizes(p-m,p),d+=1,d+=u}else d+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return d+=f,EV(this.mainTableScrollableElement)===d-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(d)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return kw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?St(n,"emptyColumns"):Ne(n,"emptyColumns");let o=!1;if(!r){const s=this.wtSettings.getSetting("fixedRowsTop"),l=this.cachedFixedRowsTop!==s,a=this.wtSettings.getSetting("columnHeaders");if((l||s===0)&&a.length>0){const u=ot(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(Ne(n,"innerBorderTop"),o=!u):(St(n,"innerBorderTop"),o=u)}}return o}}function ei(t,e,r){return e=wj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wj(t){var e=vj(t,"string");return typeof e=="symbol"?e:e+""}function vj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yj{constructor(e,r,n,i,o,s){ei(this,"wot",null),ei(this,"topOverlay",null),ei(this,"bottomOverlay",null),ei(this,"inlineStartOverlay",null),ei(this,"topInlineStartCornerOverlay",null),ei(this,"bottomInlineStartCornerOverlay",null),ei(this,"browserLineHeight",void 0),ei(this,"wtSettings",null),ei(this,"resizeObserver",new ResizeObserver(d=>{XV(()=>{!Array.isArray(d)||!d.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:l,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=nr(l);const u=a.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:pd(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new pj(...e),this.bottomOverlay=new Kz(...e),this.inlineStartOverlay=new aj(...e),this.topInlineStartCornerOverlay=new hj(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new zz(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",f=>this.onKeyDown(f)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",f=>this.onTableScroll(f),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",f=>this.onTableScroll(f),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,l=this.wtSettings.getSetting("preventWheel"),a={passive:s};(l||o||!eW())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",f=>this.onCloneWheel(f,l),a),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(f=>{if(f&&f.needFullRender){const{holder:m}=f.clone.wtTable;this.eventManager.addEventListener(m,"wheel",p=>this.onCloneWheel(p,l),a)}});let d;this.eventManager.addEventListener(r,"resize",()=>{clearTimeout(d),d=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,l=o!==n&&s!==n&&!s.contains(o),a=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(l||a))return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=aW(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=pd(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:r}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,o=this.scrollableElement===i,s=this.wtSettings.getSetting("totalColumns"),l=this.wtSettings.getSetting("totalRows"),a=r.getRowHeaderWidth(),d=r.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,l)+1,f=a+this.inlineStartOverlay.sumCellSizes(0,s),p=n.hider.style,C=()=>o?!1:this.scrollableElement.scrollTop>Math.max(0,d-n.holder.clientHeight),S=()=>o?!1:this.scrollableElement.scrollLeft>Math.max(0,f-n.holder.clientWidth),H=C()?1:0,w=S()?1:0;if(p.width=`${f+w}px`,p.height=`${d+H}px`,this.scrollbarSize>0){const{scrollHeight:v,scrollWidth:E}=n.wtRootElement,{scrollHeight:x,scrollWidth:$}=n.holder;this.hasScrollbarRight=v<x,this.hasScrollbarBottom=E<$,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>E?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>v&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return ge(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];ge(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function $S(t,e,r){return e=Cj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cj(t){var e=Sj(t,"string");return typeof e=="symbol"?e:e+""}function Sj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rj{constructor(e){$S(this,"settings",{}),$S(this,"defaults",Object.freeze(this.getDefaults())),Ye(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Qa(n,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?Ye(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class iv extends ll{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=wd(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=Mg(e,"height",r),o=Mg(e,"overflow",r),s=this.holder.style,{scrollWidth:l,scrollHeight:a}=e;let u=e.offsetWidth,d=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const m=e.cloneNode(!1);m.style.overflow="auto",m.style.position="absolute",e.nextElementSibling?n.insertBefore(m,e.nextElementSibling):n.appendChild(m);const p=parseInt(to(m,r).height,10);n.removeChild(m),p===0&&(d=0)}d=Math.min(d,a),s.height=i==="auto"?"auto":`${d}px`,u=Math.min(u,l),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:d>0,this.hasTableWidth=u>0}this.isTableVisible=Ia(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const l=e.getSetting("rowHeaders").length,a=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let d=-1*l;d<a;d++)this.markIfOversizedColumnHeader(d);r.hasOversizedColumnHeadersMarked[n]=!0}}}mt(iv,Xw);mt(iv,hh);class Ej{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=en(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:r,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=r.documentElement.offsetWidth,s=e.getSetting("totalColumns"),l=e.getSetting("preventOverflow"),a=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),d=a?u.right-o:u.left,f=o-d;let m,p;if(l)return It(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?m=Math.min(f,o):m=Math.min(this.getContainerFillWidth(),f,o),i===n&&s>0&&this.sumColumnWidths(0,s-1)>m)return r.documentElement.clientWidth;if(i!==n&&(p=Mg(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(m,i.clientWidth);const C=e.getSetting("stretchH");return C==="none"||!C?Math.max(m,It(this.wtTable.TABLE)):m}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,r=this.domBindings.rootDocument.createElement("div");r.style.width="100%",r.style.height="1px",e.appendChild(r);const n=r.offsetWidth;return this.containerWidth=n,e.removeChild(r),n}getWorkspaceOffset(){return Qr(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=en(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=It(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ai;const{wtSettings:r,wtTable:n}=this;if(r.getSetting("renderAllRows")&&e===Ai)return new VB({totalRows:r.getSetting("totalRows")});let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),d=r.getSetting("totalRows");return a&&l>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,a),l+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(d-u,d),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=nr(this.domBindings.rootDocument),new zw({viewportHeight:i,scrollOffset:l,totalRows:r.getSetting("totalRows"),rowHeightFn:f=>n.getRowHeight(f),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ai;const{wtSettings:r,wtTable:n}=this;if(r.getSetting("renderAllColumns")&&e===Ai)return new LB({totalColumns:r.getSetting("totalColumns")});let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=l,i-=l}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=nr(this.domBindings.rootDocument)),new ch({viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:l=>n.getColumnWidth(l),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this;if(e&&!r.getSetting("renderAllRows")){const n=this.createRowsCalculator(Gt);e=this.areAllProposedVisibleRowsAlreadyRendered(n)}if(e&&!r.getSetting("renderAllColumns")){const n=this.createColumnsCalculator(Gt);e=this.areAllProposedVisibleColumnsAlreadyRendered(n)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(Ai),this.columnsRenderCalculator=this.createColumnsCalculator(Ai)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Gt),this.columnsVisibleCalculator=this.createColumnsCalculator(Gt)}createPartiallyVisibleCalculators(){this.rowsPartiallyVisibleCalculator=this.createRowsCalculator(SS),this.columnsPartiallyVisibleCalculator=this.createColumnsCalculator(SS)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:r,endRow:n,isVisibleInTrimmingContainer:i}=e;if(r===null&&n===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return r<o||r===o&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:r,endColumn:n,isVisibleInTrimmingContainer:i}=e;if(r===null&&n===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return r<o||r===o&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ye(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class bj extends Gw{constructor(e,r){super(e,new Rj(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new iv(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Ej(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new sj(this.wtSettings.getSetting("selections")),this.wtEvent=new jT(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new yj(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Ye(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),St(this.wtTable.wtRootElement.parentNode,r),Ne(this.wtTable.wtRootElement.parentNode,n)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class ov{constructor(e){e instanceof Gw?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new ov(r);return()=>n},this._wot=new bj(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n,i,o){return this._wot.scrollViewport(e,r,n,i,o)}scrollViewportHorizontally(e,r,n){return this._wot.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wot.scrollViewportVertically(e,r,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function VS(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:l}=t;const a=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),d=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&a)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||d)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(l(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(l(a.to.row,i.col)):d&&i.col<0&&!s.row?o.setRangeEnd(l(i.row,a.to.col)):(!u&&!d&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(a.from.row,0),i.row,i.col):(!u&&!d&&i.row<0||d&&i.row<0)&&!s.column&&o.selectColumns(Math.max(a.from.col,0),i.col,i.row);else{const f=!o.inInSelection(i),m=r||n&&f;i.row<0&&i.col>=0&&!s.column?m&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?m&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?m&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Tj(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),a=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),l&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,a-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const _j=new Map([["mousedown",VS],["mouseover",Tj],["touchstart",VS]]);function WS(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:o}=e;_j.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:MT(t)||t.type==="touchstart",isRightClick:Hg(t)})}const ZT=new WeakMap,sv=Symbol("rootInstance");function Oj(t){ZT.set(t,!0)}function xj(t){return t===sv}function xc(t){return ZT.has(t)}function Mj(t,e){JT(t,e),e.add(t)}function wo(t,e,r){JT(t,e),e.set(t,r)}function JT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mi(t,e,r){return e=Ij(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ij(t){var e=Hj(t,"string");return typeof e=="symbol"?e:e+""}function Hj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ot(t,e){return t.get(Pa(t,e))}function jr(t,e,r){return t.set(Pa(t,e),r),r}function Pa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qf=new WeakMap,Yu=new WeakMap,Gu=new WeakMap,ti=new WeakMap,fn=new WeakMap,Zf=new WeakMap,Jf=new WeakMap,Mc=new WeakSet;class Pj{constructor(e){Mj(this,Mc),Mi(this,"hot",void 0),Mi(this,"eventManager",void 0),Mi(this,"settings",void 0),Mi(this,"THEAD",void 0),Mi(this,"TBODY",void 0),Mi(this,"_wt",void 0),Mi(this,"activeWt",void 0),wo(this,qf,0),wo(this,Yu,0),Mi(this,"postponedAdjustElementsSize",!1),wo(this,Gu,!1),wo(this,ti,void 0),wo(this,fn,void 0),wo(this,Zf,0),wo(this,Jf,0),this.hot=e,this.eventManager=new Qs(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n,i,o){return this._wt.scrollViewport(e,r,n,i,o)}scrollViewportHorizontally(e,r,n){return this._wt.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wt.scrollViewportVertically(e,r,n)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Ne(e,"handsontable"),jr(fn,this,r.createElement("TABLE")),Ne(Ot(fn,this),"htCore"),this.hot.getSettings().tableClassName&&Ne(Ot(fn,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(rt(Ot(fn,this),[hi()]),rt(e,[cV(),cT(-1),oh(this.hot.countCols()),pV()])),this.THEAD=r.createElement("THEAD"),Ot(fn,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Ot(fn,this).appendChild(this.TBODY),this.hot.table=Ot(fn,this),this.hot.container.insertBefore(Ot(fn,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,o=r.documentElement;this.eventManager.addEventListener(e,"mousedown",l=>{jr(Gu,this,!0),this.isTextSelectionAllowed(l.target)||(QC(i),l.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{jr(Gu,this,!1)}),this.eventManager.addEventListener(e,"mousemove",l=>{Ot(Gu,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&QC(i),l.preventDefault())}),this.eventManager.addEventListener(o,"keyup",l=>{n.isInProgress()&&!l.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",l=>{n.isInProgress()&&MT(l)&&n.finish(),jr(ti,this,!1);const a=ST(r.activeElement);_c(r.activeElement)&&!a||(a||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(l.target)&&!Hg(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",l=>{n.isInProgress()&&Hg(l)&&(n.finish(),jr(ti,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),jr(ti,this,!1)}),this.eventManager.addEventListener(o,"mousedown",l=>{const a=l.target,u=l.x||l.clientX,d=l.y||l.clientY;let f=l.target;if(Ot(ti,this)||!e||!this.hot.view)return;const{holder:m}=this.hot.view._wt.wtTable;if(f===m){const C=nr(r);if(r.elementFromPoint(u+C,d)!==m||r.elementFromPoint(u,d+C)!==m)return}else for(;f!==o;){if(f===null){if(l.isTargetWebComponent)break;return}if(f===e)return;f=f.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(a):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=gd(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=gd(s);this.eventManager.addEventListener(Ot(fn,this),"selectstart",l=>{this.settings.fragmentSelection||_c(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let l=0;return r<0?l=s+1:r>0&&(l=i-s),l}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ot(fn,this),isDataViewInstance:()=>xc(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,l)=>{const a=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(a,l)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),jr(Yu,this,o.length),this.hot.getSettings().ariaTags&&Pa(Mc,this,e_).call(this)===this.hot.countCols()&&Pa(Mc,this,Aj).call(this,Ot(Yu,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,l)=>{const a=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(a,l)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),jr(qf,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,l)=>{const[a,u]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.runHooks("modifyGetCellCoords",a,u);let f=a,m=u;Array.isArray(d)&&([f,m]=d);const p=this.hot.getCellMeta(f,m),C=this.hot.colToProp(m);let S=this.hot.getDataAtRowProp(f,C);this.hot.hasHook("beforeValueRender")&&(S=this.hot.runHooks("beforeValueRender",S,p)),this.hot.runHooks("beforeRenderer",l,a,u,C,S,p),this.hot.getCellRenderer(p)(this.hot,l,a,u,C,S,p),this.hot.runHooks("afterRenderer",l,a,u,C,S,p)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Ia(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,l,a)=>{const u=this.translateFromRenderableToVisualCoords(s),d={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=a,jr(ti,this,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,l,d),!bo(o)&&(WS(o,{coords:u,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,m)=>this.hot._createCellCoords(f,m)}),this.hot.runHooks("afterOnCellMouseDown",o,u,l),this.activeWt=this._wt)},onCellContextMenu:(o,s,l,a)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=a,jr(ti,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,l),!bo(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,l),this.activeWt=this._wt)},onCellMouseOut:(o,s,l,a)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=a,this.hot.runHooks("beforeOnCellMouseOut",o,u,l),!bo(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,l),this.activeWt=this._wt)},onCellMouseOver:(o,s,l,a)=>{const u=this.translateFromRenderableToVisualCoords(s),d={row:!1,column:!1,cell:!1};this.activeWt=a,this.hot.runHooks("beforeOnCellMouseOver",o,u,l,d),!bo(o)&&(Ot(ti,this)&&WS(o,{coords:u,selection:this.hot.selection,controller:d,cellCoordsFactory:(f,m)=>this.hot._createCellCoords(f,m)}),this.hot.runHooks("afterOnCellMouseOver",o,u,l),this.activeWt=this._wt)},onCellMouseUp:(o,s,l,a)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=a,this.hot.runHooks("beforeOnCellMouseUp",o,u,l),!(bo(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,l),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,l=o<0;let a=o;return!l&&(a=s.getVisualFromRenderableIndex(o),a===null)?o:(a=this.hot.runHooks("beforeViewportScrollVertically",a),this.hot.runHooks("beforeViewportScroll"),l?a:s.getRenderableFromVisualIndex(a))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,l=o<0;let a=o;return!l&&(a=s.getVisualFromRenderableIndex(o),a===null)?o:(a=this.hot.runHooks("beforeViewportScrollHorizontally",a),this.hot.runHooks("beforeViewportScroll"),l?a:s.getRenderableFromVisualIndex(a))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,l)=>{const a=this.hot.rowIndexMapper,u=o<0;let d=o;u||(d=a.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingRowHeader",d,s,l);return u?f:a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(o,s,l)=>{const a=this.hot.columnIndexMapper,u=o<0;let d=o;u||(d=a.getVisualFromRenderableIndex(o));const f=this.hot.runHooks("beforeHighlightingColumnHeader",d,s,l);return u?f:a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(o,s,l)=>{let a;const[u,d]=this.translateFromRenderableToVisualIndex(o,s),f=this.hot.selection.getSelectedRange();if(f.size()>0){const p=f.peekByIndex(l??0);a=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.hot.runHooks("afterDrawSelection",u,d,a,l)},onBeforeDrawBorders:(o,s)=>{const[l,a,u,d]=o,f=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.hot.columnIndexMapper.getVisualFromRenderableIndex(a),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.hot.runHooks("beforeDrawBorders",f,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const l=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,l)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,l)=>{const a=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,d=s>=0?u.getVisualFromRenderableIndex(s):s,f=o>=0?a.getVisualFromRenderableIndex(o):o,m=this.hot.runHooks("modifyGetCellCoords",f,d,l);if(Array.isArray(m)){const[p,C,S,H]=m;return[p>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(p,1)):p,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,1)):C,S>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(S,-1)):S,H>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(H,-1)):H]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const l=this.countRenderableRows(),a=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(a-s,0),o.endRow=Math.min(u+s,l-1);else if(s==="auto"){const d=Math.ceil(u/l*12);o.startRow=Math.max(a-d,0),o.endRow=Math.min(u+d,l-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const l=this.countRenderableColumns(),a=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(a-s,0),o.endColumn=Math.min(u+s,l-1)),s==="auto"){const d=Math.ceil(u/l*6);o.startColumn=Math.max(a-d,0),o.endColumn=Math.min(u+d,l-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new ov(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(_c(e))return!0;const r=xg(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ot(ti,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!ot(n,"relative")){Ys(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(r.firstChild){const o=r.firstChild;ot(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,n,i):(Ys(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),l=o.createElement("span");s.className="relative",l.className="colHeader",this.settings.ariaTags&&(rt(s,...hi()),rt(l,...hi())),this.updateCellHeader(l,e,n,i),s.appendChild(l),r.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ot(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):ot(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?RV(e,n(r,i)):(Qa(e," "),Ne(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){jr(Zf,this,e),jr(Jf,this,r)}getLastSize(){return{width:Ot(Zf,this),height:Ot(Jf,this)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ot(qf,this)}getRowHeadersCount(){return Ot(Yu,this)}getViewportWidth(){return this.hot.view._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this.hot.view._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this.hot.view._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this.hot.view._wt.wtViewport.getWorkspaceHeight()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function e_(){return parseInt(this.hot.rootElement.getAttribute(oh()[0]),10)}function Aj(t){const e=Pa(Mc,this,e_).call(this)+t;rt(this.hot.rootElement,...oh(e))}const Nj="ABCDEFGHIJKLMNOPQRSTUVWXYZ",BS=Nj.length;function Dj(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%BS,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/BS,10);return r}function t_(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&zn(t[0])&&(e=Fw(t[0]))),e}function Al(t,e,r){return e=kj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kj(t){var e=Lj(t,"string");return typeof e=="symbol"?e:e+""}function Lj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fj{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Al(this,"hot",void 0),Al(this,"data",void 0),Al(this,"dataType","array"),Al(this,"colToProp",()=>{}),Al(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return ge(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0;let s=null,l=null;if(s=this.modifyRowData(e),Array.isArray(s))l=[],o?s.forEach((a,u)=>{l[u]=this.getAtPhysicalCell(e,u,s)}):qr(r,n,a=>{l[a-r]=this.getAtPhysicalCell(e,a,s)});else if(zn(s)||Je(s))if(i?l=[]:l={},!o||i){const u=this.countFirstRowKeys()-1;qr(0,u,d=>{const f=this.colToProp(d);if(d>=(r||0)&&d<=(n||u)&&!Number.isInteger(f)){const m=this.getAtPhysicalCell(e,f,s);i?l.push(m):Hf(l,f,m)}})}else Ye(s,(a,u)=>{Hf(l,u,this.getAtPhysicalCell(e,u,s))});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Sn(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}Number.isInteger(r)?this.data[e][r]=n:Hf(this.data[e],r,n)}}getAtPhysicalCell(e,r,n){let i=null;if(n&&(typeof r=="string"?i=KV(n,r):typeof r=="function"?i=r(n):i=n[r]),this.hot.hasHook("modifySourceData")){const o=Sn(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,l=null,a=null;e===null||r===null?(i=!0,o=0,l=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),l=Math.max(e.row,r.row),a=Math.max(e.col,r.col));const u=[];return qr(o,l,d=>{u.push(i?this.getAtRow(d,void 0,void 0,n):this.getAtRow(d,s,a,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return t_(this.data)}destroy(){this.data=null,this.hot=null}}function zS(t,e,r){return e=$j(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $j(t){var e=Vj(t,"string");return typeof e=="symbol"?e:e+""}function Vj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;zS(this,"indexedValues",[]),zS(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Je(this.initValueOrFn)?qr(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):qr(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mt(tu,Ei);function r_(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Je(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function n_(t,e){return Pw(t,(r,n)=>e.includes(n)===!1)}class lv extends tu{insert(e,r){this.indexedValues=r_(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=n_(this.indexedValues,e),super.remove(e)}}class i_ extends lv{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return nh(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function o_(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Cd(t,e){return Pw(t,r=>e.includes(r)===!1)}function s_(t,e){return Lo(t,r=>r-e.filter(n=>n<r).length)}function l_(t,e){const r=e[0],n=e.length;return Lo(t,i=>i>=r?i+n:i)}function Wj(t,e,r){return e=Bj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bj(t){var e=zj(t,"string");return typeof e=="symbol"?e:e+""}function zj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jj extends tu{constructor(){super(...arguments),Wj(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Cd(this.orderOfIndexes,[e]),Je(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=r_(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=l_(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=n_(this.indexedValues,e),this.orderOfIndexes=Cd(this.orderOfIndexes,e),this.orderOfIndexes=s_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class a_ extends lv{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return nh(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class Uj extends tu{constructor(){super(e=>e)}insert(e,r){const n=l_(this.indexedValues,r);this.indexedValues=o_(n,e,r),super.insert(e,r)}remove(e){const r=Cd(this.indexedValues,e);this.indexedValues=s_(r,e),super.remove(e)}}const jS=new Map([["hiding",i_],["index",tu],["linkedPhysicalIndexToValue",jj],["physicalIndexToValue",lv],["trimming",a_]]);function Yj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!jS.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(jS.get(t))(e)}function Gj(t,e,r){return e=Kj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kj(t){var e=Xj(t,"string");return typeof e=="symbol"?e:e+""}function Xj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class av{constructor(){Gj(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);Se(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Sr(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}mt(av,Ei);function em(t,e,r){return e=Qj(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qj(t){var e=qj(t,"string");return typeof e=="symbol"?e:e+""}function qj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class US extends av{constructor(e,r){super(),em(this,"mergedValuesCache",[]),em(this,"aggregationFunction",void 0),em(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=Lo(this.get(),o=>o.getValues()),n=[],i=Se(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let l=0;l<this.getLength();l+=1)s.push(r[l][o]);n.push(s)}return Lo(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return Se(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Zj(t,e,r){Jj(t,e),e.set(t,r)}function Jj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eU(t,e,r){return t.set(u_(t,e),r),r}function tU(t,e){return t.get(u_(t,e))}function u_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var tm=new WeakMap;class c_{constructor(){Zj(this,tm,[])}subscribe(e){return this.addLocalHook("change",e),this._write(tU(tm,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){eU(tm,this,e)}}mt(c_,Ei);function YS(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Nl(t,e,r){rU(t,e),e.set(t,r)}function rU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ur(t,e){return t.get(d_(t,e))}function Ku(t,e,r){return t.set(d_(t,e),r),r}function d_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xu=new WeakMap,Dl=new WeakMap,Qu=new WeakMap,qu=new WeakMap,Zu=new WeakMap;class nU{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Nl(this,Xu,new Set),Nl(this,Dl,[]),Nl(this,Qu,[]),Nl(this,qu,!1),Nl(this,Zu,!1),Ku(Zu,this,e??!1)}createObserver(){const e=new c_;return Ur(Xu,this).add(e),e.addLocalHook("unsubscribe",()=>{Ur(Xu,this).delete(e)}),e._writeInitialChanges(YS(Ur(Dl,this),Ur(Qu,this))),e}emit(e){let r=Ur(Qu,this);(!Ur(qu,this)||Ur(Dl,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Ur(Zu,this)):Ku(Dl,this,new Array(e.length).fill(Ur(Zu,this))),Ur(qu,this)||(Ku(qu,this,!0),r=Ur(Dl,this)));const n=YS(r,e);Ur(Xu,this).forEach(i=>i._write(n)),Ku(Qu,this,e)}}function er(t,e,r){return e=iU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iU(t){var e=oU(t,"string");return typeof e=="symbol"?e:e+""}function oU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wg{constructor(){er(this,"indexesSequence",new Uj),er(this,"trimmingMapsCollection",new US(e=>e.some(r=>r===!0),!1)),er(this,"hidingMapsCollection",new US(e=>e.some(r=>r===!0),!1)),er(this,"variousMapsCollection",new av),er(this,"hidingChangesObservable",new nU({initialIndexValue:!1})),er(this,"notTrimmedIndexesCache",[]),er(this,"notHiddenIndexesCache",[]),er(this,"isBatched",!1),er(this,"indexesSequenceChanged",!1),er(this,"indexesChangeSource",void 0),er(this,"trimmedIndexesChanged",!1),er(this,"hiddenIndexesChanged",!1),er(this,"renderablePhysicalIndexesCache",[]),er(this,"fromPhysicalToVisualIndexesCache",new Map),er(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,Yj(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof a_?this.trimmingMapsCollection.register(e,r):r instanceof i_?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return Se(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return Se(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return Se(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return Se(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(l=>l>e):s=o.reverse().findIndex(l=>l<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=Lo(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Cd(this.getIndexesSequence(),n),l=s.filter(u=>this.isTrimmed(u)===!1);let a=s.indexOf(l[l.length-1])+1;if(r+o<i){const u=l[r];a=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(o_(s,a,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=Se(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),s=Lo(new Array(r).fill(i),(l,a)=>l+a);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}mt(Wg,Ei);function sU(t,e){return Ye(e,(r,n)=>{Sr(t[n])&&(t[n]=r)}),t}function h_(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function f_(t){Se(t)&&uW(Ar`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function lU(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:aU,getValues:uU}=sl("phraseFormatters");function cU(t,e){aU(t,e)}function dU(){return uU()}cU("pluralize",lU);const m_="ContextMenu:items",fe=m_,g_=`${fe}.noItems`,p_=`${fe}.insertRowAbove`,w_=`${fe}.insertRowBelow`,v_=`${fe}.insertColumnOnTheLeft`,y_=`${fe}.insertColumnOnTheRight`,C_=`${fe}.removeRow`,S_=`${fe}.removeColumn`,R_=`${fe}.undo`,E_=`${fe}.redo`,b_=`${fe}.readOnly`,T_=`${fe}.clearColumn`,__=`${fe}.copy`,O_=`${fe}.copyWithHeaders`,x_=`${fe}.copyWithGroupHeaders`,M_=`${fe}.copyHeadersOnly`,I_=`${fe}.cut`,H_=`${fe}.freezeColumn`,P_=`${fe}.unfreezeColumn`,A_=`${fe}.mergeCells`,N_=`${fe}.unmergeCells`,D_=`${fe}.addComment`,k_=`${fe}.editComment`,L_=`${fe}.removeComment`,F_=`${fe}.readOnlyComment`,$_=`${fe}.align`,V_=`${fe}.align.left`,W_=`${fe}.align.center`,B_=`${fe}.align.right`,z_=`${fe}.align.justify`,j_=`${fe}.align.top`,U_=`${fe}.align.middle`,Y_=`${fe}.align.bottom`,G_=`${fe}.borders`,K_=`${fe}.borders.top`,X_=`${fe}.borders.right`,Q_=`${fe}.borders.bottom`,q_=`${fe}.borders.left`,Z_=`${fe}.borders.remove`,J_=`${fe}.nestedHeaders.insertChildRow`,e1=`${fe}.nestedHeaders.detachFromParent`,t1=`${fe}.hideColumn`,r1=`${fe}.showColumn`,n1=`${fe}.hideRow`,i1=`${fe}.showRow`,_r="Filters:",ct=`${_r}conditions`,o1=`${ct}.none`,s1=`${ct}.isEmpty`,l1=`${ct}.isNotEmpty`,a1=`${ct}.isEqualTo`,u1=`${ct}.isNotEqualTo`,c1=`${ct}.beginsWith`,d1=`${ct}.endsWith`,h1=`${ct}.contains`,f1=`${ct}.doesNotContain`,hU=`${ct}.byValue`,m1=`${ct}.greaterThan`,g1=`${ct}.greaterThanOrEqualTo`,p1=`${ct}.lessThan`,w1=`${ct}.lessThanOrEqualTo`,v1=`${ct}.isBetween`,y1=`${ct}.isNotBetween`,C1=`${ct}.after`,S1=`${ct}.before`,R1=`${ct}.today`,E1=`${ct}.tomorrow`,b1=`${ct}.yesterday`,T1=`${_r}labels.filterByCondition`,_1=`${_r}labels.filterByValue`,O1=`${_r}labels.conjunction`,x1=`${_r}labels.disjunction`,M1=`${_r}values.blankCells`,I1=`${_r}buttons.selectAll`,H1=`${_r}buttons.clear`,P1=`${_r}buttons.ok`,A1=`${_r}buttons.cancel`,N1=`${_r}buttons.placeholder.search`,D1=`${_r}buttons.placeholder.value`,k1=`${_r}buttons.placeholder.secondValue`,uv="CheckboxRenderer:",L1=`${uv}checked`,F1=`${uv}unchecked`,fU=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:L1,CHECKBOX_RENDERER_NAMESPACE:uv,CHECKBOX_UNCHECKED:F1,CONTEXTMENU_ITEMS_ADD_COMMENT:D_,CONTEXTMENU_ITEMS_ALIGNMENT:$_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Y_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:W_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:z_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:V_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:U_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:B_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:j_,CONTEXTMENU_ITEMS_BORDERS:G_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Q_,CONTEXTMENU_ITEMS_BORDERS_LEFT:q_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:X_,CONTEXTMENU_ITEMS_BORDERS_TOP:K_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:T_,CONTEXTMENU_ITEMS_COPY:__,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:M_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:x_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:O_,CONTEXTMENU_ITEMS_CUT:I_,CONTEXTMENU_ITEMS_EDIT_COMMENT:k_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:H_,CONTEXTMENU_ITEMS_HIDE_COLUMN:t1,CONTEXTMENU_ITEMS_HIDE_ROW:n1,CONTEXTMENU_ITEMS_INSERT_LEFT:v_,CONTEXTMENU_ITEMS_INSERT_RIGHT:y_,CONTEXTMENU_ITEMS_MERGE_CELLS:A_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:e1,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:J_,CONTEXTMENU_ITEMS_NO_ITEMS:g_,CONTEXTMENU_ITEMS_READ_ONLY:b_,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:F_,CONTEXTMENU_ITEMS_REDO:E_,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Z_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:S_,CONTEXTMENU_ITEMS_REMOVE_COMMENT:L_,CONTEXTMENU_ITEMS_REMOVE_ROW:C_,CONTEXTMENU_ITEMS_ROW_ABOVE:p_,CONTEXTMENU_ITEMS_ROW_BELOW:w_,CONTEXTMENU_ITEMS_SHOW_COLUMN:r1,CONTEXTMENU_ITEMS_SHOW_ROW:i1,CONTEXTMENU_ITEMS_UNDO:R_,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:P_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:N_,CONTEXT_MENU_ITEMS_NAMESPACE:m_,FILTERS_BUTTONS_CANCEL:A1,FILTERS_BUTTONS_CLEAR:H1,FILTERS_BUTTONS_OK:P1,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:N1,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:k1,FILTERS_BUTTONS_PLACEHOLDER_VALUE:D1,FILTERS_BUTTONS_SELECT_ALL:I1,FILTERS_CONDITIONS_AFTER:C1,FILTERS_CONDITIONS_BEFORE:S1,FILTERS_CONDITIONS_BEGINS_WITH:c1,FILTERS_CONDITIONS_BETWEEN:v1,FILTERS_CONDITIONS_BY_VALUE:hU,FILTERS_CONDITIONS_CONTAINS:h1,FILTERS_CONDITIONS_EMPTY:s1,FILTERS_CONDITIONS_ENDS_WITH:d1,FILTERS_CONDITIONS_EQUAL:a1,FILTERS_CONDITIONS_GREATER_THAN:m1,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:g1,FILTERS_CONDITIONS_LESS_THAN:p1,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:w1,FILTERS_CONDITIONS_NAMESPACE:ct,FILTERS_CONDITIONS_NONE:o1,FILTERS_CONDITIONS_NOT_BETWEEN:y1,FILTERS_CONDITIONS_NOT_CONTAIN:f1,FILTERS_CONDITIONS_NOT_EMPTY:l1,FILTERS_CONDITIONS_NOT_EQUAL:u1,FILTERS_CONDITIONS_TODAY:R1,FILTERS_CONDITIONS_TOMORROW:E1,FILTERS_CONDITIONS_YESTERDAY:b1,FILTERS_DIVS_FILTER_BY_CONDITION:T1,FILTERS_DIVS_FILTER_BY_VALUE:_1,FILTERS_LABELS_CONJUNCTION:O1,FILTERS_LABELS_DISJUNCTION:x1,FILTERS_NAMESPACE:_r,FILTERS_VALUES_BLANK_CELLS:M1},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const $1={languageCode:"en-US",[g_]:"No available options",[p_]:"Insert row above",[w_]:"Insert row below",[v_]:"Insert column left",[y_]:"Insert column right",[C_]:["Remove row","Remove rows"],[S_]:["Remove column","Remove columns"],[R_]:"Undo",[E_]:"Redo",[b_]:"Read only",[T_]:"Clear column",[$_]:"Alignment",[V_]:"Left",[W_]:"Center",[B_]:"Right",[z_]:"Justify",[j_]:"Top",[U_]:"Middle",[Y_]:"Bottom",[H_]:"Freeze column",[P_]:"Unfreeze column",[G_]:"Borders",[K_]:"Top",[X_]:"Right",[Q_]:"Bottom",[q_]:"Left",[Z_]:"Remove border(s)",[D_]:"Add comment",[k_]:"Edit comment",[L_]:"Delete comment",[F_]:"Read-only comment",[A_]:"Merge cells",[N_]:"Unmerge cells",[__]:"Copy",[O_]:["Copy with header","Copy with headers"],[x_]:["Copy with group header","Copy with group headers"],[M_]:["Copy header only","Copy headers only"],[I_]:"Cut",[J_]:"Insert child row",[e1]:"Detach from parent",[t1]:["Hide column","Hide columns"],[r1]:["Show column","Show columns"],[n1]:["Hide row","Hide rows"],[i1]:["Show row","Show rows"],[o1]:"None",[s1]:"Is empty",[l1]:"Is not empty",[a1]:"Is equal to",[u1]:"Is not equal to",[c1]:"Begins with",[d1]:"Ends with",[h1]:"Contains",[f1]:"Does not contain",[m1]:"Greater than",[g1]:"Greater than or equal to",[p1]:"Less than",[w1]:"Less than or equal to",[v1]:"Is between",[y1]:"Is not between",[C1]:"After",[S1]:"Before",[R1]:"Today",[E1]:"Tomorrow",[b1]:"Yesterday",[M1]:"Blank cells",[T1]:"Filter by condition",[_1]:"Filter by value",[O1]:"And",[x1]:"Or",[I1]:"Select all",[H1]:"Clear",[P1]:"OK",[A1]:"Cancel",[N1]:"Search",[D1]:"Value",[k1]:"Second value",[L1]:"Checked",[F1]:"Unchecked"},mU=fU,Bg=$1.languageCode,{register:gU,getItem:V1,hasItem:pU,getValues:wU}=sl("languagesDictionaries");W1($1);function W1(t,e){let r=t,n=e;return zn(t)&&(n=t,r=n.languageCode),vU(r,n),gU(r,ro(n)),ro(n)}function vU(t,e){t!==Bg&&sU(e,V1(Bg))}function B1(t){return cv(t)?ro(V1(t)):null}function cv(t){return pU(t)}function yU(){return wU()}function z1(t,e,r){const n=B1(t);if(n===null)return null;const i=n[e];if(Sr(i))return null;const o=CU(i,r);return Array.isArray(o)?o[0]:o}function CU(t,e){let r=t;return ge(dU(),n=>{r=n(t,e)}),r}function SU(t){let e=h_(t);return cv(e)||(e=Bg,f_(t)),e}function RU(t,e,r){return e=EU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EU(t){var e=bU(t,"string");return typeof e=="symbol"?e:e+""}function bU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bi extends KT{constructor(e,r){super(e,null),RU(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const l=e.highlight.clone();if(l.row>=0&&(l.row=s.row),l.col>=0&&(l.col=s.col),this.cellRange===null){const a=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(a)}e.setHighlight(l)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function rm(t){let{activeHeaderClassName:e,...r}=t;return new bi({className:e,...r,selectionType:qz})}function TU(t){let{areaCornerVisible:e,...r}=t;return new bi({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:qw})}function _U(t){let{...e}=t;return new bi({className:"highlight",...e,selectionType:qw})}function OU(t){let{columnClassName:e,...r}=t;return new bi({className:e,...r,selectionType:ej})}function xU(t){let{cellCornerVisible:e,...r}=t;return new bi({className:"current",headerAttributes:[hT()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Zw})}function MU(t){let{border:e,visualCellRange:r,...n}=t;return new bi({...e,...n,selectionType:tj},r)}function IU(t){let{...e}=t;return new bi({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Zz})}function GS(t){let{headerClassName:e,...r}=t;return new bi({className:e,...r,selectionType:XT})}function HU(t){let{rowClassName:e,...r}=t;return new bi({className:e,...r,selectionType:Jz})}function PU(t,e){AU(t,e),e.add(t)}function AU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fr(t,e,r){return e=NU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NU(t){var e=DU(t,"string");return typeof e=="symbol"?e:e+""}function DU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ri(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Nn=new WeakSet;class kU{constructor(e){PU(this,Nn),fr(this,"options",void 0),fr(this,"layerLevel",0),fr(this,"focus",void 0),fr(this,"fill",void 0),fr(this,"layeredAreas",new Map),fr(this,"areas",new Map),fr(this,"rowHeaders",new Map),fr(this,"columnHeaders",new Map),fr(this,"activeRowHeaders",new Map),fr(this,"activeColumnHeaders",new Map),fr(this,"activeCornerHeaders",new Map),fr(this,"rowHighlights",new Map),fr(this,"columnHighlights",new Map),fr(this,"customSelections",[]),this.options=e,this.focus=xU(e),this.fill=IU(e)}isEnabledFor(e,r){let n=e;e===Zw&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return ri(Nn,this,ni).call(this,this.layeredAreas,TU)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return ri(Nn,this,ni).call(this,this.areas,_U)}getAreas(){return[...this.areas.values()]}createRowHeader(){return ri(Nn,this,ni).call(this,this.rowHeaders,GS)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return ri(Nn,this,ni).call(this,this.columnHeaders,GS)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return ri(Nn,this,ni).call(this,this.activeRowHeaders,rm)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return ri(Nn,this,ni).call(this,this.activeColumnHeaders,rm)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return ri(Nn,this,ni).call(this,this.activeCornerHeaders,rm)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return ri(Nn,this,ni).call(this,this.rowHighlights,HU)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return ri(Nn,this,ni).call(this,this.columnHighlights,OU)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(MU({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),ge(this.areas.values(),e=>void e.clear()),ge(this.layeredAreas.values(),e=>void e.clear()),ge(this.rowHeaders.values(),e=>void e.clear()),ge(this.columnHeaders.values(),e=>void e.clear()),ge(this.activeRowHeaders.values(),e=>void e.clear()),ge(this.activeColumnHeaders.values(),e=>void e.clear()),ge(this.activeCornerHeaders.values(),e=>void e.clear()),ge(this.rowHighlights.values(),e=>void e.clear()),ge(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ni(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function KS(t,e,r){return e=LU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LU(t){var e=FU(t,"string");return typeof e=="symbol"?e:e+""}function FU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $U{constructor(e){KS(this,"ranges",[]),KS(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function VU(t,e){j1(t,e),e.add(t)}function nm(t,e,r){j1(t,e),e.set(t,r)}function j1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(pt(t,e))}function im(t,e,r){return t.set(pt(t,e),r),r}function pt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ju=new WeakMap,Be=new WeakMap,jn=new WeakMap,vt=new WeakSet;class zg{constructor(e,r){VU(this,vt),nm(this,Ju,void 0),nm(this,Be,void 0),nm(this,jn,{x:0,y:0}),im(Ju,this,e),im(Be,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=xe(Be,this).createCellCoords(e,r);let o=xe(Ju,this).current().highlight;const s=xe(Be,this).visualToRenderableCoords(o);let l=0,a=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:d}=pt(vt,this,U1).call(this),{row:f,col:m}=pt(vt,this,QS).call(this,o),p=xe(Be,this).fixedRowsBottom(),C=xe(Be,this).minSpareRows(),S=xe(Be,this).minSpareCols(),H=xe(Be,this).autoWrapRow(),w=xe(Be,this).autoWrapCol(),v=xe(Be,this).createCellCoords(f+i.row,m+i.col);if(v.row>=d){const $=Sn(n&&C>0&&p===0),k=v.col+1,P=xe(Be,this).createCellCoords(v.row-d,k>=u?k-u:k);this.runLocalHooks("beforeColumnWrap",$,pt(vt,this,us).call(this,P),k>=u),$.value?this.runLocalHooks("insertRowRequire",xe(Be,this).countRenderableRows()):w&&v.assign(P)}else if(v.row<0){const $=Sn(w),k=v.col-1,P=xe(Be,this).createCellCoords(d+v.row,k<0?u+k:k);this.runLocalHooks("beforeColumnWrap",$,pt(vt,this,us).call(this,P),k<0),w&&v.assign(P)}if(v.col>=u){const $=Sn(n&&S>0),k=v.row+1,P=xe(Be,this).createCellCoords(k>=d?k-d:k,v.col-u);this.runLocalHooks("beforeRowWrap",$,pt(vt,this,us).call(this,P),k>=d),$.value?this.runLocalHooks("insertColRequire",xe(Be,this).countRenderableColumns()):H&&v.assign(P)}else if(v.col<0){const $=Sn(H),k=v.row-1,P=xe(Be,this).createCellCoords(k<0?d+k:k,u+v.col);this.runLocalHooks("beforeRowWrap",$,pt(vt,this,us).call(this,P),k<0),H&&v.assign(P)}const{rowDir:E,colDir:x}=pt(vt,this,XS).call(this,v);l=E,a=x,o=pt(vt,this,us).call(this,v)}return this.runLocalHooks("afterTransformStart",o,l,a),o}transformEnd(e,r){const n=xe(Be,this).createCellCoords(e,r),i=xe(Ju,this).current(),o=xe(Be,this).visualToRenderableCoords(i.highlight),s=pt(vt,this,om).call(this,i.to.row,i.from.row),l=pt(vt,this,sm).call(this,i.to.col,i.from.col),a=i.to.clone();let u=0,d=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&l!==null){const{row:f,col:m}=pt(vt,this,QS).call(this,i.highlight),p=xe(Be,this).createCellCoords(s+n.row,l+n.col),C=i.getTopStartCorner(),S=i.getTopEndCorner(),H=i.getBottomEndCorner(),w={row:p.row-f,col:p.col-m};n.col<0?l>=m&&p.col<m&&(p.col=pt(vt,this,sm).call(this,C.col,S.col)+w.col):n.col>0&&l<=m&&p.col>m&&(p.col=pt(vt,this,sm).call(this,S.col,C.col)+w.col),n.row<0?s>=f&&p.row<f&&(p.row=pt(vt,this,om).call(this,C.row,H.row)+w.row):n.row>0&&s<=f&&p.row>f&&(p.row=pt(vt,this,om).call(this,H.row,C.row)+w.row);const{rowDir:v,colDir:E}=pt(vt,this,XS).call(this,p);u=v,d=E;const x=pt(vt,this,us).call(this,p);n.row===0&&n.col!==0?a.col=x.col:n.row!==0&&n.col===0?a.row=x.row:(a.row=x.row,a.col=x.col)}return this.runLocalHooks("afterTransformEnd",a,u,d),a}setOffsetSize(e){let{x:r,y:n}=e;im(jn,this,{x:r,y:n})}}function XS(t){const{width:e,height:r}=pt(vt,this,U1).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function U1(){return{width:xe(jn,this).x+xe(Be,this).countRenderableColumns(),height:xe(jn,this).y+xe(Be,this).countRenderableRows()}}function om(t,e){const r=xe(Be,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:xe(jn,this).y+r}function sm(t,e){const r=xe(Be,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:xe(jn,this).x+r}function QS(t){const{row:e,col:r}=xe(Be,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return xe(Be,this).createCellCoords(xe(jn,this).y+e,xe(jn,this).x+r)}function us(t){const e=t.clone();return e.col=t.col-xe(jn,this).x,e.row=t.row-xe(jn,this).y,xe(Be,this).renderableToVisualCoords(e)}mt(zg,Ei);const Y1=0,G1=1,K1=2,dv=3,WU=[dv,K1],BU=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],lm=Symbol("root"),qS=Symbol("child");function X1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lm;if(e!==lm&&e!==qS)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===lm;let i=Y1;if(r){const o=t[0];t.length===0?i=G1:n&&o instanceof Za?i=dv:n&&Array.isArray(o)?i=X1(o,qS):t.length>=2&&t.length<=4&&!t.some((l,a)=>!BU[a].includes(typeof l))&&(i=K1)}return i}function zU(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!WU.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===dv;let l=s?o.from.row:o[0],a=s?o.from.col:o[1],u=s?o.to.row:o[2],d=s?o.to.col:o[3];if(typeof i=="function"&&(typeof a=="string"&&(a=i(a)),typeof d=="string"&&(d=i(d))),Sr(u)&&(u=l),Sr(d)&&(d=a),!n){const p=l,C=a,S=u,H=d;l=Math.min(p,S),a=Math.min(C,H),u=Math.max(p,S),d=Math.max(C,H)}const f=e(l,a),m=e(u,d);return r(f,f,m)}}function cs(t,e,r){jU(t,e),e.set(t,r)}function jU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(t,e,r){return e=UU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UU(t){var e=YU(t,"string");return typeof e=="symbol"?e:e+""}function YU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nt(t,e){return t.get(Q1(t,e))}function Dn(t,e,r){return t.set(Q1(t,e),r),r}function Q1(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mr=new WeakMap,yo=new WeakMap,ec=new WeakMap,kl=new WeakMap,tc=new WeakMap,Ll=new WeakMap;class q1{constructor(e,r){var n=this;vo(this,"settings",void 0),vo(this,"tableProps",void 0),vo(this,"inProgress",!1),vo(this,"selectedRange",new $U((i,o,s)=>this.tableProps.createCellRange(i,o,s))),vo(this,"highlight",void 0),cs(this,mr,void 0),cs(this,yo,void 0),vo(this,"selectedByRowHeader",new Set),vo(this,"selectedByColumnHeader",new Set),cs(this,ec,!1),cs(this,kl,!1),cs(this,tc,"unknown"),cs(this,Ll,-1),this.settings=e,this.tableProps=r,this.highlight=new kU({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[hT()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Dn(mr,this,new zg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Dn(yo,this,new zg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),nt(mr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),nt(mr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),nt(mr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),nt(mr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),nt(mr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),nt(mr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),nt(mr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),nt(mr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),nt(yo,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),nt(yo,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Dn(tc,this,e)}markEndSource(){Dn(tc,this,"unknown")}getSelectionSource(){return nt(tc,this)}setExpectedLayers(e){Dn(Ll,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Dn(Ll,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Sr(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,l=e.clone();Dn(ec,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,l),(!o||o&&!s&&Sr(r))&&this.selectedRange.clear(),this.selectedRange.add(l).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!o||i===0&&r.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const v=s.getHorizontalDirection(),E=s.getVerticalDirection(),x=this.isMultiple();s.setTo(r),x&&(v!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),x&&(E!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(ge(this.highlight.getAreas(),v=>void v.clear()),ge(this.highlight.getLayeredAreas(),v=>void v.clear()),ge(this.highlight.getRowHeaders(),v=>void v.clear()),ge(this.highlight.getColumnHeaders(),v=>void v.clear()),ge(this.highlight.getActiveRowHeaders(),v=>void v.clear()),ge(this.highlight.getActiveColumnHeaders(),v=>void v.clear()),ge(this.highlight.getActiveCornerHeaders(),v=>void v.clear()),ge(this.highlight.getRowHighlights(),v=>void v.clear()),ge(this.highlight.getColumnHighlights(),v=>void v.clear())),this.highlight.useLayerLevel(l);const a=this.highlight.createArea(),u=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),m=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),S=this.highlight.createRowHighlight(),H=this.highlight.createColumnHighlight();if(a.clear(),u.clear(),d.clear(),f.clear(),m.clear(),p.clear(),C.clear(),S.clear(),H.clear(),this.highlight.isEnabledFor(qw,s.highlight)&&(this.isMultiple()||l>=1)&&(a.add(s.from).add(s.to).commit(),u.add(s.from).add(s.to).commit(),l===1)){const v=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(v.from).commit().syncWith(v),this.highlight.createLayeredArea().add(v.from).commit().syncWith(v),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(XT,s.highlight)){if(!s.isSingleHeader()){const x=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),$=this.tableProps.createCellCoords(s.to.row,-1),k=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),P=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(d.add(x).commit(),f.add(k).commit(),S.add(x).commit(),H.add(k).commit()):(d.add(x).add($).commit(),f.add(k).add(P).commit(),S.add(x).add($).commit(),H.add(k).add(P).commit())}const v=!nt(kl,this)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),E=!nt(kl,this)&&this.isEntireColumnSelected()&&(n>0&&n===s.getHeight()||n===0&&this.isSelectedByColumnHeader());v&&m.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),E&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),v&&E&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}const w=nt(Ll,this)===-1||this.selectedRange.size()===nt(Ll,this);this.runLocalHooks("afterSetRangeEnd",e,w)}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Zw,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(Dn(ec,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders&&nt(mr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeStart(nt(mr,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders&&nt(mr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeEnd(nt(mr,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:o}=n.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),l=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?nt(yo,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-l}):nt(yo,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-l});const a=nt(yo,this).transformStart(e,r);this.setRangeFocus(a.normalize())}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Sn(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&nt(ec,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===l};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===l};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),u=n?-a:0,d=r?-l:0;if(u===0&&d===0&&(o===0||s===0))return;let f=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:m,disableHeadersHighlight:p}=i;Dn(kl,this,p),m&&Number.isInteger(m==null?void 0:m.row)&&Number.isInteger(m==null?void 0:m.col)&&(f=this.tableProps.createCellCoords(In(m.row,u,o-1),In(m.col,d,s-1)));const C=this.tableProps.createCellCoords(u,d),S=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(C,void 0,f),d<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.finish(),Dn(kl,this,!1)}selectCells(e){var r=this;const n=X1(e);if(n===G1)return!1;if(n===Y1)throw new Error(Ar`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=zU(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:a=>this.tableProps.propToCol(a),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},l=!e.some(a=>{const u=i(a),d=u.isValid(s);return!(d&&!u.containsHeaders()||d&&u.containsHeaders()&&u.isSingleHeader())});return l&&(this.clear(),this.setExpectedLayers(e.length),ge(e,a=>{const{from:u,to:d}=i(a);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(d.clone())}),this.finish()),l}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),l=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),u=a===0?0:-a,d=this.tableProps.createCellCoords(u,i),f=this.tableProps.createCellCoords(s-1,o),m=this.tableProps.createCellRange(d,d,f).isValid({countRows:s,countCols:l,countRowHeaders:0,countColHeaders:a});if(m){let p=0,C=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(p=In(n.row,u,s-1),C=In(n.col,Math.min(i,o),Math.max(i,o))):(p=In(n,u,s-1),C=i);const S=this.tableProps.createCellCoords(p,C),H=a===0?0:In(S.row,u,-1),w=s-1,v=this.tableProps.createCellCoords(H,i),E=this.tableProps.createCellCoords(w,o);this.runLocalHooks("beforeSelectColumns",v,E,S),v.row=H,E.row=w,this.setRangeStartOnly(v,void 0,S),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",v,E,S),this.finish()}return m}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=s===0?0:-s,a=this.tableProps.createCellCoords(e,l),u=this.tableProps.createCellCoords(r,o-1),d=this.tableProps.createCellRange(a,a,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(d){let f=0,m=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(f=In(n.row,Math.min(e,r),Math.max(e,r)),m=In(n.col,l,o-1)):(f=e,m=In(n,l,o-1));const p=this.tableProps.createCellCoords(f,m),C=s===0?0:In(p.col,l,-1),S=o-1,H=this.tableProps.createCellCoords(e,C),w=this.tableProps.createCellCoords(r,S);this.runLocalHooks("beforeSelectRows",H,w,p),H.col=C,w.col=S,this.setRangeStartOnly(H,void 0,p),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",H,w,p),this.finish()}return d}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.highlight.getFocus(),n=this.getLayerLevel();r.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();o.commit(),s.commit(),l.commit(),a.commit(),u.commit(),d.commit(),f.commit(),m.commit(),p.commit()}this.highlight.useLayerLevel(n)}}mt(q1,Ei);function ZS(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Co(t,e,r){return e=GU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GU(t){var e=KU(t,"string");return typeof e=="symbol"?e:e+""}function KU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xs{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Co(this,"hot",void 0),Co(this,"metaManager",void 0),Co(this,"tableMeta",void 0),Co(this,"dataSource",void 0),Co(this,"duckSchema",void 0),Co(this,"colToPropCache",void 0),Co(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const l=Fw(e);i=l>0?l:this.countFirstRowKeys(),s=!0}else{const l=this.tableMeta.maxCols;i=Math.min(l,r.length)}for(n=0;n<i;n++){const l=s?r(n):r[n];if(zn(l)){if(typeof l.data<"u"){const a=s?o:n;this.colToPropCache[a]=l.data,this.propToColCache.set(l.data,a)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return t_(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ye(e,(l,a)=>{l===null?(s=o+a,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(l,i,`${a}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&Se(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(Se(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ha(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,l=0,a=e;if((typeof a!="number"||a>=o)&&(a=o),a<this.hot.countRows()&&(s=this.hot.toPhysicalRow(a)),this.hot.runHooks("beforeCreateRow",a,r,n)===!1||s===null)return{delta:0};const d=this.tableMeta.maxRows,f=this.getSchema().length,m=[];for(;l<r&&o+l<d;){let C=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?C=ro(this.getSchema()):(C=[],qr(f-1,()=>C.push(null))):this.hot.dataType==="function"?C=this.tableMeta.dataSchema(a+l):(C={},_T(C,this.getSchema())),m.push(C),l+=1}this.hot.rowIndexMapper.insertIndexes(a,l),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,m);const p=this.hot.toVisualRow(s);return this.hot.countSourceRows()===m.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",p,l,n),this.hot.forceFullRender=!0,{delta:l,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,l=this.hot.countSourceCols();let a=e;if((typeof a!="number"||a>=l)&&(a=l),this.hot.runHooks("beforeCreateCol",a,r,n)===!1)return{delta:0};let d=l;a<this.hot.countCols()&&(d=this.hot.toPhysicalColumn(a));const f=this.hot.countSourceRows();let m=this.hot.countCols(),p=0,C=d;i==="end"&&(C=Math.min(C+1,l));const S=C;for(;p<r&&m<s;){if(typeof a!="number"||a>=m)if(f>0)for(let w=0;w<f;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<f;w++)o[w].splice(C,0,null);p+=1,C+=1,m+=1}this.hot.columnIndexMapper.insertIndexes(a,p),p>0&&(e==null?this.metaManager.createColumn(null,p):n!=="auto"&&this.metaManager.createColumn(S,r));const H=this.hot.toVisualColumn(S);return this.hot.runHooks("afterCreateCol",H,p,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:S}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const a=o.length;if(this.filterData(i,a,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const d=Se(this.tableMeta.columns)||Se(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&d===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((d,f)=>f-d).forEach(d=>{this.metaManager.removeRow(d,1)}),this.hot.runHooks("afterRemoveRow",i,a,o,n),this.hot.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((f,m)=>m-f);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let a=!0;const u=s.length,d=this.dataSource;for(let f=0;f<u;f++)a&&o[0]!==o[f]-f&&(a=!1);if(a)for(let f=0,m=this.hot.countSourceRows();f<m;f++)d[f].splice(o[0],r),f===0&&this.metaManager.removeColumn(o[0],r);else for(let f=0,m=this.hot.countSourceRows();f<m;f++)for(let p=0;p<u;p++)d[f].splice(s[p],1),f===0&&this.metaManager.removeColumn(s[p],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];WC(a,s);let d=0;for(;d<n;)a.push(null),d+=1;return rV(a),this.hot.populateFromArray(r,e,a,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];WC(a,s);let d=0;for(;d<n;)a.push(null),d+=1;return this.hot.populateFromArray(e,r,[a],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Ks(i,r))s=i[r];else if(typeof r=="string"&&r.indexOf(".")>-1){const l=r.split(".");let a=i;if(!a)return null;for(let u=0,d=l.length;u<d;u++)if(a=a[l[u]],typeof a>"u")return null;s=a}else typeof r=="function"&&(s=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=Sn(s);this.hot.runHooks("modifyData",n,this.propToCol(r),l,"get"),l.isTouched()&&(s=l.value)}return s}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const l=this.hot.runHooks("modifyRowData",i);if(s=isNaN(l)?l:s,this.hot.hasHook("modifyData")){const a=Sn(o);this.hot.runHooks("modifyData",i,this.propToCol(r),a,"set"),a.isTouched()&&(o=a.value)}if(s&&s.hasOwnProperty&&Ks(s,r))s[r]=o;else if(typeof r=="string"&&r.indexOf(".")>-1){const a=r.split(".");let u=s,d=0,f;for(d=0,f=a.length-1;d<f;d++)typeof u[a[d]]>"u"&&(u[a[d]]={}),u=u[a[d]];u[a[d]]=o}else typeof r=="function"?r(this.dataSource.slice(i,i+1)[0],o):s[r]=o}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,l;for(;o<n&&s;)l=this.hot.toPhysicalRow(o),i.push(l),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const l=this.hot.toPhysicalColumn(o);i.push(l),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,xs.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,l;const a=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(a===0||u===0)return[];const d=n===xs.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(a-1,0),Math.max(e.row,r.row)),m=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=f;o++){l=[];const p=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=m&&p!==null;s++)l.push(d.call(this,o,this.colToProp(s)));p!==null&&i.push(l)}return i}getText(e,r){return ZS(this.getRange(e,r,xs.DESTINATION_RENDERER))}getCopyableText(e,r){return ZS(this.getRange(e,r,xs.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:XU,getItem:QU,hasItem:qU,getNames:C6,getValues:S6}=sl("cellTypes");function ZU(t){if(!qU(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return QU(t)}function JU(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&HT(t,r),n&&MB(t,n),i&&NB(t,i),XU(t,e)}function e3(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Ks(e,t)}function fh(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?ZU(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ye(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!zn(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ye(n,(o,s)=>{if(e3(s,r)){var l;i[s]=o,(l=t._automaticallyAssignedMetaProps)===null||l===void 0||l.add(s)}}),Gs(t,i)}function t3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}GV(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Ic(t){return Number.isInteger(t)&&t>=0}function Hc(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function rc(t){return t==null}const Z1=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Us(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Us(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),OT(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function JS(t,e,r){return e=r3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r3(t){var e=n3(t,"string");return typeof e=="symbol"?e:e+""}function n3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i3(){return class{}}class o3{constructor(e){JS(this,"metaCtor",i3()),JS(this,"meta",void 0),this.meta=this.metaCtor.prototype,Gs(this.meta,Z1()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Gs(this.meta,e),fh(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function s3(t,e,r){return e=l3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l3(t){var e=a3(t,"string");return typeof e=="symbol"?e:e+""}function a3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u3{constructor(e){s3(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Gs(this.meta,e),fh(this.meta,e,e)}}function nc(t,e,r){return e=c3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c3(t){var e=d3(t,"string");return typeof e=="symbol"?e:e+""}function d3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sd{constructor(e){nc(this,"valueFactory",void 0),nc(this,"data",[]),nc(this,"index",[]),nc(this,"holes",new Set),this.valueFactory=e}obtain(e){Hc(()=>Ic(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Hc(()=>Ic(e)||rc(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=rc(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Hc(()=>Ic(e)||rc(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(rc(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return Pw(this.data,(e,r)=>!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function e0(t,e,r){return e=h3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h3(t){var e=f3(t,"string");return typeof e=="symbol"?e:e+""}function f3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const m3=["data","width"];class g3{constructor(e){e0(this,"globalMeta",void 0),e0(this,"metas",new Sd(()=>this._createMeta())),this.globalMeta=e,this.metas=new Sd(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Gs(n,r),fh(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return t3(this.globalMeta.getMetaConstructor(),m3).prototype}}function t0(t,e,r){return e=p3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p3(t){var e=w3(t,"string");return typeof e=="symbol"?e:e+""}function w3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v3{constructor(e){t0(this,"columnMeta",void 0),t0(this,"metas",new Sd(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Gs(i,n),fh(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)Se(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Hc(()=>Ic(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Sd(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class J1{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new o3(e),this.tableMeta=new u3(this.globalMeta),this.columnMeta=new g3(this.globalMeta),this.cellMeta=new v3(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){let{visualRow:i,visualColumn:o}=n;const s=this.cellMeta.getMeta(e,r);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=r,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mt(J1,Ei);function r0(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:l,source:a,metaManager:u,firstRun:d}=n,f=Aw(l),m=i.getSettings();Array.isArray(m.dataSchema)?i.dataType="array":Je(m.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${f}`,t,d,a);const p=new xs(i,t,u);if(e(p),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const C=p.getSchema();t=[];let S,H=0,w=0;for(H=0,w=m.startRows;H<w;H++)if((i.dataType==="object"||i.dataType==="function")&&m.dataSchema)S=ro(C),t.push(S);else if(i.dataType==="array")S=ro(C[0]),t.push(S);else{S=[];for(let v=0,E=m.startCols;v<E;v++)S.push(null);t.push(S)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),m.data=t,p.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),r(p),i.runHooks(`after${f}`,t,d,a),d||(i.runHooks("afterChange",null,l),i.render()),i.getSettings().ariaTags&&rt(i.rootElement,[cT(-1),oh(i.countCols()+(i.view?i.countRowHeaders():0))])}function n0(t,e,r){return e=y3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y3(t){var e=C3(t,"string");return typeof e=="symbol"?e:e+""}function C3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S3{constructor(e){n0(this,"metaManager",void 0),n0(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),vr.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,l=this.metaManager.hot,a=l.colToProp(s);e.prop=a,l.runHooks("beforeGetCellMeta",o,s,e);const u=Ks(e,"type")?e.type:null;let d=Je(e.cells)?e.cells(n,i,a):null;if(u)if(d){var f;d.type=(f=d.type)!==null&&f!==void 0?f:u}else d={type:u};d&&this.metaManager.updateCellMeta(n,i,d),l.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function am(t,e,r){return e=R3(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R3(t){var e=E3(t,"string");return typeof e=="symbol"?e:e+""}function E3(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b3{constructor(e){am(this,"metaManager",void 0),am(this,"usageTracker",new Set),am(this,"propDescriptors",new Map([["ariaTags",{onChange(r,n,i){if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(r,n,i){if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{target:n,onChange:i=()=>{}}=e,o=typeof n=="string",s=o?n:r,l=`_${s}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(r,l,i),o&&this.installPropWatcher(n,l,i)})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const eO="gridDefault",tO="editorManager.handlingEditor",T3={name:"editorCloseAndSave",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},_3={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},O3={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},x3={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),l=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;r.includes("shift")?t.selection.transformFocus(-l.row,-l.col):t.selection.transformFocus(l.row,l.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),ah(e))}};function M3(){return[T3,_3,O3,x3]}const I3={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},H3={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(n!==null){const i=t._createCellCoords(n,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},P3={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},A3={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},N3={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,n.col,e)}},D3={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const l=r.getNearestNotHiddenIndex(t.countRows()-1,-1),a=i.clone();a.row=n.row,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,o.col))}}},k3={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s))}}},L3={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),l=r.getNearestNotHiddenIndex(s,1),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,l))}}},F3={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const l=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,l))}}},$3={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const l=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,l))}}},V3={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const l=r.getNearestNotHiddenIndex(0,1),a=i.clone();a.row=n.row,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,o.col))}}},W3={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,n.row,e)}},B3={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},z3={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(n!==null){const i=t._createCellCoords(n,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function j3(){return[I3,H3,P3,A3,N3,D3,k3,L3,F3,$3,V3,W3,B3,z3]}const U3={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},Y3={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+r;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},G3={name:"moveCellSelectionInlineEnd",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},K3={name:"moveCellSelectionInlineStart",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},X3={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Q3={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},q3={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},Z3={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},J3={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},eY={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,o))}},tY={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},rY={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},nY={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},iY={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),l=n.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,l))}},oY={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},sY={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+r);n===-r?i=-1:n+i<r&&(i=-(n+r)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function lY(){return[U3,Y3,G3,K3,X3,Q3,q3,Z3,J3,eY,tY,rY,nY,iY,oY,sY]}const aY={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},uY={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.view.getFirstFullyVisibleRow()-1,n=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),l=t._createCellCoords(i,o);if(!t._createCellRange(s,s,l).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const d=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-d,0)}if(e.row>=0){const d=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-d,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},cY={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},dY={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},hY={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((l,a)=>{if(l>=0&&a>=0&&(l!==r||a!==n)){const{readOnly:u}=t.getCellMeta(l,a);u||o.set(`${l}x${a}`,[l,a,i])}});t.setDataAtCell(Array.from(o.values()))}},fY=[...M3(),...j3(),...lY(),aY,uY,cY,dY,hY];function rO(t){const e={};return fY.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return i(t,...s)}}),e}function mY(t){const e=t.getShortcutManager().addContext("editor"),r=rO(t),n={group:tO};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function gY(t){const e=t.getShortcutManager().addContext("grid"),r=rO(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Se(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:eO};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:tO,runOnlyIf:()=>Se(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>t.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function pY(t){[mY,gY].forEach(e=>e(t))}function wY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=i0(t),i=i0(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function i0(t){const r=t.rootDocument.createElement("input");return r.type="text",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&rt(r,[hi(),uT()]),r}function vY(t){const e=yY(t);let r;const{activate:n,deactivate:i}=wY(t,{onFocusFromTop(){var f;const m=(f=e(r))!==null&&f!==void 0?f:jg(t);m&&(t.runHooks("modifyFocusOnTabNavigation","from_above",m),t.selectCell(m.row,m.col)),t.listen()},onFocusFromBottom(){var f;const m=(f=e(r))!==null&&f!==void 0?f:Ug(t);m&&(t.runHooks("modifyFocusOnTabNavigation","from_below",m),t.selectCell(m.row,m.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,l=!1,a=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(f,m,p,C,S)=>{if(l&&(o.wrapped&&o.flipped||a)&&(a=!1,S.value=!0),s){var H;r=(H=t.getSelectedRangeLast())===null||H===void 0?void 0:H.highlight}}),t.addHook("beforeRowWrap",(f,m,p)=>{o.wrapped=!0,o.flipped=p});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const d={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:eO,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...d,callback:()=>{const{tabNavigation:f}=t.getSettings();l=!0,t.getSelectedRangeLast()&&!f&&(s=!1),f||(a=!0)},position:"before"},{...d,callback:f=>{const{tabNavigation:m,autoWrapRow:p}=t.getSettings();if(l=!1,s=!0,!m||!t.selection.isSelected()||p&&o.wrapped&&o.flipped||!p&&o.wrapped)return p&&o.wrapped&&o.flipped&&(r=f.shiftKey?jg(t):Ug(t)),u(),!1;f.preventDefault()},position:"after"}])}function jg(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Ug(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,l=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(l<0){if(!o||t.countColHeaders()===0)return null;l=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(l))!==null&&r!==void 0?r:l)}function yY(t){return e=>{if(!e)return null;const r=jg(t),n=Ug(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function CY(t){return e=>{let{col:r}=e;t.scrollViewportTo({col:r})}}function SY(){return()=>{}}function RY(t){return e=>{t.scrollViewportTo(e.toObject())}}function EY(t){return e=>{t.scrollViewportTo(e.toObject())}}function bY(t){return e=>{t.scrollViewportTo(e.toObject())}}function TY(t){return e=>{let{row:r}=e;t.scrollViewportTo({row:r})}}function _Y(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e;if(n<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&n>=0)t.scrollViewportTo({row:n});else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i})}}}function OY(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=RY(t):e.isSelectedByCorner()?s=SY():e.isSelectedByRowHeader()?s=TY(t):e.isSelectedByColumnHeader()?s=CY(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=EY(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=_Y(t):e.getSelectedRange().size()>1&&(s=bY(t)),(o=s)===null||o===void 0||o(i)}}}const o0=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ic=t=>t.map(e=>{const r=e.toLowerCase();return o0.has(r)?o0.get(r):r}).sort().join("+"),xY=t=>t.split("+"),s0=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),MY=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),um=t=>{let{key:e,code:r}=t,n=e;return s0.test(r)?n=r.replace(s0,"$1"):MY.has(r)&&(n=r),n.toLowerCase()},nO=Symbol("shortcut-context");function iO(t){return zn(t)&&t.__kindOf===nO}const IY=t=>{const e=uh({errorIdExists:a=>`The "${a}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:a,callback:u,group:d,runOnlyIf:f=()=>!0,captureCtrl:m=!1,preventDefault:p=!0,stopPropagation:C=!1,relativeToGroup:S,position:H,forwardToContext:w}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Sr(d))throw new Error("You need to define the shortcut's group.");if(Je(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(a)===!1)throw new Error(Ar`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:d,runOnlyIf:f,captureCtrl:m,preventDefault:p,stopPropagation:C};Se(S)&&(v.relativeToGroup=S,v.position=H),iO(w)&&(v.forwardToContext=w),a.forEach(E=>{const x=ic(E);if(e.hasItem(x)){const k=e.getItem(x);let P=k.findIndex(y=>y.group===S);P!==-1?H==="before"?P-=1:P+=1:P=k.length,k.splice(P,0,v)}else e.addItem(x,[v])})},n=function(a){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};a.forEach(d=>{Ye(u,(f,m)=>{Object.prototype.hasOwnProperty.call(d,m)===!1&&(d[m]=u[m])}),r(d)})},i=a=>{const u=ic(a);e.removeItem(u)};return{__kindOf:nO,addShortcut:r,addShortcuts:n,getShortcuts:a=>{const u=ic(a),d=e.getItem(u);return Se(d)?d.slice():[]},hasShortcut:a=>{const u=ic(a);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:a=>{e.getItems().forEach(d=>{let[f,m]=d;const p=m.filter(C=>C.group!==a);p.length===0?i(xY(f)):(m.length=0,m.push(...p))})}}};function HY(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const PY=["meta","alt","shift","control"],Fl=HY(),$l=[];let oc=0;function AY(t,e,r,n,i){const o=p=>PY.includes(p),s=function(p){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=[];return p.altKey&&S.push("alt"),C&&(p.ctrlKey||p.metaKey)?S.push("control/meta"):(p.ctrlKey&&S.push("control"),p.metaKey&&S.push("meta")),p.shiftKey&&S.push("shift"),S},l=p=>{if(e(p)===!1)return;const C=r(p);if(p.keyCode===229||C===!1||bo(p))return;const S=um(p);let H=[];o(S)||(H=s(p));const w=[S].concat(H);!i(p,w)&&(lS()&&H.includes("meta")||!lS()&&H.includes("control"))&&i(p,[S].concat(s(p,!0))),n(p)},a=p=>{if(p.key){const C=um(p);o(C)&&Fl.press(C)}},u=p=>{if(p.key){const C=um(p);o(C)&&Fl.release(C)}},d=()=>{Fl.releaseAll()};return{mount:()=>{let p=t;for(oc+=1;p;)oc===1&&(p.document.documentElement.addEventListener("keydown",a),$l.push({event:"keydown",listener:a}),p.document.documentElement.addEventListener("keyup",u),$l.push({event:"keyup",listener:u})),p.document.documentElement.addEventListener("keydown",l),p.document.documentElement.addEventListener("blur",d),p=gd(p)},unmount:()=>{let p=t;for(oc-=1;p;){if(oc===0){for(let C=0;C<$l.length;C++){const{event:S,listener:H}=$l[C];p.document.documentElement.removeEventListener(S,H)}$l.length=0}p.document.documentElement.removeEventListener("keydown",l),p.document.documentElement.removeEventListener("blur",d),p=gd(p)}},isPressed:p=>Fl.isPressed(p),releasePressedKeys:()=>Fl.releaseAll()}}const NY=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=uh({errorIdExists:C=>`The "${C}" context name is already registered.`});let s="grid";const l=C=>{const S=IY(C);return o.addItem(C,S),S},a=()=>s,u=C=>o.getItem(C),d=C=>{if(!o.hasItem(C))throw new Error(Ar`You've tried to activate the "${C}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=C};let f=!1;const m=function(C,S){let H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a();const w=iO(H)?H:u(H);let v=!1;if(!w.hasShortcut(S))return v;const E=w.getShortcuts(S);for(let x=0;x<E.length;x++){const{callback:$,runOnlyIf:k,preventDefault:P,stopPropagation:y,captureCtrl:b,forwardToContext:M}=E[x];if(k(C)===!0){if(f=b,v=$(C,S)===!1,f=!1,P&&C.preventDefault(),y&&(ah(C),C.stopPropagation()),v)break;M&&m(C,S,M)}}return v},p=AY(e,r,n,i,m);return p.mount(),{addContext:l,getActiveContextName:a,getContext:u,setActiveContextName:d,isCtrlPressed:()=>!f&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};let cm=null;const dm=new Map;function oO(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Qs(o);let l,a,u,d,f,m,p=!0;xj(i)&&Oj(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const C=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",S=["rtl","ltr"].includes(C)?C:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",S),this.isRtl=function(){return S==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=SU(e.language);const H=new J1(o,e,[S3,b3]),w=H.getTableMeta(),v=H.getGlobalMeta(),E=uh();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),xc(this)&&sV(e.licenseKey,t),this.guid=`ht_${lT()}`,dm.set(this.guid,this),this.columnIndexMapper=new Wg,this.rowIndexMapper=new Wg,this.columnIndexMapper.addLocalHook("indexesSequenceChange",c=>{o.runHooks("afterColumnSequenceChange",c)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",c=>{o.runHooks("afterRowSequenceChange",c)}),a=new Fj(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const x=c=>{const{row:h,col:g}=c;return o._createCellCoords(h>=0?o.rowIndexMapper.getRenderableFromVisualIndex(h):h,g>=0?o.columnIndexMapper.getRenderableFromVisualIndex(g):g)},$=c=>{const{row:h,col:g}=c;return o._createCellCoords(h>=0?o.rowIndexMapper.getVisualFromRenderableIndex(h):h,g>=0?o.columnIndexMapper.getVisualFromRenderableIndex(g):g)},k=(c,h)=>{const g=h>c?1:-1,_=Math.min(c,h),R=Math.max(c,h),O=o.rowIndexMapper.getNearestNotHiddenIndex(c,g);return O===null||g===1&&O>R||g===-1&&O<_?null:O>=0?o.rowIndexMapper.getRenderableFromVisualIndex(O):O},P=(c,h)=>{const g=h>c?1:-1,_=Math.min(c,h),R=Math.max(c,h),O=o.columnIndexMapper.getNearestNotHiddenIndex(c,g);return O===null||g===1&&O>R||g===-1&&O<_?null:O>=0?o.columnIndexMapper.getRenderableFromVisualIndex(O):O};let y=new q1(w,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:c=>l.propToCol(c),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(c,h)=>o._createCellCoords(c,h),createCellRange:(c,h,g)=>o._createCellRange(c,h,g),visualToRenderableCoords:x,renderableToVisualCoords:$,findFirstNonHiddenRenderableRow:k,findFirstNonHiddenRenderableColumn:P,isDisabledCellSelection:(c,h)=>c<0||h<0?o.getSettings().disableVisualSelection:o.getCellMeta(c,h).disableVisualSelection});this.selection=y;const b=c=>{let{hiddenIndexesChanged:h}=c;h&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",b),this.rowIndexMapper.addLocalHook("cacheUpdated",b),this.selection.addLocalHook("afterSetRangeEnd",(c,h)=>{const g=Sn(!1),_=this.selection.getSelectedRange(),{from:R,to:O}=_.current(),I=_.size()-1;this.runHooks("afterSelection",R.row,R.col,O.row,O.col,g,I),this.runHooks("afterSelectionByProp",R.row,o.colToProp(R.col),O.row,o.colToProp(O.col),g,I),h&&(!g.isTouched()||g.isTouched()&&!g.value)&&m.scrollTo(c);const L=y.isSelectedByRowHeader(),D=y.isSelectedByColumnHeader();L&&D?Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]):L?(St(this.rootElement,"ht__selection--columns"),Ne(this.rootElement,"ht__selection--rows")):D?(St(this.rootElement,"ht__selection--rows"),Ne(this.rootElement,"ht__selection--columns")):St(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("beforeSetFocus",c=>{this.runHooks("beforeSelectionFocusSet",c.row,c.col)}),this.selection.addLocalHook("afterSetFocus",c=>{const h=Sn(!1);this.runHooks("afterSelectionFocusSet",c.row,c.col,h),(!h.isTouched()||h.isTouched()&&!h.value)&&m.scrollTo(c),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",c=>{const h=c.length-1,{from:g,to:_}=c[h];this.runHooks("afterSelectionEnd",g.row,g.col,_.row,_.col,h),this.runHooks("afterSelectionEndByProp",g.row,o.colToProp(g.col),_.row,o.colToProp(_.col),h)}),this.selection.addLocalHook("afterIsMultipleSelection",c=>{const h=this.runHooks("afterIsMultipleSelection",c.value);c.value&&(c.value=h)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),St(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("beforeSetRangeStart",...h)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("beforeSetRangeStartOnly",...h)}).addLocalHook("beforeSetRangeEnd",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("beforeSetRangeEnd",...h)}).addLocalHook("beforeSelectColumns",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("beforeSelectColumns",...h)}).addLocalHook("afterSelectColumns",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("afterSelectColumns",...h)}).addLocalHook("beforeSelectRows",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("beforeSelectRows",...h)}).addLocalHook("afterSelectRows",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("afterSelectRows",...h)}).addLocalHook("beforeModifyTransformStart",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("modifyTransformStart",...h)}).addLocalHook("afterModifyTransformStart",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("afterModifyTransformStart",...h)}).addLocalHook("beforeModifyTransformFocus",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("modifyTransformFocus",...h)}).addLocalHook("afterModifyTransformFocus",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("afterModifyTransformFocus",...h)}).addLocalHook("beforeModifyTransformEnd",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("modifyTransformEnd",...h)}).addLocalHook("afterModifyTransformEnd",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("afterModifyTransformEnd",...h)}).addLocalHook("beforeRowWrap",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("beforeRowWrap",...h)}).addLocalHook("beforeColumnWrap",function(){for(var c=arguments.length,h=new Array(c),g=0;g<c;g++)h[g]=arguments[g];return n.runHooks("beforeColumnWrap",...h)}).addLocalHook("insertRowRequire",c=>this.alter("insert_row_above",c,1,"auto")).addLocalHook("insertColRequire",c=>this.alter("insert_col_start",c,1,"auto")),u={alter(c,h){var g,_;let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=arguments.length>3?arguments[3]:void 0,I=arguments.length>4?arguments[4]:void 0;const L=D=>{if(D.length===0)return[];const W=[...D];return W.sort((ee,ne)=>{let[re]=ee,[ue]=ne;return re===ue?0:re>ue?1:-1}),nh(W,(ee,ne)=>{let[re,ue]=ne;const le=ee[ee.length-1],[Ae,ye]=le,he=Ae+ye;if(re<=he){const Oe=Math.max(ue-(he-re),0);le[1]+=Oe}else ee.push([re,ue]);return ee},[W[0]])};switch(c){case"insert_row_below":case"insert_row_above":const D=o.countSourceRows();if(w.maxRows===D)return;const W=c==="insert_row_below"?"below":"above";h=(g=h)!==null&&g!==void 0?g:W==="below"?D:0;const{delta:F,startPhysicalIndex:ee}=l.createRow(h,R,{source:O,mode:W});if(F){const ye=y.selectedRange.current(),he=ye==null?void 0:ye.from,Oe=he==null?void 0:he.row,Ce=o.toVisualRow(ee);if(y.isSelectedByCorner())y.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Se(Oe)&&Oe>=Ce){const{row:ce,col:Re}=ye.to;let $e=he.col;y.isSelectedByRowHeader()&&($e=-1),y.getSelectedRange().pop(),y.setRangeStartOnly(o._createCellCoords(Oe+F,$e),!0),y.setRangeEnd(o._createCellCoords(ce+F,Re))}else o._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const ne=c==="insert_col_end"?"end":"start";h=(_=h)!==null&&_!==void 0?_:ne==="end"?o.countSourceCols():0;const{delta:re,startPhysicalIndex:ue}=l.createCol(h,R,{source:O,mode:ne});if(re){if(Array.isArray(w.colHeaders)){const ce=[o.toVisualColumn(ue),0];ce.length+=re,Array.prototype.splice.apply(w.colHeaders,ce)}const ye=y.selectedRange.current(),he=ye==null?void 0:ye.from,Oe=he==null?void 0:he.col,Ce=o.toVisualColumn(ue);if(y.isSelectedByCorner())y.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Se(Oe)&&Oe>=Ce){const{row:ce,col:Re}=ye.to;let $e=he.row;y.isSelectedByColumnHeader()&&($e=-1),y.getSelectedRange().pop(),y.setRangeStartOnly(o._createCellCoords($e,Oe+re),!0),y.setRangeEnd(o._createCellCoords(ce,Re+re))}else o._refreshBorders()}break;case"remove_row":const le=ye=>{let he=0;ge(ye,Oe=>{let[Ce,ce]=Oe;const Re=Us(Ce)?o.countRows()-1:Math.max(Ce-he,0);if(Number.isInteger(Ce)&&(Ce=Math.max(Ce-he,0)),!l.removeRow(Ce,ce,O))return;const Te=o.countRows(),at=w.fixedRowsTop;at>=Re+1&&(w.fixedRowsTop-=Math.min(ce,at-Re));const Ve=w.fixedRowsBottom;Ve&&Re>=Te-Ve&&(w.fixedRowsBottom-=Math.min(ce,Ve)),he+=ce})};Array.isArray(h)?le(L(h)):le([[h,R]]),u.adjustRowsAndCols(),o._refreshBorders();break;case"remove_col":const Ae=ye=>{let he=0;ge(ye,Oe=>{let[Ce,ce]=Oe;const Re=Us(Ce)?o.countCols()-1:Math.max(Ce-he,0);let $e=o.toPhysicalColumn(Re);if(Number.isInteger(Ce)&&(Ce=Math.max(Ce-he,0)),!l.removeCol(Ce,ce,O))return;const at=w.fixedColumnsStart;at>=Re+1&&(w.fixedColumnsStart-=Math.min(ce,at-Re)),Array.isArray(w.colHeaders)&&(typeof $e>"u"&&($e=-1),w.colHeaders.splice($e,ce)),he+=ce})};Array.isArray(h)?Ae(L(h)):Ae([[h,R]]),u.adjustRowsAndCols(),o._refreshBorders();break;default:throw new Error(`There is no such action "${c}"`)}I||u.adjustRowsAndCols()},adjustRowsAndCols(){const c=w.minRows,h=w.minSpareRows,g=w.minCols,_=w.minSpareCols;if(o.countRows()===0&&o.countCols()===0&&y.deselect(),c){const R=o.countRows();R<c&&l.createRow(R,c-R,{source:"auto"})}if(h){const R=o.countEmptyRows(!0);if(R<h){const O=h-R,I=Math.min(O,w.maxRows-o.countSourceRows());l.createRow(o.countRows(),I,{source:"auto"})}}{let R;(g||_)&&(R=o.countEmptyCols(!0));let O=o.countCols();if(g&&!w.columns&&O<g){const I=g-O;R+=I,l.createCol(O,I,{source:"auto"})}if(_&&!w.columns&&o.dataType==="array"&&R<_){O=o.countCols();const I=_-R,L=Math.min(I,w.maxCols-O);l.createCol(O,L,{source:"auto"})}}if(y.isSelected()){const R=o.countRows(),O=o.countCols();ge(y.selectedRange,I=>{let L=!1,D=I.from.row,W=I.from.col,F=I.to.row,ee=I.to.col;D>R-1?(D=R-1,L=!0,F>D&&(F=D)):F>R-1&&(F=R-1,L=!0,D>F&&(D=F)),W>O-1?(W=O-1,L=!0,ee>W&&(ee=W)):ee>O-1&&(ee=O-1,L=!0,W>ee&&(W=ee)),L&&(W<0?o.selectRows(D,F,W):D<0?o.selectColumns(W,ee,D):o.selectCell(D,W,F,ee))})}o.view&&o.view.adjustElementsSize()},populateFromArray(c,h,g,_,R){let O,I,L,D;const W=[],F={},ee=[],ne=c.row,re=c.col;if(I=h.length,I===0)return!1;let ue=0,le=0;switch(zn(g)&&(ue=g.col-re+1,le=g.row-ne+1),R){case"shift_down":const Ae=Mf(h),ye=Ae.length,he=Math.max(ye,ue),Oe=o.getData().slice(ne),Ce=Mf(Oe).slice(re,re+he);for(L=0;L<he;L+=1)if(L<ye){for(O=0,I=Ae[L].length;O<le-I;O+=1)Ae[L].push(Ae[L][O%I]);L<Ce.length?ee.push(Ae[L].concat(Ce[L])):ee.push(Ae[L].concat(new Array(Oe.length).fill(null)))}else ee.push(Ae[L%ye].concat(Ce[L]));o.populateFromArray(ne,re,Mf(ee));break;case"shift_right":const ce=h.length,Re=Math.max(ce,le),$e=o.getData().slice(ne).map(We=>We.slice(re));for(O=0;O<Re;O+=1)if(O<ce){for(L=0,D=h[O].length;L<ue-D;L+=1)h[O].push(h[O][L%D]);if(O<$e.length)for(let We=0;We<$e[O].length;We+=1)h[O].push($e[O][We]);else h[O].push(...new Array($e[0].length).fill(null))}else h.push(h[O%I].slice(0,Re).concat($e[O]));o.populateFromArray(ne,re,h);break;case"overwrite":default:F.row=c.row,F.col=c.col;let Te=0,at=0,Ve=!0,gt;const lr=function(Vr){let Xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Or=h[Vr%h.length];return Xe!==null?Or[Xe%Or.length]:Or},ar=h.length,Jt=g?g.row-c.row+1:0;for(g?I=Jt:I=Math.max(ar,Jt),O=0;O<I&&!(g&&F.row>g.row&&Jt>ar||!w.allowInsertRow&&F.row>o.countRows()-1||F.row>=w.maxRows);O++){const We=O-Te,Vr=lr(We).length,Xe=g?g.col-c.col+1:0;if(g?D=Xe:D=Math.max(Vr,Xe),F.col=c.col,gt=o.getCellMeta(F.row,F.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&gt.skipRowOnPaste){Te+=1,F.row+=1,I+=1;continue}for(at=0,L=0;L<D&&!(g&&F.col>g.col&&Xe>Vr||!w.allowInsertColumn&&F.col>o.countCols()-1||F.col>=w.maxCols);L++){if(gt=o.getCellMeta(F.row,F.col),(_==="CopyPaste.paste"||_==="Autofill.fill")&&gt.skipColumnOnPaste){at+=1,F.col+=1,D+=1;continue}if(gt.readOnly&&_!=="UndoRedo.undo"){F.col+=1;continue}const Or=L-at;let Qe=lr(We,Or),At=o.getDataAtCell(F.row,F.col);if(Qe!==null&&typeof Qe=="object")if(Array.isArray(Qe)&&At===null&&(At=[]),At===null||typeof At!="object")Ve=!1;else{const Qo=Ha(Array.isArray(At)?At:At[0]||At),qo=Ha(Array.isArray(Qe)?Qe:Qe[0]||Qe);OT(Qo,qo)||Array.isArray(Qo)&&Array.isArray(qo)?Qe=ro(Qe):Ve=!1}else At!==null&&typeof At=="object"&&(Ve=!1);Ve&&W.push([F.row,F.col,Qe]),Ve=!0,F.col+=1}F.row+=1}o.setDataAtCell(W,null,null,_||"populateFromArray");break}}};function M(c){const h=h_(c);cv(h)?(o.runHooks("beforeLanguageChange",h),v.language=h,o.runHooks("afterLanguageChange",h)):f_(c)}function U(c,h){const g=c==="className"?o.rootElement:o.table;if(p)Ne(g,h);else{let _=[],R=[];v[c]&&(_=Array.isArray(v[c])?v[c]:zC(v[c])),h&&(R=Array.isArray(h)?h:zC(h));const O=BC(_,R),I=BC(R,_);O.length&&St(g,O),I.length&&Ne(g,I)}v[c]=h}this.init=function(){a.setData(w.data),o.runHooks("beforeInit"),(Os()||iW())&&Ne(o.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new Pj(this),d=Ng.getInstance(o,w,y),m=OY(o),f=new HW(o),xc(this)&&vY(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&o.rootElement.offsetParent===null&&MV(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof p=="object"&&(o.runHooks("afterChange",p[0],p[1]),p=!1),o.runHooks("afterInit")};function Y(){let c=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,c=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&c===!1&&(c=!0,this.onQueueEmpty(this.valid))}}}function B(c){const h=c.replace(",",".");return isNaN(parseFloat(h))===!1?parseFloat(h):c}function Q(c,h,g){if(!c.length)return;const _=o.getActiveEditor(),R=new Y;let O=!0;R.onQueueEmpty=I=>{_&&O&&_.cancelChanges(),g(I)};for(let I=c.length-1;I>=0;I--){const[L,D,,W]=c[I],F=l.propToCol(D),ee=o.getCellMeta(L,F);ee.type==="numeric"&&typeof W=="string"&&dB(W)&&(c[I][3]=B(W)),o.getCellValidator(ee)&&(R.addValidatorToQueue(),o.validateCell(c[I][3],ee,function(ne,re){return function(ue){if(typeof ue!="boolean")throw new Error("Validation error: result is not boolean");if(ue===!1&&re.allowInvalid===!1){O=!1,c.splice(ne,1),re.valid=!0;const le=o.getCell(re.visualRow,re.visualCol);le!==null&&St(le,w.invalidCellClassName)}R.removeValidatorFormQueue()}}(I,ee),h))}R.checkIfQueueIsEmpty()}function me(c,h){let g=c.length-1;if(g<0)return;for(;g>=0;g--){let R=!1;if(c[g]===null){c.splice(g,1);continue}if(!((c[g][2]===null||c[g][2]===void 0)&&(c[g][3]===null||c[g][3]===void 0))){if(w.allowInsertRow)for(;c[g][0]>o.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:h});if(O===0){R=!0;break}}if(o.dataType==="array"&&(!w.columns||w.columns.length===0)&&w.allowInsertColumn)for(;l.propToCol(c[g][1])>o.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:h});if(O===0){R=!0;break}}R||l.set(c[g][0],c[g][1],c[g][3])}}o.forceFullRender=!0,u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",c,h),d.lockEditor(),o._refreshBorders(null),d.unlockEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",c,h||"edit");const _=o.getActiveEditor();_&&Se(_.refreshValue)&&_.refreshValue()}this._createCellCoords=function(c,h){return o.view._wt.createCellCoords(c,h)},this._createCellRange=function(c,h,g){return o.view._wt.createCellRange(c,h,g)},this.validateCell=function(c,h,g,_){let R=o.getCellValidator(h);function O(I){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||h.hidden===!0){g(I);return}const D=h.visualCol,W=h.visualRow,F=o.getCell(W,D,!0);if(F&&F.nodeName!=="TH"){const ee=o.rowIndexMapper.getRenderableFromVisualIndex(W),ne=o.columnIndexMapper.getRenderableFromVisualIndex(D);o.view._wt.getSetting("cellRenderer",ee,ne,F)}g(I)}nV(R)&&(R=function(I){return function(L,D){D(I.test(L))}}(R)),Je(R)?(c=o.runHooks("beforeValidate",c,h.visualRow,h.prop,_),o._registerImmediate(()=>{R.call(h,c,I=>{o&&(I=o.runHooks("afterValidate",I,c,h.visualRow,h.prop,_),h.valid=I,O(I),o.runHooks("postAfterValidate",I,c,h.visualRow,h.prop,_))})})):o._registerImmediate(()=>{h.valid=!0,O(h.valid,!1)})};function se(c,h,g){return Array.isArray(c)?c:[[c,h,g]]}function G(c,h){const g=o.getActiveEditor(),_=o.runHooks("beforeChange",c,h||"edit"),R=c.filter(O=>O!==null);return _===!1||R.length===0?(g&&g.cancelChanges(),[]):R}this.setDataAtCell=function(c,h,g,_){const R=se(c,h,g),O=[];let I=_,L,D,W;for(L=0,D=R.length;L<D;L++){if(typeof R[L]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[L][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[L][1]>=this.countCols()?W=R[L][1]:W=l.colToProp(R[L][1]),O.push([R[L][0],W,a.getAtCell(this.toPhysicalRow(R[L][0]),R[L][1]),R[L][2]])}!I&&typeof c=="object"&&(I=h);const F=G(O,_);o.runHooks("afterSetDataAtCell",F,I),Q(F,I,()=>{me(F,I)})},this.setDataAtRowProp=function(c,h,g,_){const R=se(c,h,g),O=[];let I=_,L,D;for(L=0,D=R.length;L<D;L++)O.push([R[L][0],R[L][1],a.getAtCell(this.toPhysicalRow(R[L][0]),R[L][1]),R[L][2]]);!I&&typeof c=="object"&&(I=h);const W=G(O,_);o.runHooks("afterSetDataAtRowProp",W,I),Q(W,I,()=>{me(W,I)})},this.listen=function(){o&&!o.isListening()&&(dm.forEach(c=>{o!==c&&c.unlisten()}),cm=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(cm=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return cm===o.guid},this.destroyEditor=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o._refreshBorders(c,h)},this.populateFromArray=function(c,h,g,_,R,O,I){if(!(typeof g=="object"&&typeof g[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const L=typeof _=="number"?o._createCellCoords(_,R):null;return u.populateFromArray(o._createCellCoords(c,h),g,L,O,I)},this.spliceCol=function(c,h,g){for(var _=arguments.length,R=new Array(_>3?_-3:0),O=3;O<_;O++)R[O-3]=arguments[O];return l.spliceCol(c,h,g,...R)},this.spliceRow=function(c,h,g){for(var _=arguments.length,R=new Array(_>3?_-3:0),O=3;O<_;O++)R[O-3]=arguments[O];return l.spliceRow(c,h,g,...R)},this.getSelected=function(){if(y.isSelected())return Lo(y.getSelectedRange(),c=>{let{from:h,to:g}=c;return[h.row,h.col,g.row,g.col]})},this.getSelectedLast=function(){const c=this.getSelected();let h;return c&&c.length>0&&(h=c[c.length-1]),h},this.getSelectedRange=function(){if(y.isSelected())return Array.from(y.getSelectedRange())},this.getSelectedRangeLast=function(){const c=this.getSelectedRange();let h;return c&&c.length>0&&(h=c[c.length-1]),h},this.emptySelectedCells=function(c){if(!y.isSelected()||this.countRows()===0||this.countCols()===0)return;const h=[];ge(y.getSelectedRange(),g=>{if(g.isSingleHeader())return;const _=g.getTopStartCorner(),R=g.getBottomEndCorner();qr(_.row,R.row,O=>{qr(_.col,R.col,I=>{this.getCellMeta(O,I).readOnly||h.push([O,I,null])})})}),h.length>0&&this.setDataAtCell(h,c)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const c=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(c,0),!this.isRenderSuspended()&&c===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(c){this.suspendRender();const h=c();return this.resumeRender(),h},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const h=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(h,0),(!this.isExecutionSuspended()&&h===this.executionSuspendedCounter||c)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const g=c();return this.resumeExecution(h),g},this.batch=function(c){this.suspendRender(),this.suspendExecution();const h=c();return this.resumeExecution(),this.resumeRender(),h},this.refreshDimensions=function(){if(!o.view)return;const{width:c,height:h}=o.view.getLastSize(),{width:g,height:_}=o.rootElement.getBoundingClientRect(),R=g!==c||_!==h;o.runHooks("beforeRefreshDimensions",{width:c,height:h},{width:g,height:_},R)!==!1&&((R||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(g,_),o.render()),o.runHooks("afterRefreshDimensions",{width:c,height:h},{width:g,height:_},R))},this.updateData=function(c,h){r0(c,g=>{l=g},g=>{l=g,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols()},{hotInstance:o,dataMap:l,dataSource:a,internalSource:"updateData",source:h,metaManager:H,firstRun:p})},this.loadData=function(c,h){r0(c,g=>{l=g},()=>{H.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),p&&(p=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:a,internalSource:"loadData",source:h,metaManager:H,firstRun:p})},this.getInitialColumnCount=function(){const c=w.columns;let h=0;if(Array.isArray(c))h=c.length;else if(Je(c))if(o.dataType==="array"){const g=this.countSourceCols();for(let _=0;_<g;_+=1)c(_)&&(h+=1)}else(o.dataType==="object"||o.dataType==="function")&&(h=l.colToPropCache.length);else if(Se(w.dataSchema)){const g=l.getSchema();h=Array.isArray(g)?g.length:Fw(g)}else h=this.countSourceCols();return h},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(c,h,g,_){return Sr(c)?l.getAll():l.getRange(o._createCellCoords(c,h),o._createCellCoords(g,_),l.DESTINATION_RENDERER)},this.getCopyableText=function(c,h,g,_){return l.getCopyableText(o._createCellCoords(c,h),o._createCellCoords(g,_))},this.getCopyableData=function(c,h){return l.getCopyable(c,l.colToProp(h))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const g=(p?o.loadData:o.updateData).bind(this);let _=!1,R,O;if(Se(c.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Se(c.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Se(c.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in c)R==="data"||(R==="language"?M(c.language):R==="className"?U("className",c.className):R==="tableClassName"&&o.table?(U("tableClassName",c.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):vr.getSingleton().isRegistered(R)||vr.getSingleton().isDeprecated(R)?(Je(c[R])||Array.isArray(c[R]))&&(c[R].initialHook=!0,o.addHook(R,c[R])):!h&&Ks(c,R)&&(v[R]=c[R]));c.data===void 0&&w.data===void 0?g(null,"updateSettings"):c.data!==void 0?g(c.data,"updateSettings"):c.columns!==void 0&&(l.createMap(),o.initIndexMappers());const I=o.countCols(),L=w.columns;if(L&&Je(L)&&(_=!0),(c.cell!==void 0||c.cells!==void 0||c.columns!==void 0)&&H.clearCache(),I>0)for(R=0,O=0;R<I;R++){if(L){const F=_?L(R):L[O];F&&H.updateColumnMeta(O,F)}O+=1}Se(c.cell)&&Ye(c.cell,F=>{o.setCellMetaObject(F.row,F.col,F)}),o.runHooks("afterCellMetaReset");let D=o.rootElement.style.height;D!==""&&(D=parseInt(o.rootElement.style.height,10));let W=c.height;if(Je(W)&&(W=W()),h&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),W===null){const F=o.rootElement.getAttribute("data-initialstyle");F&&(F.indexOf("height")>-1||F.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",F):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else W!==void 0&&(o.rootElement.style.height=isNaN(W)?`${W}`:`${W}px`,o.rootElement.style.overflow="hidden");if(typeof c.width<"u"){let F=c.width;Je(F)&&(F=F()),o.rootElement.style.width=isNaN(F)?`${F}`:`${F}px`}h||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",c)),u.adjustRowsAndCols(),o.view&&!p&&(o.forceFullRender=!0,d.lockEditor(),o._refreshBorders(null),o.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!h&&o.view&&(D===""||W===""||W===void 0)&&D!==W&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const c=o.getSelectedLast();if(w.getValue){if(Je(w.getValue))return w.getValue.call(o);if(c)return o.getData()[c[0][0]][w.getValue]}else if(c)return o.getDataAtCell(c[0],c[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(c,h,g,_,R){u.alter(c,h,g,_,R)},this.getCell=function(c,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,_=h,R=c;if(h>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(h)))return null;_=this.columnIndexMapper.getRenderableFromVisualIndex(h)}if(c>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(c)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(c)}return R===null||_===null?null:o.view.getCellAtCoords(o._createCellCoords(R,_),g)},this.getCoords=function(c){const h=this.view._wt.wtTable.getCoords(c);if(h===null)return null;const{row:g,col:_}=h;let R=g,O=_;return g>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(g)),_>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(_)),o._createCellCoords(R,O)},this.colToProp=function(c){return l.colToProp(c)},this.propToCol=function(c){return l.propToCol(c)},this.toVisualRow=c=>this.rowIndexMapper.getVisualFromPhysicalIndex(c),this.toVisualColumn=c=>this.columnIndexMapper.getVisualFromPhysicalIndex(c),this.toPhysicalRow=c=>this.rowIndexMapper.getPhysicalFromVisualIndex(c),this.toPhysicalColumn=c=>this.columnIndexMapper.getPhysicalFromVisualIndex(c),this.getDataAtCell=function(c,h){return l.get(c,l.colToProp(h))},this.getDataAtRowProp=function(c,h){return l.get(c,h)},this.getDataAtCol=function(c){const h=[],g=l.getRange(o._createCellCoords(0,c),o._createCellCoords(w.data.length-1,c),l.DESTINATION_RENDERER);for(let _=0;_<g.length;_+=1)for(let R=0;R<g[_].length;R+=1)h.push(g[_][R]);return h},this.getDataAtProp=function(c){const h=[],g=l.getRange(o._createCellCoords(0,l.propToCol(c)),o._createCellCoords(w.data.length-1,l.propToCol(c)),l.DESTINATION_RENDERER);for(let _=0;_<g.length;_+=1)for(let R=0;R<g[_].length;R+=1)h.push(g[_][R]);return h},this.getSourceData=function(c,h,g,_){let R;return c===void 0?R=a.getData():R=a.getByRange(o._createCellCoords(c,h),o._createCellCoords(g,_)),R},this.getSourceDataArray=function(c,h,g,_){let R;return c===void 0?R=a.getData(!0):R=a.getByRange(o._createCellCoords(c,h),o._createCellCoords(g,_),!0),R},this.getSourceDataAtCol=function(c){return a.getAtColumn(c)},this.setSourceDataAtCell=function(c,h,g,_){const R=se(c,h,g),O=this.hasHook("afterSetSourceDataAtCell"),I=[];O&&ge(R,D=>{let[W,F,ee]=D;I.push([W,F,a.getAtCell(W,F),ee])}),ge(R,D=>{let[W,F,ee]=D;a.setAtCell(W,F,ee)}),O&&this.runHooks("afterSetSourceDataAtCell",I,_),this.render();const L=o.getActiveEditor();L&&Se(L.refreshValue)&&L.refreshValue()},this.getSourceDataAtRow=function(c){return a.getAtRow(c)},this.getSourceDataAtCell=function(c,h){return a.getAtCell(c,h)},this.getDataAtRow=function(c){return l.getRange(o._createCellCoords(c,0),o._createCellCoords(c,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(c,h,g,_){const R=c===void 0?[0,0,this.countRows(),this.countCols()]:[c,h,g,_],[O,I]=R;let[,,L,D]=R,W=null,F=null;L===void 0&&(L=O),D===void 0&&(D=I);let ee="mixed";return qr(Math.max(Math.min(O,L),0),Math.max(O,L),ne=>{let re=!0;return qr(Math.max(Math.min(I,D),0),Math.max(I,D),ue=>(F=this.getCellMeta(ne,ue).type,W?re=W===F:W=F,re)),ee=re?F:"mixed",re}),ee},this.removeCellMeta=function(c,h,g){const[_,R]=[this.toPhysicalRow(c),this.toPhysicalColumn(h)];let O=H.getCellMetaKeyValue(_,R,g);o.runHooks("beforeRemoveCellMeta",c,h,g,O)!==!1&&(H.removeCellMeta(_,R,g),o.runHooks("afterRemoveCellMeta",c,h,g,O)),O=null},this.spliceCellsMeta=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var g=arguments.length,_=new Array(g>2?g-2:0),R=2;R<g;R++)_[R-2]=arguments[R];if(_.length>0&&!Array.isArray(_[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");h>0&&H.removeRow(this.toPhysicalRow(c),h),_.length>0&&ge(_.reverse(),O=>{H.createRow(this.toPhysicalRow(c)),ge(O,(I,L)=>this.setCellMetaObject(c,L,I))}),o.render()},this.setCellMetaObject=function(c,h,g){typeof g=="object"&&Ye(g,(_,R)=>{this.setCellMeta(c,h,R,_)})},this.setCellMeta=function(c,h,g,_){if(o.runHooks("beforeSetCellMeta",c,h,g,_)===!1)return;let O=c,I=h;c<this.countRows()&&(O=this.toPhysicalRow(c)),h<this.countCols()&&(I=this.toPhysicalColumn(h)),H.setCellMeta(O,I,g,_),o.runHooks("afterSetCellMeta",c,h,g,_)},this.getCellsMeta=function(){return H.getCellsMeta()},this.getCellMeta=function(c,h){let g=this.toPhysicalRow(c),_=this.toPhysicalColumn(h);return g===null&&(g=c),_===null&&(_=h),H.getCellMeta(g,_,{visualRow:c,visualColumn:h})},this.getCellMetaAtRow=function(c){return H.getCellsMetaAtRow(c)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||w.columns)},this.getCellRenderer=function(c,h){const g=typeof c=="number"?o.getCellMeta(c,h).renderer:c.renderer;return typeof g=="string"?kg(g):Sr(g)?kg("text"):g},this.getCellEditor=function(c,h){const g=typeof c=="number"?o.getCellMeta(c,h).editor:c.editor;return typeof g=="string"?Ag(g):Sr(g)?Ag("text"):g},this.getCellValidator=function(c,h){const g=typeof c=="number"?o.getCellMeta(c,h).validator:c.validator;return typeof g=="string"?AB(g):g},this.validateCells=function(c){this._validateCells(c)},this.validateRows=function(c,h){if(!Array.isArray(c))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(h,c)},this.validateColumns=function(c,h){if(!Array.isArray(c))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(h,void 0,c)},this._validateCells=function(c,h,g){const _=new Y;c&&(_.onQueueEmpty=c);let R=o.countRows()-1;for(;R>=0;){if(h!==void 0&&h.indexOf(R)===-1){R-=1;continue}let O=o.countCols()-1;for(;O>=0;){if(g!==void 0&&g.indexOf(O)===-1){O-=1;continue}_.addValidatorToQueue(),o.validateCell(o.getDataAtCell(R,O),o.getCellMeta(R,O),I=>{if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&(_.valid=!1),_.removeValidatorFormQueue()},"validateCells"),O-=1}R-=1}_.checkIfQueueIsEmpty()},this.getRowHeader=function(c){let h=w.rowHeaders,g=c;return g!==void 0&&(g=o.runHooks("modifyRowHeader",g)),g===void 0?(h=[],qr(o.countRows()-1,_=>{h.push(o.getRowHeader(_))})):Array.isArray(h)&&h[g]!==void 0?h=h[g]:Je(h)?h=h(g):h&&typeof h!="string"&&typeof h!="number"&&(h=g+1),h},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(w.colHeaders!==void 0&&w.colHeaders!==null)return!!w.colHeaders;for(let c=0,h=o.countCols();c<h;c++)if(o.getColHeader(c))return!0;return!1},this.getColHeader=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const g=o.runHooks("modifyColHeader",c);if(g===void 0){const L=[],D=o.countCols();for(let W=0;W<D;W++)L.push(o.getColHeader(W));return L}let _=w.colHeaders;const R=function(L){const D=[],W=o.countCols();let F=0;for(;F<W;F++)Je(w.columns)&&w.columns(F)&&D.push(F);return D[L]},O=o.toPhysicalColumn(g),I=R(O);return w.colHeaders===!1?_=null:w.columns&&Je(w.columns)&&w.columns(I)&&w.columns(I).title?_=w.columns(I).title:w.columns&&w.columns[O]&&w.columns[O].title?_=w.columns[O].title:Array.isArray(w.colHeaders)&&w.colHeaders[O]!==void 0?_=w.colHeaders[O]:Je(w.colHeaders)?_=w.colHeaders(O):w.colHeaders&&typeof w.colHeaders!="string"&&typeof w.colHeaders!="number"&&(_=Dj(g)),_=o.runHooks("modifyColumnHeaderValue",_,c,h),_},this._getColWidthFromSettings=function(c){let h;if(c>=0&&(h=o.getCellMeta(0,c).width),(h===void 0||h===w.width)&&(h=w.colWidths),h!=null){switch(typeof h){case"object":h=h[c];break;case"function":h=h(c);break}typeof h=="string"&&(h=parseInt(h,10))}return h},this.getColWidth=function(c){let h=o._getColWidthFromSettings(c);return h=o.runHooks("modifyColWidth",h,c),h===void 0&&(h=ch.DEFAULT_WIDTH),h},this._getRowHeightFromSettings=function(c){let h=w.rowHeights;if(h!=null){switch(typeof h){case"object":h=h[c];break;case"function":h=h(c);break}typeof h=="string"&&(h=parseInt(h,10))}return h},this.getRowHeight=function(c){let h=o._getRowHeightFromSettings(c);return h=o.runHooks("modifyRowHeight",h,c),h},this.countSourceRows=function(){return a.countRows()},this.countSourceCols=function(){return a.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const c=w.maxCols,h=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(c,h)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,h=0;return gS(o.countRows()-1,g=>{if(o.isEmptyRow(g))h+=1;else if(c===!0)return!1}),h},this.countEmptyCols=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,h=0;return gS(o.countCols()-1,g=>{if(o.isEmptyCol(g))h+=1;else if(c===!0)return!1}),h},this.isEmptyRow=function(c){return w.isEmptyRow.call(o,c)},this.isEmptyCol=function(c){return w.isEmptyCol.call(o,c)},this.selectCell=function(c,h,g,_){let R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Sr(c)||Sr(h)?!1:this.selectCells([[c,h,g,_]],R,O)},this.selectCells=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;h===!1&&m.suspend();const _=y.selectCells(c);return _&&g&&o.listen(),m.resume(),_},this.selectColumns=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c,g=arguments.length>2?arguments[2]:void 0;return y.selectColumns(c,h,g)},this.selectRows=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c,g=arguments.length>2?arguments[2]:void 0;return y.selectRows(c,h,g)},this.deselectCell=function(){y.deselect()},this.selectAll=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c,g=arguments.length>2?arguments[2]:void 0;m.skipNextScrollCycle(),y.selectAll(c,h,g)};const N=(c,h)=>c.getNearestNotHiddenIndex(h,1,!0);this.scrollViewportTo=function(c){var h;if(typeof c=="number"){var g;c={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(g=arguments[4])!==null&&g!==void 0?g:!0}}const{row:_,col:R,verticalSnap:O,horizontalSnap:I,considerHiddenIndexes:L}=(h=c)!==null&&h!==void 0?h:{};let D,W,F,ee;O!==void 0&&(D=O==="top",W=!D),I!==void 0&&(F=I==="start",ee=!F);let ne=_,re=R;if(L===void 0||L){const Ae=Number.isInteger(_)&&_>=0,ye=Number.isInteger(R)&&R>=0,he=Ae?N(this.rowIndexMapper,_):void 0,Oe=ye?N(this.columnIndexMapper,R):void 0;if(he===null||Oe===null)return!1;ne=Ae?o.rowIndexMapper.getRenderableFromVisualIndex(he):_,re=ye?o.columnIndexMapper.getRenderableFromVisualIndex(Oe):R}const ue=Number.isInteger(ne),le=Number.isInteger(re);return ue&&ne>=0&&le&&re>=0?o.view.scrollViewport(o._createCellCoords(ne,re),D,ee,W,F):ue&&ne>=0&&(le&&re<0||!le)?o.view.scrollViewportVertically(ne,D,W):le&&re>=0&&(ue&&ne<0||!ue)?o.view.scrollViewportHorizontally(re,ee,F):!1},this.scrollToFocusedCell=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",c);const{highlight:h}=this.getSelectedRangeLast();this.scrollViewportTo(h.toObject())?this.view.render():(this.removeHook("afterScroll",c),this._registerImmediate(()=>c()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),a&&a.destroy(),a=null,this.getShortcutManager().destroy(),H.clearCache(),dm.delete(this.guid),xc(o)){const c=this.rootDocument.querySelector(".hot-display-license-info");c&&c.parentNode.removeChild(c)}Ys(o.rootElement),s.destroy(),d&&d.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),E.getItems().forEach(c=>{let[,h]=c;h.destroy()}),E.clear(),o.runHooks("afterDestroy")},!0),vr.getSingleton().destroy(o),Ye(o,(c,h,g)=>{Je(c)?g[h]=A(h):h!=="guid"&&(g[h]=null)}),o.isDestroyed=!0,l&&l.destroy(),l=null,u=null,y=null,d=null,o=null};function A(c){return()=>{throw new Error(`The "${c}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(c){const h=Aw(c);return h==="UndoRedo"?this.undoRedo:E.getItem(h)},this.getPluginName=function(c){return c===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:E.getId(c)},this.getInstance=function(){return o},this.addHook=function(c,h){vr.getSingleton().add(c,h,o)},this.hasHook=function(c){return vr.getSingleton().has(c,o)||vr.getSingleton().has(c)},this.addHookOnce=function(c,h){vr.getSingleton().once(c,h,o)},this.removeHook=function(c,h){vr.getSingleton().remove(c,h,o)},this.runHooks=function(c,h,g,_,R,O,I){return vr.getSingleton().run(o,c,h,g,_,R,O,I)},this.getTranslatedPhrase=function(c,h){return z1(w.language,c,h)},this.toHTML=()=>mS(this),this.toTableElement=()=>{const c=this.rootDocument.createElement("div");return c.insertAdjacentHTML("afterbegin",mS(this)),c.firstElementChild},this.timeouts=[],this._registerTimeout=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,g=c;typeof g=="function"&&(g=setTimeout(g,h)),this.timeouts.push(g)},this._clearTimeouts=function(){ge(this.timeouts,c=>{clearTimeout(c)})},this.immediates=[],this._registerImmediate=function(c){this.immediates.push(setImmediate(c))},this._clearImmediates=function(){ge(this.immediates,c=>{clearImmediate(c)})},this._refreshBorders=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(c),o.view.render(),h&&y.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};const J=NY({handleEvent(){return o.isListening()},beforeKeyDown:c=>this.runHooks("beforeKeyDown",c),afterKeyDown:c=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",c)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",c=>{c.ctrlKey===!1&&c.metaKey===!1&&J.releasePressedKeys()}),this.getShortcutManager=function(){return J},this.getFocusManager=function(){return f},bB().forEach(c=>{const h=TB(c);E.addItem(c,new h(this))}),pY(o),J.setActiveContextName("grid"),vr.getSingleton().run(o,"construct")}const DY="hooksRefRegisterer",sO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){ge(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ye(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};so(sO,"MIXIN_NAME",DY,{writable:!1,enumerable:!1});function mn(t,e,r){return e=kY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kY(t){var e=LY(t,"string");return typeof e=="symbol"?e:e+""}function LY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const FY="base",yt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Yg="baseEditor";class hv{static get EDITOR_TYPE(){return FY}constructor(e){mn(this,"hot",void 0),mn(this,"state",yt.VIRGIN),mn(this,"_opened",!1),mn(this,"_fullEditMode",!1),mn(this,"_closeCallback",null),mn(this,"TD",null),mn(this,"row",null),mn(this,"col",null),mn(this,"prop",null),mn(this,"originalValue",null),mn(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=yt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const f=this.hot.getSelectedLast();n=Math.max(Math.min(f[0],f[2]),0),i=Math.max(Math.min(f[1],f[3]),0),o=Math.max(f[0],f[2]),s=Math.max(f[1],f[3])}else[n,i,o,s]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",n,i);Array.isArray(l)&&([n,i]=l);const u=this.hot.getShortcutManager().getContext("editor"),d={runOnlyIf:()=>Se(this.hot.getSelected()),group:Yg};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],d),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==yt.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(i,o)),this.state=yt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:sT(this.originalValue);this.setValue(s)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,r,n){let i;if(n){const l=this._closeCallback;this._closeCallback=a=>{l&&l(a),n(a),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(Yg),s.removeShortcutsByGroup($w),this.state===yt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===yt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const l=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof l=="string"?String.prototype.trim.call(l||""):l]]:i=[[l]],this.state=yt.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=yt.FINISHED,this.discardEditor(a)}):(this.state=yt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=yt.FINISHED,this.discardEditor()}discardEditor(e){this.state===yt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=yt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=yt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===yt.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Qr(r),l=It(r),a=Qr(this.hot.rootElement),u=It(this.hot.rootElement),d=n.topOverlay.holder,f=n.inlineStartOverlay.holder,m=d!==o?d.scrollTop:0,p=f!==o?f.scrollLeft:0,C=o.innerWidth-a.left-u,{wtTable:S}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,H=S.name,w=["master","inline_start"].includes(H)?m:0,v=["master","top","bottom"].includes(H)?p:0,E=s.top===a.top?0:1;let x=s.top-a.top-E-w,$=0;this.hot.isRtl()?$=o.innerWidth-s.left-l-C-1+v:$=s.left-a.left-1-v,["top","top_inline_start_corner"].includes(H)&&(x+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(H)&&($+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const k=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),M=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(k&&P<=0||P===M)&&(x+=1),y<=0&&($+=1);const U=i.rowsRenderCalculator.startPosition,Y=i.columnsRenderCalculator.startPosition,B=Math.abs(n.inlineStartOverlay.getScrollPosition()),Q=n.topOverlay.getScrollPosition(),me=nr(this.hot.rootDocument);let se=r.offsetTop;if(["inline_start","master"].includes(H)&&(se+=U-Q),["bottom","bottom_inline_start_corner"].includes(H)){const{wtViewport:L,wtTable:D}=n.bottomOverlay.clone;se+=L.getWorkspaceHeight()-D.getHeight()-me}let G=r.offsetLeft;this.hot.isRtl()?(G>=0?G=S.getWidth()-r.offsetLeft:G=Math.abs(G),G+=Y-B-l):["top","master","bottom"].includes(H)&&(G+=Y-B);const N=to(this.TD,this.hot.rootWindow),A=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",J=parseInt(N[A],10)>0?0:1,c=parseInt(N.borderTopWidth,10)>0?0:1,h=It(r)+J,g=en(r)+c,_=OV(d)?me:0,R=xV(f)?me:0,O=this.hot.view.maximumVisibleElementWidth(G)-_+J,I=Math.max(this.hot.view.maximumVisibleElementHeight(se)-R+c,23);return{top:x,start:$,height:g,maxHeight:I,width:h,maxWidth:O}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}mt(hv,sO);function l0(t,e,r){t.addEventListener(e,r,!1)}function a0(t,e,r){t.removeEventListener(e,r,!1)}function u0(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function $Y(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=t.body,n=t.createTextNode(""),i=t.createElement("span");let o;function s(){n.textContent=o.value,i.style.position="absolute",i.style.fontSize=u0(o).fontSize,i.style.fontFamily=u0(o).fontFamily,i.style.whiteSpace="pre",r.appendChild(i);const d=i.clientWidth+2;r.removeChild(i);const f=o.style;f.height=`${e.minHeight}px`,e.minWidth>d?f.width=`${e.minWidth}px`:d>e.maxWidth?f.width=`${e.maxWidth}px`:f.width=`${d}px`;const m=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>m?f.height=`${e.minHeight}px`:e.maxHeight<m?(f.height=`${e.maxHeight}px`,f.overflowY="visible"):f.height=`${m}px`}function l(){t.defaultView.setTimeout(s,0)}function a(d){if(d&&d.minHeight)if(d.minHeight==="inherit")e.minHeight=o.clientHeight;else{const f=parseInt(d.minHeight,10);isNaN(f)||(e.minHeight=f)}if(d&&d.maxHeight)if(d.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const f=parseInt(d.maxHeight,10);isNaN(f)||(e.maxHeight=f)}if(d&&d.minWidth)if(d.minWidth==="inherit")e.minWidth=o.clientWidth;else{const f=parseInt(d.minWidth,10);isNaN(f)||(e.minWidth=f)}if(d&&d.maxWidth)if(d.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const f=parseInt(d.maxWidth,10);isNaN(f)||(e.maxWidth=f)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))}function u(d,f){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=d,a(f),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),m&&(l0(o,"input",s),l0(o,"keydown",l)),s()}return{init:u,resize:s,unObserve(){a0(o,"input",s),a0(o,"keydown",l)}}}function c0(t,e){const r=TV(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const l=n[s];s!==0&&(o+=n[s-1].length+1);const a=o+l.length;if(t==="home"?i=o:t==="end"&&(i=a),r<=a)break}CT(e,i)}function So(t,e,r){return e=VY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VY(t){var e=WY(t,"string");return typeof e=="symbol"?e:e+""}function WY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const BY="ht_editor_visible",sc="ht_editor_hidden",d0="textEditor",zY="text";class jY extends hv{static get EDITOR_TYPE(){return zY}constructor(e){super(e),So(this,"eventManager",new Qs(this)),So(this,"autoResize",$Y(this.hot.rootDocument)),So(this,"TEXTAREA",void 0),So(this,"textareaStyle",void 0),So(this,"TEXTAREA_PARENT",void 0),So(this,"textareaParentStyle",void 0),So(this,"layerClass",void 0),this.eventManager=new Qs(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),vV(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const l=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:a}=s;a&&(this.TEXTAREA.value=""),l!==yt.FINISHED&&this.hideEditableElement()}}beginEditing(e,r){this.state===yt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),CT(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),rt(this.TEXTAREA,[["data-hot-input",""],ih(-1)]),this.hot.getSettings().ariaTags&&rt(this.TEXTAREA,[uT()]),Ne(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Ne(this.TEXTAREA_PARENT,"handsontableInputHolder"),ot(this.TEXTAREA_PARENT,this.layerClass)&&St(this.TEXTAREA_PARENT,this.layerClass),Ne(this.TEXTAREA_PARENT,sc),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){nW()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",St(this.TEXTAREA_PARENT,this.layerClass),Ne(this.TEXTAREA_PARENT,sc)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;qr(e.length-1,n=>{const i=e[n];if(ot(i,"handsontableEditor"))return r=!0,!1}),ot(this.TEXTAREA_PARENT,sc)&&St(this.TEXTAREA_PARENT,sc),r?(this.layerClass=BY,Ne(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ne(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==yt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const a=to(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=to(this.TEXTAREA),d=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),f=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),m=i-d,p=s-f,C=o-d,S=l-f;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(m,C),minHeight:Math.min(p,S),maxWidth:C,maxHeight:S},!0)}bindEvents(){xT()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===yt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===yt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("editor"),n=e.getContext("grid"),i={runOnlyIf:()=>Se(this.hot.getSelected()),group:d0},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:n,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,l)=>{let[a]=l;c0(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,l)=>{let[a]=l;c0(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");r.removeShortcutsByGroup($w),r.removeShortcutsByGroup(d0),r.removeShortcutsByGroup(Yg)}}const UY="base";function lO(t,e,r,n,i,o,s){const l=s.ariaTags,a=[],u=[],d=[],f=[];s.className&&Ne(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&f.push(KC())):l&&d.push(KC()[0]),s.valid===!1&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&f.push(XC())):(u.push(s.invalidCellClassName),l&&d.push(XC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!o&&s.placeholder&&a.push(s.placeholderCellClassName),St(e,u),Ne(e,a),Xa(e,d),rt(e,f)}lO.RENDERER_TYPE=UY;const YY="text";function aO(t,e,r,n,i,o,s){lO.apply(this,[t,e,r,n,i,o,s]);let l=o;if(!l&&s.placeholder&&(l=s.placeholder),l=sT(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){Ys(e);const a=t.rootDocument.createElement("TEMPLATE");a.setAttribute("bind","{{}}"),a.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(a),a.model=t.getSourceDataAtRow(r),e.appendChild(a)}else Qa(e,l)}aO.RENDERER_TYPE=YY;const GY="text",KY={CELL_TYPE:GY,editor:jY,renderer:aO};JU(KY);Ee.editors={BaseEditor:hv};function Ee(t,e){const r=new oO(t,e||{},sv);return r.init(),r}Ee.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new oO(t,e,sv)};Ee.DefaultSettings=Z1();Ee.hooks=vr.getSingleton();Ee.CellCoords=Fo;Ee.CellRange=Za;Ee.packageName="handsontable";Ee.buildDate="16/04/2024 10:23:22";Ee.version="14.3.0";Ee.languages={dictionaryKeys:mU,getLanguageDictionary:B1,getLanguagesDictionaries:yU,registerLanguageDictionary:W1,getTranslatedPhrase:z1};function Aa(t,e,r){return e=Rd(e),t4(t,uO()?Reflect.construct(e,r||[],Rd(t).constructor):e.apply(t,r))}function uO(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uO=function(){return!!t})()}function h0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function XY(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?h0(Object(r),!0).forEach(function(n){qY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function cO(t){var e=QY(t,"string");return typeof e=="symbol"?e:e+""}function Na(t){"@babel/helpers - typeof";return Na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Na(t)}function qs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f0(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cO(n.key),n)}}function Zs(t,e,r){return e&&f0(t.prototype,e),r&&f0(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qY(t,e,r){return e=cO(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Da(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gg(t,e)}function Rd(t){return Rd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rd(t)}function Gg(t,e){return Gg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Gg(t,e)}function ZY(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function JY(t,e){if(t==null)return{};var r=ZY(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function e4(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function t4(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e4(t)}function r4(t){return n4(t)||i4(t)||o4(t)||s4()}function n4(t){if(Array.isArray(t))return Kg(t)}function i4(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function o4(t,e){if(t){if(typeof t=="string")return Kg(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kg(t,e)}}function Kg(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hm=null,l4="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",a4="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Ed="global",u4="hot-wrapper-editor-container";function c4(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function Xg(t,e){var r=et.Children.toArray(t),n=et.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(o){return o.props[e]!==void 0})),i||null}function dO(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function hO(t,e){if(typeof t>"u"||e===null)return null;var r=mO(e.props,!1);return r.className="".concat(u4," ").concat(r.className),xE.createPortal(et.createElement("div",Object.assign({},r),e),t.body)}function fO(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ed,n=Xg(t,"hot-editor"),i=dO(n);return n?et.cloneElement(n,{emitEditorInstance:function(s,l){e.get(i)||e.set(i,new Map);var a=e.get(i);a.set(l??Ed,s)},editorColumnScope:r,isEditor:!0}):null}function d4(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;r||(r=document),hm||(hm=r.createDocumentFragment());var o=i??r.createElement("DIV");hm.appendChild(o);var s=et.cloneElement(t,XY({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:xE.createPortal(s,o,n),portalContainer:o}}function mO(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function h4(){return typeof window<"u"}var gO=function(){function t(){qs(this,t)}return Zs(t,null,[{key:"getSettings",value:function(r){var n={};if(r.settings){var i=r.settings;for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}for(var s in r)s!=="settings"&&s!=="children"&&r.hasOwnProperty(s)&&(n[s]=r[s]);return n}}])}(),f4=function(t){function e(){return qs(this,e),Aa(this,e,arguments)}return Da(e,t),Zs(e,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!n.internalProps.includes(i)}).reduce(function(i,o){return i[o]=n.props[o],i},{})}},{key:"getLocalEditorElement",value:function(){return fO(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=gO.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),i=hO(n,this.getLocalEditorElement());return et.createElement(et.Fragment,null,i)}}])}(et.Component),m4=function(t){function e(){var r;return qs(this,e),r=Aa(this,e,arguments),r.state={portals:[]},r}return Da(e,t),Zs(e,[{key:"render",value:function(){return et.createElement(et.Fragment,null,this.state.portals)}}])}(et.Component),g4="14.3.0";function fv(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pt=typeof Symbol=="function"&&Symbol.for,mv=Pt?Symbol.for("react.element"):60103,gv=Pt?Symbol.for("react.portal"):60106,mh=Pt?Symbol.for("react.fragment"):60107,gh=Pt?Symbol.for("react.strict_mode"):60108,ph=Pt?Symbol.for("react.profiler"):60114,wh=Pt?Symbol.for("react.provider"):60109,vh=Pt?Symbol.for("react.context"):60110,pv=Pt?Symbol.for("react.async_mode"):60111,yh=Pt?Symbol.for("react.concurrent_mode"):60111,Ch=Pt?Symbol.for("react.forward_ref"):60112,Sh=Pt?Symbol.for("react.suspense"):60113,p4=Pt?Symbol.for("react.suspense_list"):60120,Rh=Pt?Symbol.for("react.memo"):60115,Eh=Pt?Symbol.for("react.lazy"):60116,w4=Pt?Symbol.for("react.block"):60121,v4=Pt?Symbol.for("react.fundamental"):60117,y4=Pt?Symbol.for("react.responder"):60118,C4=Pt?Symbol.for("react.scope"):60119;function $r(t){if(Na(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case mv:switch(t=t.type,t){case pv:case yh:case mh:case ph:case gh:case Sh:return t;default:switch(t=t&&t.$$typeof,t){case vh:case Ch:case Eh:case Rh:case wh:return t;default:return e}}case gv:return e}}}function pO(t){return $r(t)===yh}var S4=pv,R4=yh,E4=vh,b4=wh,T4=mv,_4=Ch,O4=mh,x4=Eh,M4=Rh,I4=gv,H4=ph,P4=gh,A4=Sh,N4=function(e){return pO(e)||$r(e)===pv},D4=pO,k4=function(e){return $r(e)===vh},L4=function(e){return $r(e)===wh},F4=function(e){return Na(e)==="object"&&e!==null&&e.$$typeof===mv},$4=function(e){return $r(e)===Ch},V4=function(e){return $r(e)===mh},W4=function(e){return $r(e)===Eh},B4=function(e){return $r(e)===Rh},z4=function(e){return $r(e)===gv},j4=function(e){return $r(e)===ph},U4=function(e){return $r(e)===gh},Y4=function(e){return $r(e)===Sh},G4=function(e){return typeof e=="string"||typeof e=="function"||e===mh||e===yh||e===ph||e===gh||e===Sh||e===p4||Na(e)==="object"&&e!==null&&(e.$$typeof===Eh||e.$$typeof===Rh||e.$$typeof===wh||e.$$typeof===vh||e.$$typeof===Ch||e.$$typeof===v4||e.$$typeof===y4||e.$$typeof===C4||e.$$typeof===w4)},K4=$r,X4={AsyncMode:S4,ConcurrentMode:R4,ContextConsumer:E4,ContextProvider:b4,Element:T4,ForwardRef:_4,Fragment:O4,Lazy:x4,Memo:M4,Portal:I4,Profiler:H4,StrictMode:P4,Suspense:A4,isAsyncMode:N4,isConcurrentMode:D4,isContextConsumer:k4,isContextProvider:L4,isElement:F4,isForwardRef:$4,isFragment:V4,isLazy:W4,isMemo:B4,isPortal:z4,isProfiler:j4,isStrictMode:U4,isSuspense:Y4,isValidElementType:G4,typeOf:K4},Fe=fv(function(t,e){});Fe.AsyncMode;Fe.ConcurrentMode;Fe.ContextConsumer;Fe.ContextProvider;Fe.Element;Fe.ForwardRef;Fe.Fragment;Fe.Lazy;Fe.Memo;Fe.Portal;Fe.Profiler;Fe.StrictMode;Fe.Suspense;Fe.isAsyncMode;Fe.isConcurrentMode;Fe.isContextConsumer;Fe.isContextProvider;Fe.isElement;Fe.isForwardRef;Fe.isFragment;Fe.isLazy;Fe.isMemo;Fe.isPortal;Fe.isProfiler;Fe.isStrictMode;Fe.isSuspense;Fe.isValidElementType;Fe.typeOf;fv(function(t){t.exports=X4});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var m0=Object.getOwnPropertySymbols,Q4=Object.prototype.hasOwnProperty,q4=Object.prototype.propertyIsEnumerable;function Z4(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function J4(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}J4();var e6="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",t6=e6;Function.call.bind(Object.prototype.hasOwnProperty);function wO(){}function vO(){}vO.resetWarningCache=wO;var r6=function(){function e(i,o,s,l,a,u){if(u!==t6){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function r(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:vO,resetWarningCache:wO};return n.PropTypes=n,n},fm=fv(function(t){t.exports=r6()}),wv=function(t){function e(){var r;return qs(this,e),r=Aa(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return Da(e,t),Zs(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(a4),null)},set:function(n){this.__hotInstance=n}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return h4()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var i=this;return function(s,l,a,u,d,f,m){var p=i.getRenderedCellCache(),C=i.getPortalContainerCache(),S="".concat(a,"-").concat(u),H=s.guid,w="".concat(H,"-").concat(S),v="".concat(S,"-").concat(H);if(p.has(S)&&(l.innerHTML=p.get(S).innerHTML),l&&!l.getAttribute("ghost-table")){for(var E=i.portalCache.get(v),x=C.get(w);l.firstChild;)l.removeChild(l.firstChild);if(E&&x)l.appendChild(x);else{var $=d4(n,{TD:l,row:a,col:u,prop:d,value:f,cellProperties:m,isRenderer:!0},l.ownerDocument,v,x),k=$.portal,P=$.portalContainer;C.set(w,P),l.appendChild(P),i.portalCache.set(v,k)}}return p.set(S,l),l}}},{key:"getEditorClass",value:function(n){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ed,s=dO(n),l=(i=this.getEditorCache().get(s))===null||i===void 0?void 0:i.get(o);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(n){var i=function(o){function s(l){var a;return qs(this,s),a=Aa(this,s,[l]),n.hotCustomEditorInstance=a,a.editorComponent=n,a}return Da(s,o),Zs(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Ee.editors.BaseEditor);return Object.getOwnPropertyNames(Ee.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(i.prototype[o]=function(){for(var s,l=arguments.length,a=new Array(l),u=0;u<l;u++)a[u]=arguments[u];return(s=n[o]).call.apply(s,[n].concat(a))})}),i}},{key:"getGlobalRendererElement",value:function(){return Xg(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return fO(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n=gO.getSettings(this.props),i=this.getGlobalRendererElement(),o=this.getGlobalEditorElement();if(n.columns=this.columnSettings.length?this.columnSettings:n.columns,o)n.editor=this.getEditorClass(o,Ed);else{var s;this.props.editor||(s=this.props.settings)!==null&&s!==void 0&&s.editor?n.editor=this.props.editor||this.props.settings.editor:n.editor=Ag("text")}if(i)n.renderer=this.getRendererWrapper(i),this.componentRendererColumns.set("global",!0);else{var l;this.props.renderer||(l=this.props.settings)!==null&&l!==void 0&&l.renderer?n.renderer=this.props.renderer||this.props.settings.renderer:n.renderer=kg("text")}return n}},{key:"displayAutoSizeWarning",value:function(n){var i,o;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&c4(l4)}},{key:"setHotColumnSettings",value:function(n,i){this.columnSettings[i]=n}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:r4(this.portalCache.values())})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,i=this.createNewGlobalSettings();this.hotInstance=new Ee.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(){this.clearCache();var n=this.createNewGlobalSettings();this.updateHot(n),this.displayAutoSizeWarning(n)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,i=function(d){return d.type===f4},o=et.Children.toArray(this.props.children),s=o.filter(function(u){return i(u)}).map(function(u,d){return et.cloneElement(u,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:d,_getChildElementByType:Xg.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:u.props.children})}),l=mO(this.props),a=hO(this.getOwnerDocument(),this.getGlobalEditorElement());return et.createElement(et.Fragment,null,et.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},l),s),et.createElement(m4,{ref:this.setRenderersPortalManagerRef.bind(this)}),a)}}],[{key:"version",get:function(){return g4}}])}(et.Component);wv.propTypes={style:fm.object,id:fm.string,className:fm.string};var n6=["children"],yO=et.forwardRef(function(t,e){var r,n=t.children,i=JY(t,n6),o=typeof et.useId=="function"?et.useId():void 0,s=(r=i.id)!==null&&r!==void 0?r:o;return et.createElement(wv,Object.assign({id:s},i,{ref:e}),n)});yO.version=wv.version;et.Component;var CO={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){(function(r,n){t.exports=n()})(Vl,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,s={},l=0,a={parse:function(y,b){var M=(b=b||{}).dynamicTyping||!1;if(P(M)&&(b.dynamicTypingFunction=M,M={}),b.dynamicTyping=M,b.transform=!!P(b.transform)&&b.transform,b.worker&&a.WORKERS_SUPPORTED){var U=function(){if(!a.WORKERS_SUPPORTED)return!1;var B=(me=n.URL||n.webkitURL||null,se=r.toString(),a.BLOB_URL||(a.BLOB_URL=me.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",se,")();"],{type:"text/javascript"})))),Q=new n.Worker(B),me,se;return Q.onmessage=v,Q.id=l++,s[Q.id]=Q}();return U.userStep=b.step,U.userChunk=b.chunk,U.userComplete=b.complete,U.userError=b.error,b.step=P(b.step),b.chunk=P(b.chunk),b.complete=P(b.complete),b.error=P(b.error),delete b.worker,void U.postMessage({input:y,config:b,workerId:U.id})}var Y=null;return a.NODE_STREAM_INPUT,typeof y=="string"?(y=function(B){return B.charCodeAt(0)===65279?B.slice(1):B}(y),Y=b.download?new f(b):new p(b)):y.readable===!0&&P(y.read)&&P(y.on)?Y=new C(b):(n.File&&y instanceof File||y instanceof Object)&&(Y=new m(b)),Y.stream(y)},unparse:function(y,b){var M=!1,U=!0,Y=",",B=`\r
`,Q='"',me=Q+Q,se=!1,G=null,N=!1;(function(){if(typeof b=="object"){if(typeof b.delimiter!="string"||a.BAD_DELIMITERS.filter(function(h){return b.delimiter.indexOf(h)!==-1}).length||(Y=b.delimiter),(typeof b.quotes=="boolean"||typeof b.quotes=="function"||Array.isArray(b.quotes))&&(M=b.quotes),typeof b.skipEmptyLines!="boolean"&&typeof b.skipEmptyLines!="string"||(se=b.skipEmptyLines),typeof b.newline=="string"&&(B=b.newline),typeof b.quoteChar=="string"&&(Q=b.quoteChar),typeof b.header=="boolean"&&(U=b.header),Array.isArray(b.columns)){if(b.columns.length===0)throw new Error("Option columns is empty");G=b.columns}b.escapeChar!==void 0&&(me=b.escapeChar+Q),(typeof b.escapeFormulae=="boolean"||b.escapeFormulae instanceof RegExp)&&(N=b.escapeFormulae instanceof RegExp?b.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var A=new RegExp(H(Q),"g");if(typeof y=="string"&&(y=JSON.parse(y)),Array.isArray(y)){if(!y.length||Array.isArray(y[0]))return J(null,y,se);if(typeof y[0]=="object")return J(G||Object.keys(y[0]),y,se)}else if(typeof y=="object")return typeof y.data=="string"&&(y.data=JSON.parse(y.data)),Array.isArray(y.data)&&(y.fields||(y.fields=y.meta&&y.meta.fields||G),y.fields||(y.fields=Array.isArray(y.data[0])?y.fields:typeof y.data[0]=="object"?Object.keys(y.data[0]):[]),Array.isArray(y.data[0])||typeof y.data[0]=="object"||(y.data=[y.data])),J(y.fields||[],y.data||[],se);throw new Error("Unable to serialize unrecognized input");function J(h,g,_){var R="";typeof h=="string"&&(h=JSON.parse(h)),typeof g=="string"&&(g=JSON.parse(g));var O=Array.isArray(h)&&0<h.length,I=!Array.isArray(g[0]);if(O&&U){for(var L=0;L<h.length;L++)0<L&&(R+=Y),R+=c(h[L],L);0<g.length&&(R+=B)}for(var D=0;D<g.length;D++){var W=O?h.length:g[D].length,F=!1,ee=O?Object.keys(g[D]).length===0:g[D].length===0;if(_&&!O&&(F=_==="greedy"?g[D].join("").trim()==="":g[D].length===1&&g[D][0].length===0),_==="greedy"&&O){for(var ne=[],re=0;re<W;re++){var ue=I?h[re]:re;ne.push(g[D][ue])}F=ne.join("").trim()===""}if(!F){for(var le=0;le<W;le++){0<le&&!ee&&(R+=Y);var Ae=O&&I?h[le]:le;R+=c(g[D][Ae],le)}D<g.length-1&&(!_||0<W&&!ee)&&(R+=B)}}return R}function c(h,g){if(h==null)return"";if(h.constructor===Date)return JSON.stringify(h).slice(1,25);var _=!1;N&&typeof h=="string"&&N.test(h)&&(h="'"+h,_=!0);var R=h.toString().replace(A,me);return(_=_||M===!0||typeof M=="function"&&M(h,g)||Array.isArray(M)&&M[g]||function(O,I){for(var L=0;L<I.length;L++)if(-1<O.indexOf(I[L]))return!0;return!1}(R,a.BAD_DELIMITERS)||-1<R.indexOf(Y)||R.charAt(0)===" "||R.charAt(R.length-1)===" ")?Q+R+Q:R}}};if(a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!i&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=w,a.ParserHandle=S,a.NetworkStreamer=f,a.FileStreamer=m,a.StringStreamer=p,a.ReadableStreamStreamer=C,n.jQuery){var u=n.jQuery;u.fn.parse=function(y){var b=y.config||{},M=[];return this.each(function(B){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Q=0;Q<this.files.length;Q++)M.push({file:this.files[Q],inputElem:this,instanceConfig:u.extend({},b)})}),U(),this;function U(){if(M.length!==0){var B,Q,me,se,G=M[0];if(P(y.before)){var N=y.before(G.file,G.inputElem);if(typeof N=="object"){if(N.action==="abort")return B="AbortError",Q=G.file,me=G.inputElem,se=N.reason,void(P(y.error)&&y.error({name:B},Q,me,se));if(N.action==="skip")return void Y();typeof N.config=="object"&&(G.instanceConfig=u.extend(G.instanceConfig,N.config))}else if(N==="skip")return void Y()}var A=G.instanceConfig.complete;G.instanceConfig.complete=function(J){P(A)&&A(J,G.file,G.inputElem),Y()},a.parse(G.file,G.instanceConfig)}else P(y.complete)&&y.complete()}function Y(){M.splice(0,1),U()}}}function d(y){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(b){var M=$(b);M.chunkSize=parseInt(M.chunkSize),b.step||b.chunk||(M.chunkSize=null),this._handle=new S(M),(this._handle.streamer=this)._config=M}).call(this,y),this.parseChunk=function(b,M){if(this.isFirstChunk&&P(this._config.beforeFirstChunk)){var U=this._config.beforeFirstChunk(b);U!==void 0&&(b=U)}this.isFirstChunk=!1,this._halted=!1;var Y=this._partialLine+b;this._partialLine="";var B=this._handle.parse(Y,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Q=B.meta.cursor;this._finished||(this._partialLine=Y.substring(Q-this._baseIndex),this._baseIndex=Q),B&&B.data&&(this._rowCount+=B.data.length);var me=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)n.postMessage({results:B,workerId:a.WORKER_ID,finished:me});else if(P(this._config.chunk)&&!M){if(this._config.chunk(B,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);B=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(B.data),this._completeResults.errors=this._completeResults.errors.concat(B.errors),this._completeResults.meta=B.meta),this._completed||!me||!P(this._config.complete)||B&&B.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),me||B&&B.meta.paused||this._nextChunk(),B}this._halted=!0},this._sendError=function(b){P(this._config.error)?this._config.error(b):o&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:b,finished:!1})}}function f(y){var b;(y=y||{}).chunkSize||(y.chunkSize=a.RemoteChunkSize),d.call(this,y),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(M){this._input=M,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(b=new XMLHttpRequest,this._config.withCredentials&&(b.withCredentials=this._config.withCredentials),i||(b.onload=k(this._chunkLoaded,this),b.onerror=k(this._chunkError,this)),b.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var M=this._config.downloadRequestHeaders;for(var U in M)b.setRequestHeader(U,M[U])}if(this._config.chunkSize){var Y=this._start+this._config.chunkSize-1;b.setRequestHeader("Range","bytes="+this._start+"-"+Y)}try{b.send(this._config.downloadRequestBody)}catch(B){this._chunkError(B.message)}i&&b.status===0&&this._chunkError()}},this._chunkLoaded=function(){b.readyState===4&&(b.status<200||400<=b.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:b.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(M){var U=M.getResponseHeader("Content-Range");return U===null?-1:parseInt(U.substring(U.lastIndexOf("/")+1))}(b),this.parseChunk(b.responseText)))},this._chunkError=function(M){var U=b.statusText||M;this._sendError(new Error(U))}}function m(y){var b,M;(y=y||{}).chunkSize||(y.chunkSize=a.LocalChunkSize),d.call(this,y);var U=typeof FileReader<"u";this.stream=function(Y){this._input=Y,M=Y.slice||Y.webkitSlice||Y.mozSlice,U?((b=new FileReader).onload=k(this._chunkLoaded,this),b.onerror=k(this._chunkError,this)):b=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Y=this._input;if(this._config.chunkSize){var B=Math.min(this._start+this._config.chunkSize,this._input.size);Y=M.call(Y,this._start,B)}var Q=b.readAsText(Y,this._config.encoding);U||this._chunkLoaded({target:{result:Q}})},this._chunkLoaded=function(Y){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Y.target.result)},this._chunkError=function(){this._sendError(b.error)}}function p(y){var b;d.call(this,y=y||{}),this.stream=function(M){return b=M,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var M,U=this._config.chunkSize;return U?(M=b.substring(0,U),b=b.substring(U)):(M=b,b=""),this._finished=!b,this.parseChunk(M)}}}function C(y){d.call(this,y=y||{});var b=[],M=!0,U=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Y){this._input=Y,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){U&&b.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),b.length?this.parseChunk(b.shift()):M=!0},this._streamData=k(function(Y){try{b.push(typeof Y=="string"?Y:Y.toString(this._config.encoding)),M&&(M=!1,this._checkIsFinished(),this.parseChunk(b.shift()))}catch(B){this._streamError(B)}},this),this._streamError=k(function(Y){this._streamCleanUp(),this._sendError(Y)},this),this._streamEnd=k(function(){this._streamCleanUp(),U=!0,this._streamData("")},this),this._streamCleanUp=k(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S(y){var b,M,U,Y=Math.pow(2,53),B=-Y,Q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,me=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,se=this,G=0,N=0,A=!1,J=!1,c=[],h={data:[],errors:[],meta:{}};if(P(y.step)){var g=y.step;y.step=function(D){if(h=D,O())R();else{if(R(),h.data.length===0)return;G+=D.data.length,y.preview&&G>y.preview?M.abort():(h.data=h.data[0],g(h,se))}}}function _(D){return y.skipEmptyLines==="greedy"?D.join("").trim()==="":D.length===1&&D[0].length===0}function R(){return h&&U&&(L("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),U=!1),y.skipEmptyLines&&(h.data=h.data.filter(function(D){return!_(D)})),O()&&function(){if(!h)return;function D(F,ee){P(y.transformHeader)&&(F=y.transformHeader(F,ee)),c.push(F)}if(Array.isArray(h.data[0])){for(var W=0;O()&&W<h.data.length;W++)h.data[W].forEach(D);h.data.splice(0,1)}else h.data.forEach(D)}(),function(){if(!h||!y.header&&!y.dynamicTyping&&!y.transform)return h;function D(F,ee){var ne,re=y.header?{}:[];for(ne=0;ne<F.length;ne++){var ue=ne,le=F[ne];y.header&&(ue=ne>=c.length?"__parsed_extra":c[ne]),y.transform&&(le=y.transform(le,ue)),le=I(ue,le),ue==="__parsed_extra"?(re[ue]=re[ue]||[],re[ue].push(le)):re[ue]=le}return y.header&&(ne>c.length?L("FieldMismatch","TooManyFields","Too many fields: expected "+c.length+" fields but parsed "+ne,N+ee):ne<c.length&&L("FieldMismatch","TooFewFields","Too few fields: expected "+c.length+" fields but parsed "+ne,N+ee)),re}var W=1;return!h.data.length||Array.isArray(h.data[0])?(h.data=h.data.map(D),W=h.data.length):h.data=D(h.data,0),y.header&&h.meta&&(h.meta.fields=c),N+=W,h}()}function O(){return y.header&&c.length===0}function I(D,W){return F=D,y.dynamicTypingFunction&&y.dynamicTyping[F]===void 0&&(y.dynamicTyping[F]=y.dynamicTypingFunction(F)),(y.dynamicTyping[F]||y.dynamicTyping)===!0?W==="true"||W==="TRUE"||W!=="false"&&W!=="FALSE"&&(function(ee){if(Q.test(ee)){var ne=parseFloat(ee);if(B<ne&&ne<Y)return!0}return!1}(W)?parseFloat(W):me.test(W)?new Date(W):W===""?null:W):W;var F}function L(D,W,F,ee){var ne={type:D,code:W,message:F};ee!==void 0&&(ne.row=ee),h.errors.push(ne)}this.parse=function(D,W,F){var ee=y.quoteChar||'"';if(y.newline||(y.newline=function(ue,le){ue=ue.substring(0,1048576);var Ae=new RegExp(H(le)+"([^]*?)"+H(le),"gm"),ye=(ue=ue.replace(Ae,"")).split("\r"),he=ue.split(`
`),Oe=1<he.length&&he[0].length<ye[0].length;if(ye.length===1||Oe)return`
`;for(var Ce=0,ce=0;ce<ye.length;ce++)ye[ce][0]===`
`&&Ce++;return Ce>=ye.length/2?`\r
`:"\r"}(D,ee)),U=!1,y.delimiter)P(y.delimiter)&&(y.delimiter=y.delimiter(D),h.meta.delimiter=y.delimiter);else{var ne=function(ue,le,Ae,ye,he){var Oe,Ce,ce,Re;he=he||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var $e=0;$e<he.length;$e++){var Te=he[$e],at=0,Ve=0,gt=0;ce=void 0;for(var lr=new w({comments:ye,delimiter:Te,newline:le,preview:10}).parse(ue),ar=0;ar<lr.data.length;ar++)if(Ae&&_(lr.data[ar]))gt++;else{var Jt=lr.data[ar].length;Ve+=Jt,ce!==void 0?0<Jt&&(at+=Math.abs(Jt-ce),ce=Jt):ce=Jt}0<lr.data.length&&(Ve/=lr.data.length-gt),(Ce===void 0||at<=Ce)&&(Re===void 0||Re<Ve)&&1.99<Ve&&(Ce=at,Oe=Te,Re=Ve)}return{successful:!!(y.delimiter=Oe),bestDelimiter:Oe}}(D,y.newline,y.skipEmptyLines,y.comments,y.delimitersToGuess);ne.successful?y.delimiter=ne.bestDelimiter:(U=!0,y.delimiter=a.DefaultDelimiter),h.meta.delimiter=y.delimiter}var re=$(y);return y.preview&&y.header&&re.preview++,b=D,M=new w(re),h=M.parse(b,W,F),R(),A?{meta:{paused:!0}}:h||{meta:{paused:!1}}},this.paused=function(){return A},this.pause=function(){A=!0,M.abort(),b=P(y.chunk)?"":b.substring(M.getCharIndex())},this.resume=function(){se.streamer._halted?(A=!1,se.streamer.parseChunk(b,!0)):setTimeout(se.resume,3)},this.aborted=function(){return J},this.abort=function(){J=!0,M.abort(),h.meta.aborted=!0,P(y.complete)&&y.complete(h),b=""}}function H(y){return y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(y){var b,M=(y=y||{}).delimiter,U=y.newline,Y=y.comments,B=y.step,Q=y.preview,me=y.fastMode,se=b=y.quoteChar===void 0||y.quoteChar===null?'"':y.quoteChar;if(y.escapeChar!==void 0&&(se=y.escapeChar),(typeof M!="string"||-1<a.BAD_DELIMITERS.indexOf(M))&&(M=","),Y===M)throw new Error("Comment character same as delimiter");Y===!0?Y="#":(typeof Y!="string"||-1<a.BAD_DELIMITERS.indexOf(Y))&&(Y=!1),U!==`
`&&U!=="\r"&&U!==`\r
`&&(U=`
`);var G=0,N=!1;this.parse=function(A,J,c){if(typeof A!="string")throw new Error("Input must be a string");var h=A.length,g=M.length,_=U.length,R=Y.length,O=P(B),I=[],L=[],D=[],W=G=0;if(!A)return We();if(y.header&&!J){var F=A.split(U)[0].split(M),ee=[],ne={},re=!1;for(var ue in F){var le=F[ue];P(y.transformHeader)&&(le=y.transformHeader(le,ue));var Ae=le,ye=ne[le]||0;for(0<ye&&(re=!0,Ae=le+"_"+ye),ne[le]=ye+1;ee.includes(Ae);)Ae=Ae+"_"+ye;ee.push(Ae)}if(re){var he=A.split(U);he[0]=ee.join(M),A=he.join(U)}}if(me||me!==!1&&A.indexOf(b)===-1){for(var Oe=A.split(U),Ce=0;Ce<Oe.length;Ce++){if(D=Oe[Ce],G+=D.length,Ce!==Oe.length-1)G+=U.length;else if(c)return We();if(!Y||D.substring(0,R)!==Y){if(O){if(I=[],gt(D.split(M)),Vr(),N)return We()}else gt(D.split(M));if(Q&&Q<=Ce)return I=I.slice(0,Q),We(!0)}}return We()}for(var ce=A.indexOf(M,G),Re=A.indexOf(U,G),$e=new RegExp(H(se)+H(b),"g"),Te=A.indexOf(b,G);;)if(A[G]!==b)if(Y&&D.length===0&&A.substring(G,G+R)===Y){if(Re===-1)return We();G=Re+_,Re=A.indexOf(U,G),ce=A.indexOf(M,G)}else if(ce!==-1&&(ce<Re||Re===-1))D.push(A.substring(G,ce)),G=ce+g,ce=A.indexOf(M,G);else{if(Re===-1)break;if(D.push(A.substring(G,Re)),Jt(Re+_),O&&(Vr(),N))return We();if(Q&&I.length>=Q)return We(!0)}else for(Te=G,G++;;){if((Te=A.indexOf(b,Te+1))===-1)return c||L.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:I.length,index:G}),ar();if(Te===h-1)return ar(A.substring(G,Te).replace($e,b));if(b!==se||A[Te+1]!==se){if(b===se||Te===0||A[Te-1]!==se){ce!==-1&&ce<Te+1&&(ce=A.indexOf(M,Te+1)),Re!==-1&&Re<Te+1&&(Re=A.indexOf(U,Te+1));var at=lr(Re===-1?ce:Math.min(ce,Re));if(A.substr(Te+1+at,g)===M){D.push(A.substring(G,Te).replace($e,b)),A[G=Te+1+at+g]!==b&&(Te=A.indexOf(b,G)),ce=A.indexOf(M,G),Re=A.indexOf(U,G);break}var Ve=lr(Re);if(A.substring(Te+1+Ve,Te+1+Ve+_)===U){if(D.push(A.substring(G,Te).replace($e,b)),Jt(Te+1+Ve+_),ce=A.indexOf(M,G),Te=A.indexOf(b,G),O&&(Vr(),N))return We();if(Q&&I.length>=Q)return We(!0);break}L.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:I.length,index:G}),Te++}}else Te++}return ar();function gt(Xe){I.push(Xe),W=G}function lr(Xe){var Or=0;if(Xe!==-1){var Qe=A.substring(Te+1,Xe);Qe&&Qe.trim()===""&&(Or=Qe.length)}return Or}function ar(Xe){return c||(Xe===void 0&&(Xe=A.substring(G)),D.push(Xe),G=h,gt(D),O&&Vr()),We()}function Jt(Xe){G=Xe,gt(D),D=[],Re=A.indexOf(U,G)}function We(Xe){return{data:I,errors:L,meta:{delimiter:M,linebreak:U,aborted:N,truncated:!!Xe,cursor:W+(J||0)}}}function Vr(){B(We()),I=[],L=[]}},this.abort=function(){N=!0},this.getCharIndex=function(){return G}}function v(y){var b=y.data,M=s[b.workerId],U=!1;if(b.error)M.userError(b.error,b.file);else if(b.results&&b.results.data){var Y={abort:function(){U=!0,E(b.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:x,resume:x};if(P(M.userStep)){for(var B=0;B<b.results.data.length&&(M.userStep({data:b.results.data[B],errors:b.results.errors,meta:b.results.meta},Y),!U);B++);delete b.results}else P(M.userChunk)&&(M.userChunk(b.results,Y,b.file),delete b.results)}b.finished&&!U&&E(b.workerId,b.results)}function E(y,b){var M=s[y];P(M.userComplete)&&M.userComplete(b),M.terminate(),delete s[y]}function x(){throw new Error("Not implemented.")}function $(y){if(typeof y!="object"||y===null)return y;var b=Array.isArray(y)?[]:{};for(var M in y)b[M]=$(y[M]);return b}function k(y,b){return function(){y.apply(b,arguments)}}function P(y){return typeof y=="function"}return o&&(n.onmessage=function(y){var b=y.data;if(a.WORKER_ID===void 0&&b&&(a.WORKER_ID=b.workerId),typeof b.input=="string")n.postMessage({workerId:a.WORKER_ID,results:a.parse(b.input,b.config),finished:!0});else if(n.File&&b.input instanceof File||b.input instanceof Object){var M=a.parse(b.input,b.config);M&&n.postMessage({workerId:a.WORKER_ID,results:M,finished:!0})}}),(f.prototype=Object.create(d.prototype)).constructor=f,(m.prototype=Object.create(d.prototype)).constructor=m,(p.prototype=Object.create(p.prototype)).constructor=p,(C.prototype=Object.create(d.prototype)).constructor=C,a})})(CO);var i6=CO.exports;const SO=Qg(i6),o6=({onDataLoaded:t})=>{const e=r=>{const n=r.target.files[0];n&&SO.parse(n,{header:!0,complete:i=>{t(i.data,n.name,new Date().toLocaleString())}})};return De.jsx("div",{children:De.jsx("input",{type:"file",onChange:e,accept:".csv"})})},s6=(t,e,r,n)=>wr.useCallback((o,s)=>{const l=e.findIndex(d=>d.data===o);if(l===-1)return;let a=0;const u=t.map(d=>{const f=d[o];return(f==null||f==="")&&(d[o]=s,a++),d});a>0&&n(`Replaced ${a} missing values in column "${e[l].title}" with "${s}"`),r(u)},[t,e,r,n]),l6=({onSaveCurrent:t})=>De.jsx("button",{onClick:t,children:"Save Current"}),a6=({isHistoryVisible:t,uploadHistory:e,activeIndex:r,onHistoryItemClick:n,toggleHistory:i})=>De.jsxs("div",{className:`history-sidebar ${t?"visible":""}`,children:[De.jsx("button",{onClick:i,children:"Hide History"}),De.jsx("p",{children:"History"}),De.jsx("ul",{children:e.map((o,s)=>De.jsxs("li",{className:`history-entry ${s===r?"active":""}`,onClick:()=>n(o,s),children:[De.jsx("strong",{children:o.fileName})," - ",De.jsx("em",{children:o.timestamp}),o.actions&&o.actions.length>0&&De.jsx("ul",{children:o.actions.map((l,a)=>De.jsx("li",{children:l},a))})]},s))})]});function u6(){var Y;const[t,e]=wr.useState([]),[r,n]=wr.useState([]),[i,o]=wr.useState(!1),[s,l]=wr.useState([]),[a,u]=wr.useState([]),[d,f]=wr.useState(-1),[m,p]=wr.useState(""),[C,S]=wr.useState(null),[H,w]=wr.useState(""),v=C!==null?(Y=r[C])==null?void 0:Y.title:"",E=()=>{o(!i)},$=s6(t,r,e,B=>{u(Q=>[...Q,B])}),k=()=>{const B=new Date().toLocaleString(),Q=H||"initial dataset",me=JSON.parse(JSON.stringify(t));l(se=>[...se,{data:me,fileName:Q,timestamp:B,actions:[...a]}])},P=()=>{var B;if(C!==null&&m!==void 0){const Q=(B=r[C])==null?void 0:B.data;Q&&$(Q,m)}},y=(B,Q,me,se)=>{B===-1&&me===t.length-1?S(Q):S(null)},b=(B,Q,me)=>{e(B),M(B),w(Q);const se=JSON.parse(JSON.stringify(B));l(G=>[...G,{data:se,fileName:Q,timestamp:me,actions:[]}])},M=B=>{if(B.length>0){const me=Object.keys(B[0]).map(se=>({maxLength:Math.max(...B.map(G=>String(G[se]).length),se.length),data:se,title:se,width:Math.min(200,se.length*10)}));n(me)}},U=(B,Q)=>{e(B.data),M(B.data),f(Q),u(B.actions),setTimeout(()=>{f(-1)},500)};return wr.useEffect(()=>{async function B(){const se=await(await fetch("https://eth-peach-lab.github.io/data-story/titanic.csv")).body.getReader().read(),N=new TextDecoder("utf-8").decode(se.value),A=SO.parse(N,{header:!0});if(e(A.data),A.data.length>0){const c=Object.keys(A.data[0]).map(h=>{const g=Math.max(...A.data.map(_=>String(_[h]).length),h.length);return{data:h,title:h,width:Math.min(g*10,200)}});n(c)}}B()},[]),De.jsxs("div",{className:"container",children:[De.jsx("h1",{children:"Data-Story"}),De.jsx(o6,{onDataLoaded:b}),De.jsxs("div",{className:"content-area",children:[De.jsx("div",{className:"handsontable-container",children:De.jsx(yO,{data:t,colHeaders:r.map(B=>B.title),columns:r,rowHeaders:!0,manualColumnResize:!0,width:"100%",height:"auto",licenseKey:"non-commercial-and-evaluation",afterSelectionEnd:y})}),De.jsxs("div",{className:"sidebar",children:[De.jsx("button",{onClick:E,children:"Show History"}),De.jsx(l6,{onSaveCurrent:k}),De.jsx("p",{children:"Select a column to replace its missing values."}),De.jsx("div",{children:De.jsx("input",{type:"text",placeholder:"Replacement value",value:m,onChange:B=>p(B.target.value)})}),C!==null&&De.jsxs("p",{children:["Selected Column: ",v]}),De.jsx("button",{onClick:P,disabled:C===null,children:"Replace Missing Values"})]}),De.jsx(a6,{isHistoryVisible:i,uploadHistory:s,activeIndex:d,onHistoryItemClick:U,toggleHistory:E})]})]})}mm.createRoot(document.getElementById("root")).render(De.jsx(et.StrictMode,{children:De.jsx(u6,{})}))});export default c6();
